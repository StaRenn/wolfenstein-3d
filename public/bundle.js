(()=>{"use strict";var t={525:(t,e,i)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.NEIGHBOR_OFFSET=e.OBSTACLE_SIDES=e.INTERSECTION_TYPES=e.ITEMS_PURPOSES=e.WEAPONS=e.RESOLUTIONS_SCALE_VALUES=e.ACTOR_SPEED=e.OBSTACLES_MOVE_SPEED=e.DEFAULT_FRAME_DURATION=e.MAP_SCALE=e.HUD_WIDTH_COEFFICIENT=e.TEXTURE_SIZE=e.DOOR_SIDE_WALL_TEXTURE_DARK_ID=e.DOOR_SIDE_WALL_TEXTURE_ID=e.DOOR_IDS=e.DOOR_TIMEOUT=e.RAY_LENGTH=e.TILE_SIZE=void 0,i(230);var o=i(11),r=i(380),s=i(929);e.TILE_SIZE=10,e.RAY_LENGTH=64*e.TILE_SIZE,e.DOOR_TIMEOUT=4e3,e.DOOR_IDS=[27,28,33,34,35,36],e.DOOR_SIDE_WALL_TEXTURE_ID=30,e.DOOR_SIDE_WALL_TEXTURE_DARK_ID=29,e.TEXTURE_SIZE=64,e.HUD_WIDTH_COEFFICIENT=.6,e.MAP_SCALE=.6,e.DEFAULT_FRAME_DURATION=1e3/60,e.OBSTACLES_MOVE_SPEED=e.TILE_SIZE/(4*e.TILE_SIZE),e.ACTOR_SPEED=1,e.RESOLUTIONS_SCALE_VALUES=[.1,.25,.5,1],window.RESOLUTION_SCALE=1,window.IS_PAUSED=!1,window.FOV_DEGREES=90,window.FOV=(0,s.toRadians)(FOV_DEGREES),window.TIME_SCALE=1,e.WEAPONS={KNIFE:{frameSet:(0,o.fillWeaponFrameSet)("KNIFE",50),maxDistance:10,damage:10,frameDuration:50,ammoPerAttack:0,shootFrameIdx:2,icon:(0,r.getImageWithSource)("src/assets/hud/knife.png")},PISTOL:{frameSet:(0,o.fillWeaponFrameSet)("PISTOL",65),maxDistance:70,damage:40,frameDuration:65,ammoPerAttack:1,shootFrameIdx:2,icon:(0,r.getImageWithSource)("src/assets/hud/pistol.png")},MACHINE_GUN:{frameSet:(0,o.fillWeaponFrameSet)("MACHINE_GUN",25),maxDistance:70,damage:20,frameDuration:25,ammoPerAttack:1,shootFrameIdx:2,icon:(0,r.getImageWithSource)("src/assets/hud/machine_gun.png")}},e.ITEMS_PURPOSES={34:{affects:"ammo",value:8},35:{affects:"health",value:10},39:{affects:"health",value:25},36:{affects:"score",value:100},37:{affects:"score",value:1},38:{affects:"score",value:500},42:{affects:"score",value:1e3},40:{affects:"weapons",value:"MACHINE_GUN"},41:{affects:"weapons",value:"MACHINE_GUN"}},e.INTERSECTION_TYPES={VERTICAL:"VERTICAL",HORIZONTAL:"HORIZONTAL"},e.OBSTACLE_SIDES={TOP:"TOP",BOTTOM:"BOTTOM",LEFT:"LEFT",RIGHT:"RIGHT"},e.NEIGHBOR_OFFSET=((n={})[e.OBSTACLE_SIDES.TOP]=-1,n[e.OBSTACLE_SIDES.BOTTOM]=1,n[e.OBSTACLE_SIDES.LEFT]=-1,n[e.OBSTACLE_SIDES.RIGHT]=1,n)},798:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ACTOR_PORTRAIT_FRAME_SETS=e.PORTRAIT_HEIGHT=e.PORTRAIT_WIDTH=e.WEAPON_ICON_HEIGHT=e.WEAPON_ICON_WIDTH=e.FONT_SYMBOL_HEIGHT=e.FONT_SYMBOL_WIDTH=e.FONT_IMAGE=e.HUD_PANEL=void 0,i(230);var n=i(11),o=i(380);e.HUD_PANEL={TEXTURE:(0,o.getImageWithSource)("src/assets/hud/panel.png"),WIDTH:400,HEIGHT:40,INFO_Y_OFFSET:16,WEAPON_Y_OFFSET:8,LEVEL_X_OFFSET:65,SCORE_X_OFFSET:111,LIVES_X_OFFSET:156,HEALTH_X_OFFSET:219,AMMO_X_OFFSET:262,WEAPON_X_OFFSET:296,PORTRAIT_X_OFFSET:174,PORTRAIT_Y_OFFSET:5},e.FONT_IMAGE=(0,o.getImageWithSource)("src/assets/hud/font.png"),e.FONT_SYMBOL_WIDTH=8,e.FONT_SYMBOL_HEIGHT=16,e.WEAPON_ICON_WIDTH=48,e.WEAPON_ICON_HEIGHT=24,e.PORTRAIT_WIDTH=30,e.PORTRAIT_HEIGHT=31,e.ACTOR_PORTRAIT_FRAME_SETS={HEALTHY:(0,n.fillPortraitFrameSet)("HEALTHY"),JUST_A_SCRATCH:(0,n.fillPortraitFrameSet)("JUST_A_SCRATCH"),MINOR_DAMAGE:(0,n.fillPortraitFrameSet)("MINOR_DAMAGE"),MODERATE_DAMAGE:(0,n.fillPortraitFrameSet)("MODERATE_DAMAGE"),SEVERE_DAMAGE:(0,n.fillPortraitFrameSet)("SEVERE_DAMAGE"),SUFFERING:(0,n.fillPortraitFrameSet)("SUFFERING"),NEAR_DEATH:(0,n.fillPortraitFrameSet)("NEAR_DEATH"),DEAD:[{data:(0,o.getImageWithSource)("src/assets/hud/portrait/dead/frame_0.png"),duration:1e4}]}},11:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.generatePostEffectFrameSet=e.fillPortraitFrameSet=e.fillWeaponFrameSet=void 0,i(230);var n=i(380);e.fillWeaponFrameSet=function(t,e){for(var i=[],o=0;o<5;o++)i.push((0,n.getImageWithSource)("src/assets/weapons/".concat(t.toLowerCase(),"/").concat(t.toLowerCase(),"_frame_").concat(o,".png")));return i.map((function(t){return{data:t,duration:e}}))},e.fillPortraitFrameSet=function(t){for(var e=[],i=0;i<3;i++)e.push((0,n.getImageWithSource)("src/assets/hud/portrait/".concat(t.toLowerCase(),"/frame_").concat(i,".png")));return[{data:e[0],duration:2e3},{data:e[1],duration:750},{data:e[2],duration:750},{data:e[1],duration:750},{data:e[0],duration:1500},{data:e[1],duration:1500},{data:e[2],duration:200},{data:e[1],duration:500},{data:e[2],duration:500},{data:e[1],duration:500}]},e.generatePostEffectFrameSet=function(t){return[{data:{color:"rgba(".concat(t.join(","),", 0)")},duration:1e4},{data:{color:"rgba(".concat(t.join(","),", 0.25)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.2)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.15)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.1)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.05)")},duration:40}]}},867:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getNeighbors=void 0,i(230);var n=i(525);e.getNeighbors=function(t,e){var i,o=((i={})[n.OBSTACLE_SIDES.TOP]=null,i[n.OBSTACLE_SIDES.LEFT]=null,i[n.OBSTACLE_SIDES.BOTTOM]=null,i[n.OBSTACLE_SIDES.RIGHT]=null,i);return Object.keys(o).forEach((function(i,r){var s=n.NEIGHBOR_OFFSET[i],a=t[e.y+(1-r%2)*s];if(a){var _=a[e.x+r%2*s];_&&(o[i]=_)}})),o}},571:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRelativeChunkMultiplier=void 0;var n=i(525);e.getRelativeChunkMultiplier=function(t){return t<n.TILE_SIZE/2?32:t<3*n.TILE_SIZE?16:t<6*n.TILE_SIZE?8:1}},414:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getTextureOffset=void 0,i(230);var n=i(4),o=i(525);e.getTextureOffset=function(t){var e=t.obstacle,i=e.position,r=((0,n.isWall)(e)||(0,n.isDoor)(e))&&e.intersectionType===o.INTERSECTION_TYPES.VERTICAL,s=!1;((0,n.isSprite)(e)||(0,n.isItem)(e))&&Math.abs(i.x1-i.x2)>Math.abs(i.y1-i.y2)&&(s=!0);var a=((0,n.isWall)(e)||(0,n.isDoor)(e))&&e.shouldReverseTexture?{x:i.x2,y:i.y2}:{x:i.x1,y:i.y1},_=r||s?a.x-t.intersectionVertex.x:a.y-t.intersectionVertex.y,E=r||s?Math.abs(i.x1-i.x2):Math.abs(i.y1-i.y2),I=Math.abs(_)/E;return Math.floor(I*o.TEXTURE_SIZE)}},929:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getIntersectionVertexWithPlane=e.unitVector=e.vectorSize=e.getIsVertexInTheTriangle=e.getVertexByPositionAndAngle=e.getAreaSize=e.hasEqualPosition=e.toRadians=void 0,i(230);var n=i(525);function o(t,e,i,n,o,r){return Math.abs((t*(n-r)+i*(r-e)+o*(e-n))/2)}function r(t){var e=t.x,i=t.y;return Math.sqrt(e*e+i*i)}e.toRadians=function(t){return t*Math.PI/180},e.hasEqualPosition=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2},e.getAreaSize=o,e.getVertexByPositionAndAngle=function(t,e){return{x:t.x+n.RAY_LENGTH*Math.sin(e),y:t.y+n.RAY_LENGTH*Math.cos(e)}},e.getIsVertexInTheTriangle=function(t,e){var i=t.x,n=t.y,r=e.x1,s=e.y1,a=e.x2,_=e.y2,E=e.x3,I=e.y3,T=o(r,s,a,_,E,I),c=o(i,n,a,_,E,I),h=o(r,s,i,n,E,I),u=o(r,s,a,_,i,n);return Math.round(T)==Math.round(c+h+u)},e.vectorSize=r,e.unitVector=function(t){var e=t.x,i=t.y,n=r({x:e,y:i});return{x:e/n,y:i/n}},e.getIntersectionVertexWithPlane=function(t,e){var i=t.x1,n=t.x2,o=t.y1,r=t.y2,s=e.x1,a=e.y1,_=e.x2,E=e.y2;if(!(i===n&&o===r||s===_&&a===E)){var I=(E-a)*(n-i)-(_-s)*(r-o);if(0!==I){var T=((_-s)*(o-a)-(E-a)*(i-s))/I,c=((n-i)*(o-a)-(r-o)*(i-s))/I;if(!(T<0||T>1||c<0||c>1))return{x:i+T*(n-i),y:o+T*(r-o)}}}}},519:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{_(n.next(t))}catch(t){r(t)}}function a(t){try{_(n.throw(t))}catch(t){r(t)}}function _(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}_((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.canvas=void 0;var r=i(259),s=i(525),a=i(491),_=i(929);e.canvas=document.getElementById("canvas"),window.onload=function(){return n(this,void 0,void 0,(function(){function t(){h.resize(window.innerWidth,window.innerHeight)}function i(t){IS_PAUSED||h.render(),S=l;var e=(l=t)-S;L+=(e-L)/O,TIME_SCALE=Math.min(Math.round(e/s.DEFAULT_FRAME_DURATION*100)/100,1),requestAnimationFrame(i)}var n,E,I,T,c,h,u,S,l,O,L;return o(this,(function(o){return n=document.getElementById("menu-container"),E=document.getElementById("resolution-scale"),I=document.getElementById("fov"),T=document.getElementById("fovValue"),c=document.getElementById("continue-button"),I.value=String(FOV_DEGREES),T.innerText=String(FOV_DEGREES),E.value="3",c.onclick=function(){IS_PAUSED&&(IS_PAUSED=!1,n.style.display="none")},E.oninput=function(e){e.target&&(RESOLUTION_SCALE=s.RESOLUTIONS_SCALE_VALUES[Number(e.target.value)],t(),h.render())},I.oninput=function(e){e.target&&(FOV_DEGREES=Number(e.target.value),FOV=(0,_.toRadians)(FOV_DEGREES),T.innerText=e.target.value,t(),h.render())},e.canvas.onclick=function(){IS_PAUSED=!1,e.canvas.requestPointerLock()},window.onkeydown=function(t){"Escape"===t.key&&(IS_PAUSED=!0,n.style.display="flex")},h=new r.Scene(e.canvas,a.map),t(),window.addEventListener("resize",t),u=document.getElementById("fps"),S=0,l=0,O=20,L=0,setInterval((function(){u.innerHTML=(1e3/L).toFixed(1)+" fps"}),200),i(0),[2]}))}))}},491:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.map=void 0,i(230),e.map=[[0,0,1,1,1,1,1,"1_ID617_END",1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,1,1,3,1,1,1,1,3,1,1,1,1,3,3,1,1,3,1,1,3,3,1,1,3,3,3],[0,0,1,"39_SPRITE_HOLLOW_ITEM",0,0,0,0,"41_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,3,1,1,1,3,3,"5_ID6037_END",1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,3],[37,37,1,3,"1_ID614_START",3,1,"1_ID617_START",3,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,"35_SPRITE_HOLLOW_ITEM","35_SPRITE_HOLLOW_ITEM",0,0,0,0,0,1,"39_SPRITE_HOLLOW_ITEM",0,"39_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,0,0,0,0,0,0,3,0,"24_SPRITE_HOLLOW",0,27,0,"24_SPRITE_HOLLOW",0,0,0,"24_SPRITE_HOLLOW",0,5],[37,0,0,0,0,1,1,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM","1_ID5810_END",1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,"35_SPRITE_HOLLOW_ITEM","11_SPRITE",0,0,0,"11_SPRITE",0,3,1,"5_ID6037_START",1,3,0,0,3,0,0,0,0,0,1,0,0,3,0,0,0,1,0,0,0,0,0,0,0,1],[37,0,37,1,"1_ID614_END",1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3,1,1,3,1,0,0,0,3],[37,0,37,1,1,1,1,1,3,1,"1_ID5810_START",11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,"24_SPRITE_HOLLOW",0,27,0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,27,0,0,0,1,"42_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",3,0,0,0,1],[37,0,37,3,"34_SPRITE_HOLLOW_ITEM",0,0,0,"34_SPRITE_HOLLOW_ITEM",0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,"38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM",1,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,"39_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,"11_SPRITE","23_SPRITE_HOLLOW",0,0,"11_SPRITE",0,3,0,0,0,3,0,0,1,0,0,0,0,0,3,0,0,1,0,0,0,1,"42_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",1,0,0,0,1],[37,0,37,3,1,3,1,0,1,3,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1,"36_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM",1,0,0,0,1],[37,0,37,0,0,1,1,27,1,1,1,1,3,1,1,11,1,1,1,0,0,3,1,3,1,3,0,1,3,1,3,3,1,1,3,1,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3,"42_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",3,0,0,0,1],[37,0,37,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,1,3,0,1,0,0,0,1,0,3,"1_SPRITE",0,0,0,0,0,0,3,0,0,0,3,1,1,1,1,1,27,1,1,3,3,1,1,0,0,0,1,"36_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM",1,0,0,0,1],[37,0,37,1,1,"1_SPRITE",0,0,0,0,0,3,"1_SPRITE",0,0,0,0,0,0,1,1,3,0,0,0,3,1,1,0,0,"22_SPRITE_HOLLOW",0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,1,0,0,0,3,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,3,0,0,0,1,0,0,0,3],[37,0,37,3,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,"24_SPRITE_HOLLOW",0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,"16_SPRITE",1,"1_SPRITE",0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,27,1,1,1,1,3,3,1,3,3,1,1,3,1,1,0,0,0,1,0,0,0,1],[37,0,37,3,0,"14_SPRITE",0,0,0,"13_SPRITE",0,3,0,"22_SPRITE_HOLLOW",0,0,0,"16_SPRITE","16_SPRITE",3,"1_SPRITE","1_SPRITE",0,0,0,3,3,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,"35_SPRITE_HOLLOW_ITEM",1,"1_SPRITE","1_SPRITE",0,0,0,1,0,3,0,0,0,0,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1],[37,0,37,1,1,3,1,1,3,1,1,1,1,3,1,27,1,3,1,1,3,1,3,1,3,1,0,3,1,1,3,1,1,1,1,3,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3],[37,0,37,1,1,"12_SPRITE",1,"12_SPRITE",3,"12_SPRITE",1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,11,0,"24_SPRITE_HOLLOW",0,"11_ID4543_START",0,"11_ID4543_END",1,1,3,3,1,3,1,3,3,1,1,1,1,3,0,0,0,1],[37,0,37,1,"12_SPRITE",0,0,0,0,0,0,1,0,0,0,0,0,0,"18_SPRITE",1,0,0,0,0,0,0,0,1,0,"6_SPRITE",0,0,0,"6_SPRITE",0,1,0,0,0,1,0,0,0,1,1,1,31,5,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1],[37,0,37,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,3,0,31,0,33,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,1,0,0,0,1],[37,0,37,1,"12_SPRITE",0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,"24_SPRITE_HOLLOW",0,3,0,0,0,3,0,1,31,5,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1],[37,0,37,1,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,35,3,1,1,3,1,3,0,0,0,1,1,0,1,1,0,0,0,1,0,0,0,3],[37,0,37,1,"12_SPRITE",0,0,0,0,0,0,3,"16_SPRITE",0,0,0,0,0,"17_SPRITE",1,0,0,0,0,0,0,0,1,0,"6_SPRITE",0,0,0,"6_SPRITE",0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1],[37,0,37,1,1,0,0,0,0,0,0,1,"16_SPRITE","16_SPRITE",0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,"24_SPRITE_HOLLOW",0,1,0,0,0,1,0,0,0,1],[37,0,37,0,1,1,1,27,1,1,3,1,3,1,3,3,1,3,1,1,0,0,0,0,0,0,0,1,1,1,1,27,1,1,1,1,0,0,0,3,0,0,0,1,0,0,0,0,0,0,0,1,"38_SPRITE_HOLLOW_ITEM",0,"38_SPRITE_HOLLOW_ITEM",1,0,0,0,3,0,0,0,3],[37,0,37,1,1,0,0,0,0,0,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,0,0,3,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,"2_SPRITE",0,0,0,"2_SPRITE",0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,3,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,3,0,"24_SPRITE_HOLLOW",0,1],[37,0,37,3,0,0,0,"25_SPRITE_HOLLOW",0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,"24_SPRITE_HOLLOW",0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3],[37,0,37,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,3,1,5,3,3,1,1,1,1,1,3,3,5,3,1,1,3,1,1,3,1,11,27,11,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,"2_SPRITE",0,0,0,"2_SPRITE",0,3,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,0,37,3,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,7,1,3,3,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],[37,0,37,1,3,3,1,27,1,3,3,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,3,1,1,3,3,1,3,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,1,3,11,3,11,3,1,1,0,0,0,0,0,0,0,1,3,0,"38_SPRITE_HOLLOW_ITEM",0,"35_SPRITE_HOLLOW_ITEM",0,1,1,0,0,0,3,0,0,0,23,23,23,23,21,23,27,23,23,23,27,23,21,23,23,23,23,0,0,0,1],[37,0,37,3,0,"6_SPRITE",0,0,0,"6_SPRITE",0,1,0,"10_SPRITE",0,"10_SPRITE",0,"10_SPRITE",0,3,0,0,0,0,0,0,0,3,0,"7_SPRITE",0,"38_SPRITE_HOLLOW_ITEM",0,"7_SPRITE",0,1,0,0,0,1,0,0,0,23,0,0,0,0,0,0,0,23,0,0,0,0,0,0,0,23,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,"38_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM",0,"36_SPRITE_HOLLOW_ITEM",1,0,0,0,1,0,0,0,23,"38_SPRITE_HOLLOW_ITEM",0,"2_SPRITE",0,"2_SPRITE",0,"38_SPRITE_HOLLOW_ITEM",23,0,0,"2_SPRITE",0,"2_SPRITE",0,0,23,0,0,0,1],[37,0,37,3,0,"6_SPRITE",0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,"36_SPRITE_HOLLOW_ITEM",3,0,0,0,7,0,0,0,23,0,0,0,0,0,0,0,23,0,0,0,0,0,0,0,23,0,0,0,7],[37,0,37,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,"35_SPRITE_HOLLOW_ITEM",0,1,0,0,0,1,0,0,0,23,0,0,"2_SPRITE",0,"2_SPRITE",0,0,23,"36_SPRITE_HOLLOW_ITEM",0,"2_SPRITE",0,"2_SPRITE",0,"34_SPRITE_HOLLOW_ITEM",23,0,0,0,1],[37,0,37,1,0,"6_SPRITE",0,"6_SPRITE",0,"6_SPRITE",0,1,0,"10_SPRITE",0,"10_SPRITE",0,"10_SPRITE",0,3,0,0,0,0,0,0,0,3,0,"7_SPRITE",0,"42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","7_SPRITE",0,1,0,0,0,3,0,0,0,23,0,0,"42_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM",0,0,23,"36_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM",0,"42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",23,0,0,0,1],[37,0,37,3,0,0,0,0,0,0,0,1,1,3,11,1,11,1,1,3,0,0,0,0,0,0,0,1,1,"36_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","35_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",3,3,0,0,0,1,0,0,0,23,23,23,23,19,23,23,23,23,23,23,23,19,23,23,23,23,0,0,0,3],[37,0,37,1,3,1,1,1,3,1,1,1,0,0,0,0,1,1,1,1,1,1,3,1,1,3,1,1,3,3,1,1,1,3,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,0,37,37,37,37,37,37,37,37,37,37,37,37,37,37,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,0,0,0,0,0,0,0,0,"38_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM",37,1,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,"39_SPRITE_HOLLOW_ITEM",0,0,0,0,0,0,0,"36_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",37,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,5,3,1,1,3,1,1,3,1,3,5,1,1,3,1,1,3,1,3,3,5,1,1],[37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,1,3,1,3,27,1,1,1,1,1,1,1,3,27,3,1,1,1,1,1,1,1,3,15,15,17,17,15,15,17,15,15,17,17,15,17,17,15,17,15,15,17,15,17,15,17,17,17],[1,1,3,1,1,1,3,1,0,3,1,11,3,1,0,3,1,3,1,0,0,0,1,5,3,3,5,3,0,0,0,3,3,1,0,3,1,1,1,15,0,0,0,0,0,17,0,0,0,0,"35_SPRITE_HOLLOW_ITEM",15,0,0,0,0,0,15,"23_SPRITE_HOLLOW",0,0,"35_SPRITE_HOLLOW_ITEM",0,15],[1,0,0,0,0,0,0,1,5,3,0,0,0,1,7,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,11,1,0,0,1,15,0,0,"2_SPRITE","26_SPRITE_HOLLOW",0,17,0,0,"2_SPRITE",0,0,17,0,0,"2_SPRITE",0,0,17,0,0,"2_SPRITE",0,0,17],[3,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,1,17,0,0,"24_SPRITE_HOLLOW","35_SPRITE_HOLLOW_ITEM",0,17,0,0,"24_SPRITE_HOLLOW",0,0,15,0,0,"24_SPRITE_HOLLOW","23_SPRITE_HOLLOW",0,15,0,0,"24_SPRITE_HOLLOW",0,0,15],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,17,0,0,0,0,0,17,0,0,0,0,"26_SPRITE_HOLLOW",17,0,0,0,0,0,17,0,0,0,0,0,15],[1,0,0,0,0,0,0,1,5,1,0,0,0,1,7,1,0,0,0,1,11,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,15,0,0,0,0,0,15,0,0,0,0,0,17,0,0,0,0,0,15,0,0,0,0,0,17],[3,0,0,0,0,1,3,1,3,3,1,"11_ID1211_START",1,1,3,1,1,1,3,3,11,1,1,1,1,1,3,1,1,"1_ID1229_START",1,1,3,3,1,0,0,0,1,17,15,15,27,15,17,15,17,15,27,15,17,15,17,15,27,15,15,17,15,15,27,15,15,15],[1,1,0,0,1,1,0,0,0,0,0,0,1,"36_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",0,0,3,0,0,0,1,0,0,0,"42_SPRITE_HOLLOW_ITEM",0,1,0,0,0,0,0,3,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9],[0,5,0,0,5,5,"34_SPRITE_HOLLOW_ITEM",0,0,0,0,"11_ID1211_END",11,"38_SPRITE_HOLLOW_ITEM","2_SPRITE","24_SPRITE_HOLLOW",0,0,27,0,"24_SPRITE_HOLLOW",0,27,0,0,"24_SPRITE_HOLLOW","2_SPRITE",0,11,"1_ID1229_END",0,0,0,"34_SPRITE_HOLLOW_ITEM",5,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15],[1,1,0,0,1,1,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",0,0,0,1,1,"38_SPRITE_HOLLOW_ITEM",0,0,0,0,1,0,0,0,1,0,0,0,0,"38_SPRITE_HOLLOW_ITEM",3,1,0,0,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",1,0,0,0,0,27,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,9],[3,0,0,0,0,1,1,1,3,3,3,3,1,1,1,3,3,1,1,1,27,1,1,1,1,3,1,1,1,1,1,1,3,1,1,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13],[1,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,0,27,0,0,"24_SPRITE_HOLLOW",0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,"24_SPRITE_HOLLOW",0,0,27,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,1,17,17,15,27,15,17,17,15,17,27,15,17,15,15,15,27,15,17,15,15,15,27,15,17,15],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,17,0,0,0,0,0,15,0,"23_SPRITE_HOLLOW",0,0,0,15,0,0,0,0,0,15,0,0,0,0,0,15],[3,1,"1_ID42_START",1,3,1,3,3,1,3,1,3,1,1,3,1,3,3,1,0,0,0,1,1,3,1,3,1,1,1,1,1,3,3,3,3,1,3,3,15,0,0,0,0,0,17,0,0,0,0,0,17,0,0,"35_SPRITE_HOLLOW_ITEM",0,0,17,0,0,0,0,0,17],[0,1,0,0,0,1,1,1,1,1,1,1,1,0,0,"41_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,1,"39_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,0,0,1,0,0,15,0,0,"24_SPRITE_HOLLOW",0,0,15,"35_SPRITE_HOLLOW_ITEM",0,"24_SPRITE_HOLLOW",0,0,15,0,0,"24_SPRITE_HOLLOW","23_SPRITE_HOLLOW",0,15,0,0,"24_SPRITE_HOLLOW",0,0,15],[0,1,"1_ID42_END",0,0,0,0,0,0,"34_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",1,0,0,0,"39_SPRITE_HOLLOW_ITEM",11,0,0,0,0,0,11,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",0,"42_SPRITE_HOLLOW_ITEM",0,0,0,0,0,0,0,0,1,"15_ID239_END",0,"15_ID239_START","26_SPRITE_HOLLOW",0,"2_SPRITE",0,0,15,0,0,"2_SPRITE",0,0,17,"35_SPRITE_HOLLOW_ITEM",0,"2_SPRITE",0,0,17,0,0,"2_SPRITE","26_SPRITE_HOLLOW",0,15],[0,1,1,0,0,0,0,0,"34_SPRITE_HOLLOW_ITEM",0,"34_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","1_ID112_START",0,"1_ID112_END",1,1,1,0,0,"START_POS",0,0,1,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,17,0,0,0,0,0,17,"35_SPRITE_HOLLOW_ITEM","35_SPRITE_HOLLOW_ITEM",0,0,0,17,0,0,0,"35_SPRITE_HOLLOW_ITEM","35_SPRITE_HOLLOW_ITEM",17],[0,0,1,1,1,3,3,1,3,3,3,3,3,1,1,1,0,1,1,1,33,1,3,1,1,3,1,1,1,3,3,1,1,3,3,1,3,3,1,17,15,17,17,15,15,15,15,17,17,17,17,17,17,17,17,15,15,15,15,15,15,15,15,17]]},386:function(t,e,i){var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Actor=void 0,i(230);var o=i(639),r=i(654),s=i(641),a=i(518),_=i(4),E=i(525),I=i(11),T=i(798),c=function(){function t(t,e,i){this.ammo=50,this.score=0,this.ctx=t,this.currentWeapon="PISTOL",this.health=20,this.horizontalSpeed=0,this.lives=3,this.level=1,this._position=i,this.screenData=e,this.verticalSpeed=0,this.weapons=["KNIFE","PISTOL"],this.isShooting=!1,this.renderWeapon=this.renderWeapon.bind(this),this._camera=new a.Camera(this._position,this.screenData.screenWidth*RESOLUTION_SCALE,this.ctx),this.hud=new r.Hud(this.ctx,this.screenData),this.attackTimeout=new s.Timeout,this.shoot=this.shoot.bind(this),this.renderWeapon=this.renderWeapon.bind(this),this.renderPostEffect=this.renderPostEffect.bind(this),this.weaponAnimationController=new o.AnimationController({renderFunction:this.renderWeapon,initialFrameIdx:0,isLoopAnimation:!1,frameSet:E.WEAPONS[this.currentWeapon].frameSet,onFrameChange:this.shoot}),this.postEffectAnimationController=new o.AnimationController({renderFunction:this.renderPostEffect,initialFrameIdx:0,isLoopAnimation:!1,frameSet:(0,I.generatePostEffectFrameSet)([255,255,0])}),window.addEventListener("mousedown",this.handleMouseEvent.bind(this)),window.addEventListener("mouseup",this.handleMouseEvent.bind(this)),window.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("keyup",this.handleKeyUp.bind(this))}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"camera",{get:function(){return this._camera},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canShoot",{get:function(){return this.attackTimeout.isExpired&&(this.ammo>0||0===E.WEAPONS[this.currentWeapon].ammoPerAttack)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentMatrixPosition",{get:function(){return{x:Math.floor(this._position.x/E.TILE_SIZE),y:Math.floor(this._position.y/E.TILE_SIZE)}},enumerable:!1,configurable:!0}),t.prototype.handleKeyDown=function(t){"1"===t.key?this.changeWeapon("KNIFE"):"2"===t.key?this.changeWeapon("PISTOL"):"3"===t.key&&this.changeWeapon("MACHINE_GUN"),87===t.keyCode?this.verticalSpeed=E.ACTOR_SPEED:83===t.keyCode?this.verticalSpeed=-E.ACTOR_SPEED:68===t.keyCode?this.horizontalSpeed=E.ACTOR_SPEED:65===t.keyCode&&(this.horizontalSpeed=-E.ACTOR_SPEED)},t.prototype.handleMouseEvent=function(t){1===t.buttons&&(this.isShooting=!0),0===t.buttons&&(this.isShooting=!1)},t.prototype.handleKeyUp=function(t){87===t.keyCode&&this.verticalSpeed>0||83===t.keyCode&&this.verticalSpeed<0?this.verticalSpeed=0:(68===t.keyCode&&this.horizontalSpeed>0||65===t.keyCode&&this.horizontalSpeed<0)&&(this.horizontalSpeed=0)},t.prototype.renderWeapon=function(t){var e=this.screenData.screenWidth*E.HUD_WIDTH_COEFFICIENT/T.HUD_PANEL.WIDTH*T.HUD_PANEL.HEIGHT,i=this.screenData.screenHeight-e,n=this.screenData.screenWidth/2-i/2,o=this.screenData.screenHeight-i-e;this.ctx.drawImage(t,0,0,E.TEXTURE_SIZE,E.TEXTURE_SIZE,n,o,i,i)},t.prototype.renderPostEffect=function(t){this.ctx.fillStyle=t.color,this.ctx.fillRect(0,0,this.screenData.screenWidth,this.screenData.screenHeight)},t.prototype.changeWeapon=function(t){this.weapons.includes(t)&&(this.currentWeapon=t,this.weaponAnimationController.updateFrameSet(E.WEAPONS[this.currentWeapon].frameSet),this.attackTimeout.set(100))},t.prototype.playShootAnimation=function(){if(this.canShoot){var t=E.WEAPONS[this.currentWeapon];this.weaponAnimationController.playAnimation(),this.attackTimeout.set(t.frameDuration*t.frameSet.length-1)}},t.prototype.shoot=function(t){t===E.WEAPONS[this.currentWeapon].shootFrameIdx&&(this.ammo-=E.WEAPONS[this.currentWeapon].ammoPerAttack)},t.prototype.move=function(t){var e=this;if(0!==this.horizontalSpeed||0!==this.verticalSpeed){var i={x:this._position.x,y:this._position.y},o=Math.sin(this._camera.angle)*this.verticalSpeed*TIME_SCALE,r=Math.cos(this._camera.angle)*this.verticalSpeed*TIME_SCALE,s=o+Math.sin(this._camera.angle+Math.PI/2)*this.horizontalSpeed*TIME_SCALE,a=r+Math.cos(this._camera.angle+Math.PI/2)*this.horizontalSpeed*TIME_SCALE;i.x+=s>=0?Math.min(s,E.ACTOR_SPEED*TIME_SCALE):Math.max(s,-E.ACTOR_SPEED*TIME_SCALE),i.y+=a>=0?Math.min(a,E.ACTOR_SPEED*TIME_SCALE):Math.max(a,-E.ACTOR_SPEED*TIME_SCALE);var T=function(o){if(o&&(o.hasCollision||(0,_.isItem)(o))){var r=!1,s=n({},o.position);(0,_.isDoor)(o)?s=n({},o.initialPosition):(0,_.isWall)(o)&&(s=n({},o.isInFinalPosition?o.endPosition:o.initialPosition)),(0,_.isDoor)(o)&&(s.x1===s.x2&&(s.x1-=E.TILE_SIZE/2,s.x2+=E.TILE_SIZE/2),s.y1===s.y2&&(s.y1-=E.TILE_SIZE/2,s.y2+=E.TILE_SIZE/2));var a=s.x1-.3*E.TILE_SIZE,T=s.y1-.3*E.TILE_SIZE,c=s.x2+.3*E.TILE_SIZE,h=s.y2+.3*E.TILE_SIZE;if(i.x>=a&&i.x<=c&&i.y>=T&&i.y<=h&&((0,_.isItem)(o)||(e._position.x>=a&&e._position.x<=c&&(i.y=e._position.y),e._position.y>=T&&e._position.y<=h&&(i.x=e._position.x)),r=!0),r&&(0,_.isItem)(o)){var u=o.purpose;if((0,_.isDesiredPurpose)(u,"ammo")){if(100===e.ammo)return;e.ammo+=u.value,e.ammo>100&&(e.ammo=100)}if((0,_.isDesiredPurpose)(u,"health")){if(100===e.health)return;e.health+=u.value,e.health>100&&(e.health=100)}(0,_.isDesiredPurpose)(u,"score")&&(e.score+=u.value),(0,_.isDesiredPurpose)(u,"weapons")&&e.weapons.push(u.value),(0,_.isDesiredPurpose)(u,"lives")&&(e.lives+=u.value),e.postEffectAnimationController.updateFrameSet((0,I.generatePostEffectFrameSet)([255,255,0])),e.postEffectAnimationController.playAnimation(),t[o.matrixCoordinates.y][o.matrixCoordinates.x]=null}}},c=this.currentMatrixPosition;T((t[c.y-1]||[])[c.x-1]),T((t[c.y-1]||[])[c.x]),T((t[c.y-1]||[])[c.x+1]),T((t[c.y]||[])[c.x-1]),T((t[c.y]||[])[c.x+1]),T((t[c.y+1]||[])[c.x-1]),T((t[c.y+1]||[])[c.x]),T((t[c.y+1]||[])[c.x+1]),this._position=i,this._camera.updatePosition(this._position)}},t.prototype.render=function(){this.attackTimeout.iterate(),this.weaponAnimationController.iterate(),this.isShooting&&!this.weaponAnimationController.getIsCurrentlyInTimeout()&&this.playShootAnimation(),this.hud.render({currentWeapon:this.currentWeapon,ammo:this.ammo,lives:this.lives,score:this.score,level:this.level,health:this.health}),this.postEffectAnimationController.iterate()},t}();e.Actor=c},639:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationController=void 0;var n=i(641);i(230);var o=function(){function t(t){var e=t.frameSet,i=t.renderFunction,o=t.initialFrameIdx,r=t.isLoopAnimation,s=t.onAnimationEnd,a=void 0===s?function(){}:s,_=t.onAnimationStart,E=void 0===_?function(){}:_,I=t.onFrameChange,T=void 0===I?function(){}:I;this.frameSet=e,this.currentFrameIdx=o,this.derivedRenderFunction=i,this.isLoopAnimation=r,this.onAnimationEnd=a,this.onAnimationStart=E,this.onFrameChange=T,this.playAnimation=this.playAnimation.bind(this),this.timeout=new n.Timeout(this.playAnimation),r&&this.timeout.set(this.getCurrentFrame().duration)}return t.prototype.updateFrameSet=function(t){this.frameSet=t,this.currentFrameIdx=0,this.timeout.reset(),this.isLoopAnimation&&this.timeout.set(this.getCurrentFrame().duration)},t.prototype.getCurrentFrame=function(){return this.frameSet[this.currentFrameIdx]},t.prototype.getIsCurrentlyInTimeout=function(){return!this.timeout.isExpired},t.prototype.playAnimation=function(){this.currentFrameIdx===this.frameSet.length-1?(this.timeout.reset(),this.currentFrameIdx=0,this.onAnimationEnd(),this.isLoopAnimation&&this.timeout.set(this.getCurrentFrame().duration)):(0===this.currentFrameIdx&&this.onAnimationStart(),this.currentFrameIdx+=1,this.timeout.set(this.getCurrentFrame().duration)),this.onFrameChange(this.currentFrameIdx)},t.prototype.iterate=function(){this.timeout.iterate(),this.derivedRenderFunction(this.frameSet[this.currentFrameIdx].data)},t}();e.AnimationController=o},518:function(t,e,i){var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0,i(230);var o=i(770),r=i(4),s=i(867),a=i(519),_=i(525),E=i(571),I=i(929),T=function(){function t(t,e,i){this._angle=(0,I.toRadians)(180),this.ctx=i,this.position=t,this.rays=[],a.canvas.addEventListener("mousemove",this.rotate.bind(this)),this.changeRaysAmount(e)}return Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},enumerable:!1,configurable:!0}),t.prototype.updatePosition=function(t){for(var e=0;e<this.rays.length;e++)this.rays[e].move(t);this.position=t},t.prototype.getViewAngleIntersection=function(t){var e=(0,I.getVertexByPositionAndAngle)(this.position,this.angle);return(0,I.getIntersectionVertexWithPlane)({x1:this.position.x,y1:this.position.y,x2:e.x,y2:e.y},t)},t.prototype.getIntersections=function(t,e){for(var i=this,o=[],a=function(a){var T=I.rays[a].cast(e);if(T){var c=(0,E.getRelativeChunkMultiplier)(T.distance);o.push(n(n({},T),{distance:Math.round(T.distance*c)/c,index:a}))}I.rays[a].castDDA(t).forEach((function(e){var n=e.obstacle,I=e.intersectionVertex,T=e.distance,c=n.position,h=(0,E.getRelativeChunkMultiplier)(T),u=I,S=Math.round(T*h)/h,l=(0,s.getNeighbors)(t,n.matrixCoordinates),O=null;if((0,r.isSprite)(n)||(0,r.isItem)(n)){O=n.getRotatedPerpendicularlyToViewPosition(i.angle);var L=i.rays[a].cast([O]);if(!L)return;S=Math.round(L.distance*h)/h,u=L.intersectionVertex}else(0,r.isWall)(n)&&(u.y!==c.y1&&u.x===c.x1&&(O=n.getWallBySide(_.OBSTACLE_SIDES.LEFT,l.LEFT)),u.y!==c.y1&&u.x===c.x2&&(O=n.getWallBySide(_.OBSTACLE_SIDES.RIGHT,l.RIGHT)),u.y===c.y1&&u.x!==c.x1&&(O=n.getWallBySide(_.OBSTACLE_SIDES.TOP,l.TOP)),u.y===c.y2&&u.x!==c.x1&&(O=n.getWallBySide(_.OBSTACLE_SIDES.BOTTOM,l.BOTTOM)));O&&o.push({obstacle:O,distance:S,index:a,intersectionVertex:u})}))},I=this,T=0;T<this.rays.length;T++)a(T);return o},t.prototype.changeRaysAmount=function(t){this.rays=[];for(var e=Math.floor(t*RESOLUTION_SCALE),i=Math.tan(FOV/2),n=i/(e/2),r=0;r<e;r++){var s=this.angle+Math.atan(n*r-i);s<0&&(s+=2*Math.PI),s>2*Math.PI&&(s-=2*Math.PI),this.rays.push(new o.Ray(this.position,s,this.angle))}},t.prototype.rotate=function(t){this._angle+=(0,I.toRadians)(t.movementX/3),this._angle=this._angle%(2*Math.PI),this._angle<0&&(this._angle+=2*Math.PI);for(var e=Math.tan(FOV/2),i=e/(10*Math.floor(this.rays.length/10)/2),n=0;n<this.rays.length;n++){var o=this._angle+Math.atan(i*n-e);o<0&&(o+=2*Math.PI),o>2*Math.PI&&(o-=2*Math.PI),this.rays[n].changeAngle(o,this._angle)}},t}();e.Camera=T},654:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Hud=void 0;var n=i(639);i(230),i(386);var o=i(798),r=i(525),s=function(){function t(t,e){this.ctx=t,this.screenData=e,this.currentFrameSet=o.ACTOR_PORTRAIT_FRAME_SETS.HEALTHY,this.scale=this.screenData.screenWidth*r.HUD_WIDTH_COEFFICIENT/o.HUD_PANEL.WIDTH,this.width=Math.round(this.screenData.screenWidth*r.HUD_WIDTH_COEFFICIENT),this.height=Math.round(o.HUD_PANEL.HEIGHT*this.scale),this.offsetX=this.screenData.screenWidth/2-this.width/2,this.offsetY=this.screenData.screenHeight-this.height,this.renderPortrait=this.renderPortrait.bind(this),this.portraitAnimation=new n.AnimationController({renderFunction:this.renderPortrait,frameSet:this.currentFrameSet,initialFrameIdx:0,isLoopAnimation:!0})}return t.prototype.getHealthFrameSet=function(t){return t>85?o.ACTOR_PORTRAIT_FRAME_SETS.HEALTHY:t>75?o.ACTOR_PORTRAIT_FRAME_SETS.JUST_A_SCRATCH:t>50?o.ACTOR_PORTRAIT_FRAME_SETS.MINOR_DAMAGE:t>35?o.ACTOR_PORTRAIT_FRAME_SETS.MODERATE_DAMAGE:t>20?o.ACTOR_PORTRAIT_FRAME_SETS.SEVERE_DAMAGE:t>5?o.ACTOR_PORTRAIT_FRAME_SETS.SUFFERING:t>0?o.ACTOR_PORTRAIT_FRAME_SETS.NEAR_DEATH:o.ACTOR_PORTRAIT_FRAME_SETS.DEAD},t.prototype.renderPortrait=function(t){var e=this.offsetX+Math.round(o.HUD_PANEL.PORTRAIT_X_OFFSET*this.scale),i=this.offsetY+Math.round(o.HUD_PANEL.PORTRAIT_Y_OFFSET*this.scale);this.ctx.drawImage(t,0,0,o.PORTRAIT_WIDTH,o.PORTRAIT_HEIGHT,e,i,Math.round(o.PORTRAIT_WIDTH*this.scale),Math.round(o.PORTRAIT_HEIGHT*this.scale))},t.prototype.renderText=function(t,e){for(var i=String(t),n=Math.ceil(i.length*o.FONT_SYMBOL_WIDTH*this.scale),r=0;r<i.length;r++){var s=Number(i[r])*o.FONT_SYMBOL_WIDTH,a=r*o.FONT_SYMBOL_WIDTH,_=this.offsetX+e+Math.ceil(a*this.scale)-n/2,E=this.offsetY+Math.ceil(o.HUD_PANEL.INFO_Y_OFFSET*this.scale);this.ctx.drawImage(o.FONT_IMAGE,s,0,o.FONT_SYMBOL_WIDTH,o.FONT_SYMBOL_HEIGHT,_,E,Math.ceil(o.FONT_SYMBOL_WIDTH*this.scale),Math.ceil(o.FONT_SYMBOL_HEIGHT*this.scale))}},t.prototype.render=function(t){var e=t.ammo,i=t.lives,n=t.score,s=t.health,a=t.currentWeapon,_=t.level,E=this.getHealthFrameSet(s);E!==this.currentFrameSet&&(this.currentFrameSet=E,this.portraitAnimation.updateFrameSet(this.currentFrameSet)),this.scale=this.screenData.screenWidth*r.HUD_WIDTH_COEFFICIENT/o.HUD_PANEL.WIDTH,this.width=Math.round(this.screenData.screenWidth*r.HUD_WIDTH_COEFFICIENT),this.height=Math.round(o.HUD_PANEL.HEIGHT*this.scale),this.offsetX=this.screenData.screenWidth/2-this.width/2,this.offsetY=this.screenData.screenHeight-this.height,this.ctx.drawImage(o.HUD_PANEL.TEXTURE,0,0,o.HUD_PANEL.WIDTH,o.HUD_PANEL.HEIGHT,this.offsetX,this.offsetY,this.width,this.height),this.ctx.drawImage(r.WEAPONS[a].icon,0,0,o.WEAPON_ICON_WIDTH,o.WEAPON_ICON_HEIGHT,this.offsetX+Math.round(o.HUD_PANEL.WEAPON_X_OFFSET*this.scale),this.offsetY+Math.round(o.HUD_PANEL.WEAPON_Y_OFFSET*this.scale),Math.round(o.WEAPON_ICON_WIDTH*this.scale),Math.round(o.WEAPON_ICON_HEIGHT*this.scale)),this.renderText(_,o.HUD_PANEL.LEVEL_X_OFFSET*this.scale),this.renderText(n,o.HUD_PANEL.SCORE_X_OFFSET*this.scale),this.renderText(i,o.HUD_PANEL.LIVES_X_OFFSET*this.scale),this.renderText(s,o.HUD_PANEL.HEALTH_X_OFFSET*this.scale),this.renderText(e,o.HUD_PANEL.AMMO_X_OFFSET*this.scale),this.portraitAnimation.iterate()},t}();e.Hud=s},539:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Minimap=void 0,i(230);var n=i(4),o=i(525),r=function(){function t(t,e,i,n){this.ctx=t,this.obstacles=e,this.rowsLength=i,this.columnsLength=n}return t.prototype.render=function(t){for(var e=this.rowsLength*o.TILE_SIZE,i=0,r=this.obstacles;i<r.length;i++){var s=r[i];(0,n.isWall)(s)&&s.isMovable?this.ctx.fillStyle="orange":this.ctx.fillStyle="white",(0,n.isWall)(s)&&this.ctx.fillRect(s.initialPosition.x1*o.MAP_SCALE,(e-s.initialPosition.y1-o.TILE_SIZE)*o.MAP_SCALE,o.TILE_SIZE*o.MAP_SCALE,o.TILE_SIZE*o.MAP_SCALE)}this.ctx.fillStyle="blue",this.ctx.ellipse(t.x*o.MAP_SCALE,(e-t.y)*o.MAP_SCALE,.8*o.TILE_SIZE*o.MAP_SCALE,.8*o.TILE_SIZE*o.MAP_SCALE,0,0,360),this.ctx.fill()},t}();e.Minimap=r},770:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Ray=void 0,i(230);var n=i(4),o=i(525),r=i(929),s=function(){function t(t,e,i){this.angle=e,this.cameraAngle=i,this.cameraPosition={x1:0,y1:0,x2:0,y2:0},this.move(t)}return t.prototype.changeAngle=function(t,e){this.cameraAngle=e,this.angle=t,this.move({x:this.cameraPosition.x1,y:this.cameraPosition.y1})},t.prototype.fixFishEye=function(t){return t*Math.cos(this.angle-this.cameraAngle)},t.prototype.getDistance=function(t){return Math.sqrt(Math.pow(t.x-this.cameraPosition.x1,2)+Math.pow(t.y-this.cameraPosition.y1,2))},t.prototype.move=function(t){this.cameraPosition={x1:t.x,y1:t.y,x2:t.x+Math.sin(this.angle)*o.RAY_LENGTH,y2:t.y+Math.cos(this.angle)*o.RAY_LENGTH}},t.prototype.castDDA=function(t){var e,i,s=[],a=(0,r.unitVector)({x:this.cameraPosition.x2-this.cameraPosition.x1,y:this.cameraPosition.y2-this.cameraPosition.y1}),_=this.cameraPosition.x1/o.TILE_SIZE,E=this.cameraPosition.y1/o.TILE_SIZE,I={x:Math.floor(this.cameraPosition.x1/o.TILE_SIZE),y:Math.floor(this.cameraPosition.y1/o.TILE_SIZE)},T=Math.abs(1/a.x),c=Math.abs(1/a.y),h=1,u=1;a.x<0?(h=-1,e=(_-I.x)*T):e=(I.x+1-_)*T,a.y<0?(u=-1,i=(E-I.y)*c):i=(I.y+1-E)*c;for(var S="x",l=0;l<o.RAY_LENGTH/o.TILE_SIZE;)if(e<i?(I.x+=h,l=e,e+=T,S="x"):(I.y+=u,l=i,i+=c,S="y"),I.x>=0&&I.x<64&&I.y>=0&&I.y<64&&t[I.y]&&t[I.y][I.x]){var O=t[I.y][I.x];if((0,n.isDoor)(O)||(0,n.isMovableEntity)(O)&&O.isMoving)continue;var L={x:_*o.TILE_SIZE+a.x*l*o.TILE_SIZE,y:E*o.TILE_SIZE+a.y*l*o.TILE_SIZE};if(L[S]=Math.round(L[S]),s.push({obstacle:O,distance:this.fixFishEye(l*o.TILE_SIZE),intersectionVertex:L}),(0,n.isSprite)(O)||(0,n.isItem)(O))continue;return s}return s},t.prototype.cast=function(t){for(var e=this,i=[],n=0,o=t;n<o.length;n++){var s=o[n],a=(0,r.getIntersectionVertexWithPlane)(this.cameraPosition,s.position);a&&i.push({vertex:a,obstacle:s})}if(i.length>0){var _=i[0],E=i.reduce((function(t,i){var n=e.getDistance(i.vertex);return t>n?(_=i,n):t}),1/0);return{intersectionVertex:_.vertex,obstacle:_.obstacle,distance:this.fixFishEye(E)}}return null},t}();e.Ray=s},259:function(t,e,i){var n=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.Scene=void 0,i(518),i(230);var o=i(539);i(460);var r=i(386);i(38);var s=i(559),a=i(4),_=i(525),E=i(641),I=i(929),T=i(414),c=function(){function t(t,e){this.canvas=t,this.ctx=t.getContext("2d"),this.map=e,this.currentlyMovingObstacles=[],this.screenData={screenHeight:this.canvas.height,screenWidth:this.canvas.width};var i=(0,s.parseMap)(e),n=i.obstacles,a=i.startPosition,_=i.doors,E=i.map;this.parsedMap=E,this.obstacles=n,this.doors=_,this.minimap=new o.Minimap(this.ctx,this.obstacles,this.map.length,this.map[0].length),this.actor=new r.Actor(this.ctx,this.screenData,a),this.camera=this.actor.camera,window.addEventListener("keypress",this.handleKeyPress.bind(this))}return t.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e,this.screenData.screenHeight=e,this.screenData.screenWidth=t,this.camera.changeRaysAmount(this.canvas.width)},t.prototype.getNonGridObstacles=function(){var t=this,e=this.actor.position,i=this.camera.angle,o=i-FOV,r=i+FOV,s=(0,I.getVertexByPositionAndAngle)(e,i),E=(0,I.getVertexByPositionAndAngle)(s,o),T=(0,I.getVertexByPositionAndAngle)(s,r),c={x1:e.x,y1:e.y,x2:E.x,y2:E.y,x3:T.x,y3:T.y};return n(n([],this.currentlyMovingObstacles,!0),this.doors,!0).reduce((function(t,i){var n=i.position;return(0,a.isWall)(i)?(e.x<=n.x1&&t.push(i.getWallBySide(_.OBSTACLE_SIDES.LEFT,null)),e.x>=n.x2&&t.push(i.getWallBySide(_.OBSTACLE_SIDES.RIGHT,null)),e.y<=n.y1&&t.push(i.getWallBySide(_.OBSTACLE_SIDES.TOP,null)),e.y>=n.y2&&t.push(i.getWallBySide(_.OBSTACLE_SIDES.BOTTOM,null)),t):(t.push(i),t)}),[]).filter((function(e){var i=!!t.camera.getViewAngleIntersection(e.position),n=e.position,o=n.x1,r=n.y1,s=n.x2,a=n.y2;return i||(0,I.getIsVertexInTheTriangle)({x:o,y:r},c)||(0,I.getIsVertexInTheTriangle)({x:s,y:a},c)}))},t.prototype.moveObstacles=function(){var t=this;this.currentlyMovingObstacles.forEach((function(e){var i=e.iterateMovement();(0,a.isDoor)(e)&&i&&(e.isInStartPosition||(e.closeTimeout=new E.Timeout((function(){t.actor.currentMatrixPosition.x>=e.endPositionMatrixCoordinates.x-1&&t.actor.currentMatrixPosition.x<=e.endPositionMatrixCoordinates.x+1&&t.actor.currentMatrixPosition.y>=e.endPositionMatrixCoordinates.y-1&&t.actor.currentMatrixPosition.y<=e.endPositionMatrixCoordinates.y+1?e.closeTimeout.set(_.DOOR_TIMEOUT):(e.closeTimeout=null,e.hasCollision=!0,t.currentlyMovingObstacles.push(e))})),e.closeTimeout.set(_.DOOR_TIMEOUT),e.hasCollision=!1)),(0,a.isWall)(e)&&i&&(t.parsedMap[e.endPositionMatrixCoordinates.y][e.endPositionMatrixCoordinates.x]=e,t.parsedMap[e.matrixCoordinates.y][e.matrixCoordinates.x]=null),i&&(t.currentlyMovingObstacles=t.currentlyMovingObstacles.filter((function(t){return t!==e})))}))},t.prototype.handleKeyPress=function(t){if(32===t.keyCode){for(var e=null,i=null,n=0;n<this.obstacles.length;n++){var o=this.obstacles[n];if(!(0,a.isSprite)(o)&&!(0,a.isItem)(o)&&o.isMovable&&!this.currentlyMovingObstacles.includes(o)){var r=this.camera.getViewAngleIntersection(o.position),s=Math.sqrt(Math.pow(this.actor.position.x-o.position.x1,2)+Math.pow(this.actor.position.y-o.position.y1,2));r&&s<=2*_.TILE_SIZE&&(e=n,i=o)}}if(null===e||!i||(0,I.hasEqualPosition)(i.position,i.endPosition))return;this.currentlyMovingObstacles.push(i)}},t.prototype.render=function(){this.ctx.imageSmoothingEnabled=!1,this.ctx.beginPath(),this.ctx.clearRect(0,0,this.screenData.screenWidth,this.screenData.screenHeight),this.ctx.closePath(),this.ctx.fillStyle="#383838",this.ctx.fillRect(0,0,1920,Math.ceil(this.screenData.screenHeight/2)),IS_PAUSED||(this.moveObstacles(),this.obstacles.forEach((function(t){(0,a.isDoor)(t)&&t.closeTimeout&&t.closeTimeout.iterate()})));for(var t=this.camera.getIntersections(this.parsedMap,this.getNonGridObstacles()),e=n([],t,!0).sort((function(t,e){return e.distance-t.distance})),i={startIndex:0,width:0,isInitial:!0,rays:[]},o=0;o<e.length;o++){var r=e[o],s=r.obstacle,E=r.index;i.isInitial&&(i.rays.push(r),i.width=1,i.startIndex=r.index,i.isInitial=!1);var I=(0,T.getTextureOffset)(r),c=e[o+1],h=c&&(0,T.getTextureOffset)(c),u=(null==c?void 0:c.index)===E||(null==c?void 0:c.index)===E+1,S=(null==c?void 0:c.distance)===r.distance,l=(null==c?void 0:c.obstacle.texture)===s.texture;if(u&&S&&l&&h===I)i.rays.push(c),i.width+=1;else{var O=!(0,a.isWall)(s)&&!(0,a.isDoor)(s)||s.intersectionType===_.INTERSECTION_TYPES.HORIZONTAL;I=(0,T.getTextureOffset)(i.rays[0]);var L=_.TILE_SIZE/r.distance*(180/FOV_DEGREES)*this.screenData.screenHeight/1.75,P=O&&((0,a.isWall)(s)||(0,a.isDoor)(s))?s.textureDark:s.texture,p=_.TEXTURE_SIZE,d=i.startIndex/RESOLUTION_SCALE,f=this.screenData.screenHeight/2-L/2,R=i.width/RESOLUTION_SCALE;i.rays=[],i.width=0,i.startIndex=0,i.isInitial=!0,this.ctx.drawImage(P,I,0,1,p,d,f,R,L)}}IS_PAUSED||(this.actor.render(),this.actor.move(this.parsedMap)),this.minimap.render(this.actor.position)},t}();e.Scene=c},641:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Timeout=void 0;var i=function(){function t(t){void 0===t&&(t=function(){}),this.timeoutTime=null,this.onTimeoutExpire=t}return Object.defineProperty(t.prototype,"isExpired",{get:function(){return!this.timeoutTime},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.timeoutTime=null},t.prototype.set=function(t){this.timeoutTime=(new Date).getTime()+t},t.prototype.iterate=function(){IS_PAUSED||this.timeoutTime&&(new Date).getTime()>this.timeoutTime&&(this.timeoutTime=null,this.onTimeoutExpire())},t}();e.Timeout=i},223:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Entity=void 0,i(230),i(525);var n=function(){function t(t){this._matrixCoordinates=t.matrixCoordinates,this._position=t.position,this.hasCollision=t.hasCollision,this.texture=t.texture,this.rawValue=t.rawValue}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"matrixCoordinates",{get:function(){return this._matrixCoordinates},enumerable:!1,configurable:!0}),t}();e.Entity=n},85:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.MovableEntity=void 0,i(230);var r=i(525),s=function(t){function e(e){var i=t.call(this,e)||this;return i._matrixCoordinates=e.matrixCoordinates,i._endPositionMatrixCoordinates=e.endPositionMatrixCoordinates,i._initialPosition=e.initialPosition,i._position=e.position,i._endPosition=e.endPosition,i._isMoving=e.isMoving,i._isInFinalPosition=e.isInFinalPosition,i._isInStartPosition=e.isInStartPosition,i.isMovable=e.isMovable,i}return o(e,t),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matrixCoordinates",{get:function(){return this._matrixCoordinates},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endPositionMatrixCoordinates",{get:function(){return this._endPositionMatrixCoordinates},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initialPosition",{get:function(){return this._initialPosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endPosition",{get:function(){return this._endPosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMoving",{get:function(){return this._isMoving},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInFinalPosition",{get:function(){return this._isInFinalPosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInStartPosition",{get:function(){return this._isInStartPosition},enumerable:!1,configurable:!0}),e.prototype.getPositionChange=function(t,e){return t>e?-r.OBSTACLES_MOVE_SPEED:t<e?r.OBSTACLES_MOVE_SPEED:0},e.prototype.iterateMovement=function(){if(!IS_PAUSED&&this.isMovable){this._isMoving=!0;var t=this._isInStartPosition?this._endPosition:this._initialPosition;return this._position={x1:this._position.x1+this.getPositionChange(this._position.x1,t.x1)*TIME_SCALE,y1:this._position.y1+this.getPositionChange(this._position.y1,t.y1)*TIME_SCALE,x2:this._position.x2+this.getPositionChange(this._position.x2,t.x2)*TIME_SCALE,y2:this._position.y2+this.getPositionChange(this._position.y2,t.y2)*TIME_SCALE},Math.round(this._position.x1*r.TILE_SIZE)/r.TILE_SIZE===t.x1&&Math.round(this._position.y1*r.TILE_SIZE)/r.TILE_SIZE===t.y1&&Math.round(this._position.x2*r.TILE_SIZE)/r.TILE_SIZE===t.x2&&Math.round(this._position.y2*r.TILE_SIZE)/r.TILE_SIZE===t.y2&&(this._position=t,this._isMoving=!1,this._isInStartPosition=!this._isInStartPosition,this._isInFinalPosition=!this._isInFinalPosition,!0)}},e}(i(223).Entity);e.MovableEntity=s},460:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.DoorObstacle=void 0;var r=i(85);i(641);var s=i(525),a=function(t){function e(e){var i=t.call(this,e)||this;return i.textureDark=e.textureDark,i.isVertical=e.isVertical,i.isDoor=!0,i.closeTimeout=e.closeTimeout,i.shouldReverseTexture=!e.isVertical,i.intersectionType=e.isVertical?s.INTERSECTION_TYPES.VERTICAL:s.INTERSECTION_TYPES.HORIZONTAL,i}return o(e,t),e}(r.MovableEntity);e.DoorObstacle=a},295:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.ItemObstacle=void 0,i(230),i(223);var r=function(t){function e(e){var i=t.call(this,e)||this;return i.isItem=!0,i.purpose=e.purpose,i}return o(e,t),e}(i(969).SpriteObstacle);e.ItemObstacle=r},969:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteObstacle=void 0,i(230);var s=i(525),a=function(t){function e(e){var i=t.call(this,e)||this;return i.isSprite=!0,i}return o(e,t),e.prototype.getRotatedPerpendicularlyToViewPosition=function(t){var e=this.position.x1,i=this.position.y1,n=(this.position.x2+e)/2,o=(this.position.y2+i)/2,a=-t;return r(r({},this),{position:{x1:n+s.TILE_SIZE/2*Math.cos(a),y1:o+s.TILE_SIZE/2*Math.sin(a),x2:n-s.TILE_SIZE/2*Math.cos(a),y2:o-s.TILE_SIZE/2*Math.sin(a)}})},e}(i(223).Entity);e.SpriteObstacle=a},38:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.WallObstacle=void 0;var s=i(85);i(230);var a=i(4),_=i(525),E=i(380),I=function(t){function e(e){var i=t.call(this,e)||this;return i.isWall=!0,i.textureDark=e.textureDark,i.intersectionType=_.INTERSECTION_TYPES.HORIZONTAL,i.shouldReverseTexture=!1,i}return o(e,t),e.prototype.getWallBySide=function(t,e){var i=t===_.OBSTACLE_SIDES.TOP||t===_.OBSTACLE_SIDES.BOTTOM,n={x1:this.position.x1+(t===_.OBSTACLE_SIDES.RIGHT?_.TILE_SIZE:0),y1:this.position.y1+(t===_.OBSTACLE_SIDES.BOTTOM?_.TILE_SIZE:0),x2:this.position.x2-(t===_.OBSTACLE_SIDES.LEFT?_.TILE_SIZE:0),y2:this.position.y2-(t===_.OBSTACLE_SIDES.TOP?_.TILE_SIZE:0)},o=this.texture,s=this.textureDark;return(0,a.isDoor)(e)&&(o=(0,E.getImageWithSource)("src/assets/textures/".concat(_.DOOR_SIDE_WALL_TEXTURE_ID,".png")),s=(0,E.getImageWithSource)("src/assets/textures/".concat(_.DOOR_SIDE_WALL_TEXTURE_DARK_ID,".png"))),r(r({},this),{position:n,intersectionType:i?_.INTERSECTION_TYPES.VERTICAL:_.INTERSECTION_TYPES.HORIZONTAL,shouldReverseTexture:!(0,a.isDoor)(e)&&(t===_.OBSTACLE_SIDES.LEFT||t===_.OBSTACLE_SIDES.BOTTOM),texture:o,textureDark:s})},e}(s.MovableEntity);e.WallObstacle=I},230:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),i(460),i(38),i(969),i(295)},4:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isDesiredPurpose=e.isMovableEntity=e.isDoor=e.isWall=e.isItem=e.isSprite=void 0,i(230),i(969),i(295),i(38),i(460),e.isSprite=function(t){return!!t&&!!t.isSprite},e.isItem=function(t){return!!t&&!!t.isItem},e.isWall=function(t){return!!t&&!!t.isWall},e.isDoor=function(t){return!!t&&!!t.isDoor},e.isMovableEntity=function(t){return(0,e.isDoor)(t)||(0,e.isWall)(t)},e.isDesiredPurpose=function(t,e){return t.affects===e}},380:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getImageWithSource=void 0;var i={};e.getImageWithSource=function(t){if(i[t])return i[t];var e=new Image;return e.src=t,i[t]=e,e}},559:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseMap=void 0,i(230);var n=i(460),o=i(38),r=i(969),s=i(295),a=i(525),_=i(380);e.parseMap=function(t){for(var e=[],i=[],E=[],I={x:0,y:0},T={},c=0;c<t.length;c++){e.push([]);for(var h=0;h<t[c].length;h++)if((S=t[c][h])&&"string"==typeof S){var u=S.split("_");"END"===u[2]&&(T[u[1]]={x1:h*a.TILE_SIZE,y1:c*a.TILE_SIZE,x2:h*a.TILE_SIZE+a.TILE_SIZE,y2:c*a.TILE_SIZE+a.TILE_SIZE})}}for(c=0;c<t.length;c++)for(h=0;h<t[c].length;h++){var S;if(S=t[c][h]){if(S){if("START_POS"===S){I={x:h*a.TILE_SIZE+a.TILE_SIZE/2,y:c*a.TILE_SIZE+a.TILE_SIZE/2},e[c].push(null);continue}var l="number"==typeof S?[]:S.split("_"),O="number"!=typeof S?Number(l[0]):S;if(l&&l.includes("END")){e[c].push(null);continue}var L=h%63==0||c%63==0,P=l.includes("ITEM"),p=l.includes("SPRITE")||!1,d=!p&&l.includes("START"),f=!p&&a.DOOR_IDS.includes(O),R=!p&&(f||d)&&!L,y=!P&&!p&&!f,M=!l.includes("HOLLOW"),m=null;P&&(m=a.ITEMS_PURPOSES[O]);var A=!(!t[c][h-1]||!t[c][h+1]),x={x1:h*a.TILE_SIZE+(!A&&f?.5*a.TILE_SIZE:0),y1:c*a.TILE_SIZE+(A&&f?.5*a.TILE_SIZE:0),x2:h*a.TILE_SIZE+(!A&&f?.5*a.TILE_SIZE:a.TILE_SIZE),y2:c*a.TILE_SIZE+(A&&f?.5*a.TILE_SIZE:a.TILE_SIZE)},H=d&&l?T[l[1]]:{x1:A?x.x1+a.TILE_SIZE:x.x1,y1:A?x.y1:x.y1-a.TILE_SIZE,x2:A?x.x2+a.TILE_SIZE:x.x2,y2:A?x.y2:x.y2-a.TILE_SIZE};if(y){var v=new o.WallObstacle({endPositionMatrixCoordinates:{y:Math.floor(H.y1/a.TILE_SIZE),x:Math.floor(H.x1/a.TILE_SIZE)},matrixCoordinates:{y:Math.floor(x.y1/a.TILE_SIZE),x:Math.floor(x.x1/a.TILE_SIZE)},initialPosition:x,position:x,endPosition:H,isInFinalPosition:!1,isInStartPosition:!0,isMovable:R,isMoving:!1,hasCollision:M,texture:(0,_.getImageWithSource)("src/assets/textures/".concat(O,".png")),textureDark:(0,_.getImageWithSource)("src/assets/textures/".concat(O+1,".png")),rawValue:S});e[c].push(v),i.push(v)}else if(p&&!P){var g=new r.SpriteObstacle({matrixCoordinates:{y:Math.floor(x.y1/a.TILE_SIZE),x:Math.floor(x.x1/a.TILE_SIZE)},position:x,hasCollision:M,texture:(0,_.getImageWithSource)("src/assets/sprites/".concat(M?"static":"hollow","/").concat(O,".png")),rawValue:S});e[c].push(g),i.push(g)}else if(P){var W=new s.ItemObstacle({matrixCoordinates:{y:Math.floor(x.y1/a.TILE_SIZE),x:Math.floor(x.x1/a.TILE_SIZE)},position:x,hasCollision:M,texture:(0,_.getImageWithSource)("src/assets/sprites/items/".concat(O,".png")),rawValue:S,purpose:m});e[c].push(W),i.push(W)}else if(f){var D=new n.DoorObstacle({endPositionMatrixCoordinates:{y:Math.floor(H.y1/a.TILE_SIZE),x:Math.floor(H.x1/a.TILE_SIZE)},matrixCoordinates:{y:Math.floor(x.y1/a.TILE_SIZE),x:Math.floor(x.x1/a.TILE_SIZE)},initialPosition:x,position:x,endPosition:H,isInFinalPosition:!1,isInStartPosition:!0,isMovable:R,isMoving:!1,isVertical:A,hasCollision:M,texture:(0,_.getImageWithSource)("src/assets/textures/".concat(O,".png")),textureDark:(0,_.getImageWithSource)("src/assets/textures/".concat(O+1,".png")),rawValue:S,closeTimeout:null});e[c].push(D),i.push(D),E.push(D)}}}else e[c].push(null)}return{map:e,obstacles:i,startPosition:I,doors:E}}}},e={};!function i(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}(519)})();