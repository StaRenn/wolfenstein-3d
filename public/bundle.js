(()=>{"use strict";var t={525:(t,e,i)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.ENEMY_FACING_DIRECTION_MAP=e.NEIGHBOR_OFFSET=e.OBSTACLE_SIDES=e.INTERSECTION_TYPES=e.ITEMS_PURPOSES=e.WEAPONS=e.DEFAULT_RESOLUTION_SCALE=e.DEFAULT_FOV=e.DEFAULT_FOV_DEGREES=e.ENEMY_VIEW_DISTANCE=e.WOLF_ATTACK_FOV=e.ENEMY_FOV=e.ACTOR_SPEED=e.OBSTACLES_MOVE_SPEED=e.MAP_SCALE=e.HUD_WIDTH_COEFFICIENT=e.DOOR_TIMEOUT=e.RESOLUTIONS_SCALE_VALUES=e.DEFAULT_FRAME_DURATION=e.TEXTURE_SIZE=e.DOOR_SIDE_WALL_TEXTURE_DARK_ID=e.DOOR_SIDE_WALL_TEXTURE_ID=e.AMMO_ID=e.DOOR_IDS=e.RAY_LENGTH=e.TILE_SIZE=void 0;var o=i(380),r=i(11),_=i(929);e.TILE_SIZE=10,e.RAY_LENGTH=48*e.TILE_SIZE,e.DOOR_IDS=[27,28,33,34,35,36],e.AMMO_ID=34,e.DOOR_SIDE_WALL_TEXTURE_ID=30,e.DOOR_SIDE_WALL_TEXTURE_DARK_ID=29,e.TEXTURE_SIZE=64,e.DEFAULT_FRAME_DURATION=1e3/60,e.RESOLUTIONS_SCALE_VALUES=[.5,1],e.DOOR_TIMEOUT=4e3,e.HUD_WIDTH_COEFFICIENT=.6,e.MAP_SCALE=.6,e.OBSTACLES_MOVE_SPEED=e.TILE_SIZE/(4*e.TILE_SIZE),e.ACTOR_SPEED=1,e.ENEMY_FOV=(0,_.toRadians)(120),e.WOLF_ATTACK_FOV=(0,_.toRadians)(15),e.ENEMY_VIEW_DISTANCE=16*e.TILE_SIZE,e.DEFAULT_FOV_DEGREES=90,e.DEFAULT_FOV=(0,_.toRadians)(e.DEFAULT_FOV_DEGREES),e.DEFAULT_RESOLUTION_SCALE=.5,window.TIME_SCALE=1,e.WEAPONS={KNIFE:{frameSet:(0,r.fillWeaponFrameSet)("KNIFE",50),maxDistance:10,damage:25,frameDuration:50,ammoPerAttack:0,shootFrameIdx:2,icon:(0,o.getImageWithSource)("src/assets/hud/knife.png")},PISTOL:{frameSet:(0,r.fillWeaponFrameSet)("PISTOL",65),maxDistance:20*e.TILE_SIZE,damage:50,frameDuration:65,ammoPerAttack:1,shootFrameIdx:2,icon:(0,o.getImageWithSource)("src/assets/hud/pistol.png")},MACHINE_GUN:{frameSet:(0,r.fillWeaponFrameSet)("MACHINE_GUN",25),maxDistance:20*e.TILE_SIZE,damage:30,frameDuration:22.5,ammoPerAttack:1,shootFrameIdx:2,icon:(0,o.getImageWithSource)("src/assets/hud/machine_gun.png")}},e.ITEMS_PURPOSES={34:{affects:"ammo",value:8},35:{affects:"health",value:10},39:{affects:"health",value:25},36:{affects:"score",value:100},37:{affects:"score",value:1},38:{affects:"score",value:500},42:{affects:"score",value:1e3},40:{affects:"weapons",value:"MACHINE_GUN"},41:{affects:"weapons",value:"MACHINE_GUN"}},e.INTERSECTION_TYPES={VERTICAL:"VERTICAL",HORIZONTAL:"HORIZONTAL"},e.OBSTACLE_SIDES={TOP:"TOP",BOTTOM:"BOTTOM",LEFT:"LEFT",RIGHT:"RIGHT"},e.NEIGHBOR_OFFSET=((n={})[e.OBSTACLE_SIDES.TOP]=-1,n[e.OBSTACLE_SIDES.BOTTOM]=1,n[e.OBSTACLE_SIDES.LEFT]=-1,n[e.OBSTACLE_SIDES.RIGHT]=1,n),e.ENEMY_FACING_DIRECTION_MAP={WEST:0,NORTH:90,EAST:180,SOUTH:-90}},798:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ACTOR_PORTRAIT_FRAME_SETS=e.PORTRAIT_HEIGHT=e.PORTRAIT_WIDTH=e.WEAPON_ICON_HEIGHT=e.WEAPON_ICON_WIDTH=e.FONT_SYMBOL_HEIGHT=e.FONT_SYMBOL_WIDTH=e.FONT_IMAGE=e.HUD_PANEL=void 0;var n=i(380),o=i(11);e.HUD_PANEL={TEXTURE:(0,n.getImageWithSource)("src/assets/hud/panel.png"),WIDTH:400,HEIGHT:40,INFO_Y_OFFSET:16,WEAPON_Y_OFFSET:8,LEVEL_X_OFFSET:65,SCORE_X_OFFSET:111,LIVES_X_OFFSET:156,HEALTH_X_OFFSET:219,AMMO_X_OFFSET:262,WEAPON_X_OFFSET:296,PORTRAIT_X_OFFSET:174,PORTRAIT_Y_OFFSET:5},e.FONT_IMAGE=(0,n.getImageWithSource)("src/assets/hud/font.png"),e.FONT_SYMBOL_WIDTH=8,e.FONT_SYMBOL_HEIGHT=16,e.WEAPON_ICON_WIDTH=48,e.WEAPON_ICON_HEIGHT=24,e.PORTRAIT_WIDTH=30,e.PORTRAIT_HEIGHT=31,e.ACTOR_PORTRAIT_FRAME_SETS={HEALTHY:(0,o.fillPortraitFrameSet)("HEALTHY"),JUST_A_SCRATCH:(0,o.fillPortraitFrameSet)("JUST_A_SCRATCH"),MINOR_DAMAGE:(0,o.fillPortraitFrameSet)("MINOR_DAMAGE"),MODERATE_DAMAGE:(0,o.fillPortraitFrameSet)("MODERATE_DAMAGE"),SEVERE_DAMAGE:(0,o.fillPortraitFrameSet)("SEVERE_DAMAGE"),SUFFERING:(0,o.fillPortraitFrameSet)("SUFFERING"),NEAR_DEATH:(0,o.fillPortraitFrameSet)("NEAR_DEATH"),DEAD:[{data:(0,n.getImageWithSource)("src/assets/hud/portrait/dead/frame_0.png"),duration:1e4}]}},300:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.map=void 0,e.map=[[0,0,1,1,1,1,1,"1_ID617_END",1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,1,1,3,1,1,1,1,3,1,1,1,1,3,3,1,1,3,1,1,3,3,1,1,3,3,3],[0,0,1,"39_SPRITE_HOLLOW_ITEM",0,0,0,0,"41_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,3,1,1,1,3,3,"5_ID6037_END",1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,3],[37,37,1,3,"1_ID614_START",3,1,"1_ID617_START",3,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,"35_SPRITE_HOLLOW_ITEM","35_SPRITE_HOLLOW_ITEM",0,0,0,0,0,1,"39_SPRITE_HOLLOW_ITEM",0,"39_SPRITE_HOLLOW_ITEM",1,0,0,0,0,"ENEMY_GUARD_IDLE_EAST",0,0,0,0,0,0,3,0,"24_SPRITE_HOLLOW",0,27,0,"24_SPRITE_HOLLOW",0,0,0,"24_SPRITE_HOLLOW",0,5],[37,0,0,0,0,1,1,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM","1_ID5810_END",1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,"35_SPRITE_HOLLOW_ITEM","11_SPRITE",0,0,"ENEMY_GUARD_IDLE_WEST","11_SPRITE",0,3,1,"5_ID6037_START",1,3,0,0,3,0,0,0,0,0,1,0,0,3,0,0,0,1,0,0,0,0,0,0,0,1],[37,0,37,1,"1_ID614_END",1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,"ENEMY_GUARD_IDLE_NORTH",0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3,1,1,3,1,0,0,0,3],[37,0,37,1,1,1,1,1,3,1,"1_ID5810_START",11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,"24_SPRITE_HOLLOW",0,27,0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,27,0,0,0,1,"42_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",3,0,0,0,1],[37,0,37,3,"34_SPRITE_HOLLOW_ITEM",0,0,0,"34_SPRITE_HOLLOW_ITEM",0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,"ENEMY_GUARD_IDLE_NORTH",0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,"ENEMY_GUARD_IDLE_EAST",1,"ENEMY_GUARD_IDLE_EAST",0,0,1,"38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM",1,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,"39_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,"11_SPRITE","23_SPRITE_HOLLOW",0,0,"11_SPRITE",0,3,0,0,0,3,0,0,1,0,0,0,"ENEMY_GUARD_IDLE_WEST",0,3,0,0,1,0,0,0,1,"42_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",1,0,0,0,1],[37,0,37,3,1,3,1,0,1,3,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1,"36_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM",1,0,0,0,1],[37,0,37,0,0,1,1,27,1,1,1,1,3,1,1,11,1,1,1,0,0,3,1,3,1,3,0,1,3,1,3,3,1,1,3,1,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3,"42_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",3,0,0,0,1],[37,0,37,0,1,1,0,0,"ENEMY_GUARD_IDLE_EAST",0,0,1,0,0,0,0,0,0,1,3,0,1,0,"ENEMY_GUARD_IDLE_EAST",0,1,0,3,"1_SPRITE",0,0,0,0,0,0,3,0,0,0,3,1,1,1,1,1,27,1,1,3,3,1,1,0,0,0,1,"36_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM",1,0,0,0,1],[37,0,37,1,1,"1_SPRITE",0,0,0,0,0,3,"1_SPRITE",0,0,0,0,0,0,1,1,3,0,0,0,3,1,1,0,0,"22_SPRITE_HOLLOW",0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1,0,0,0,1],[37,0,37,1,0,0,"ENEMY_GUARD_IDLE_WEST",0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,1,0,0,0,3,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,3,0,0,0,1,0,0,0,3],[37,0,37,3,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,"ENEMY_GUARD_IDLE_NORTH",0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,"24_SPRITE_HOLLOW",0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,"16_SPRITE",1,"1_SPRITE",0,0,0,0,0,0,1,0,0,"ENEMY_GUARD_IDLE_NORTH",0,0,0,0,1,0,0,0,1,1,27,1,1,1,1,3,3,1,3,3,1,1,3,1,1,0,0,0,1,0,0,0,1],[37,0,37,3,0,"14_SPRITE",0,0,"ENEMY_GUARD_IDLE_WEST","13_SPRITE",0,3,0,"22_SPRITE_HOLLOW",0,0,0,"16_SPRITE","16_SPRITE",3,"1_SPRITE","1_SPRITE",0,0,0,3,3,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1],[37,0,37,1,0,0,"ENEMY_GUARD_IDLE_NORTH",0,0,0,0,1,1,0,0,0,0,0,"35_SPRITE_HOLLOW_ITEM",1,"1_SPRITE","1_SPRITE",0,0,"ENEMY_GUARD_IDLE_EAST",1,0,3,0,0,0,0,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1],[37,0,37,1,1,3,1,1,3,1,1,1,1,3,1,27,1,3,1,1,3,1,3,1,3,1,0,3,1,1,3,1,1,1,1,3,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3],[37,0,37,1,1,"12_SPRITE",1,"12_SPRITE",3,"12_SPRITE",1,1,0,0,0,"ENEMY_GUARD_IDLE_EAST",0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,11,0,"24_SPRITE_HOLLOW",0,"11_ID4543_START",0,"11_ID4543_END",1,1,3,3,1,3,1,3,3,1,1,1,1,3,0,0,0,1],[37,0,37,1,"12_SPRITE",0,0,0,0,0,0,1,0,0,0,0,"ENEMY_GUARD_IDLE_EAST",0,"18_SPRITE",1,0,0,0,0,0,0,0,1,0,"6_SPRITE","ENEMY_GUARD_IDLE_NORTH",0,0,"6_SPRITE",0,1,0,0,0,1,0,0,0,1,1,1,31,5,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1],[37,0,37,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,"ENEMY_GUARD_IDLE_EAST",0,3,0,31,0,33,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,1,0,0,0,1],[37,0,37,1,"12_SPRITE","ENEMY_GUARD_IDLE_NORTH",0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,"24_SPRITE_HOLLOW",0,3,0,0,0,3,0,1,31,5,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1],[37,0,37,1,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,35,3,1,1,3,1,3,0,0,0,1,1,0,1,1,0,0,0,1,0,0,0,3],[37,0,37,1,"12_SPRITE",0,0,0,0,"ENEMY_GUARD_IDLE_EAST",0,3,"16_SPRITE",0,0,0,0,0,"17_SPRITE",1,0,0,0,0,0,0,0,1,0,"6_SPRITE",0,0,0,"6_SPRITE",0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1],[37,0,37,1,1,0,0,0,0,0,0,1,"16_SPRITE","16_SPRITE",0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,"ENEMY_GUARD_IDLE_NORTH",0,0,0,0,0,1,0,"24_SPRITE_HOLLOW",0,1,0,0,0,1,0,0,0,1],[37,0,37,0,1,1,1,27,1,1,3,1,3,1,3,3,1,3,1,1,0,0,0,0,0,0,0,1,1,1,1,27,1,1,1,1,0,0,0,3,0,0,0,1,0,0,0,0,0,0,0,1,"38_SPRITE_HOLLOW_ITEM","ENEMY_GUARD_IDLE_EAST","38_SPRITE_HOLLOW_ITEM",1,0,0,0,3,0,0,0,3],[37,0,37,1,1,0,0,0,0,0,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,0,0,3,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,"2_SPRITE",0,0,0,"2_SPRITE",0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,"ENEMY_GUARD_IDLE_NORTH",0,0,0,1,0,0,0,3,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,3,0,"24_SPRITE_HOLLOW",0,1],[37,0,37,3,0,0,0,"25_SPRITE_HOLLOW",0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,"24_SPRITE_HOLLOW",0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,3],[37,0,37,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,3,1,5,3,3,1,1,1,1,1,3,3,5,3,1,1,3,1,1,3,1,11,27,11,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,"2_SPRITE",0,0,0,"2_SPRITE",0,3,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,0,37,3,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,7,1,3,3,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3],[37,0,37,1,3,3,1,27,1,3,3,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,3,1,1,3,3,1,3,1,1,0,0,"ENEMY_GUARD_IDLE_WEST",1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,0,37,1,"ENEMY_GUARD_IDLE_NORTH",0,0,0,0,0,0,1,1,3,11,3,11,3,1,1,0,0,0,0,0,0,0,1,3,0,"38_SPRITE_HOLLOW_ITEM",0,"35_SPRITE_HOLLOW_ITEM",0,1,1,0,0,0,3,0,0,0,23,23,23,23,21,23,27,23,23,23,27,23,21,23,23,23,23,0,0,0,1],[37,0,37,3,0,"6_SPRITE",0,0,0,"6_SPRITE",0,1,0,"10_SPRITE",0,"10_SPRITE",0,"10_SPRITE",0,3,0,0,"ENEMY_GUARD_IDLE_NORTH",0,0,"ENEMY_GUARD_IDLE_EAST",0,3,0,"7_SPRITE",0,"38_SPRITE_HOLLOW_ITEM",0,"7_SPRITE",0,1,0,0,0,1,0,0,0,23,0,0,0,0,0,0,0,23,0,0,0,0,0,0,0,23,0,0,0,1],[37,0,37,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,"38_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM",0,"36_SPRITE_HOLLOW_ITEM",1,0,0,0,1,0,0,0,23,"38_SPRITE_HOLLOW_ITEM",0,"2_SPRITE",0,"2_SPRITE",0,"38_SPRITE_HOLLOW_ITEM",23,0,0,"2_SPRITE",0,"2_SPRITE",0,0,23,0,0,0,1],[37,0,37,3,0,"6_SPRITE",0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,0,27,0,0,0,"25_SPRITE_HOLLOW",0,0,"36_SPRITE_HOLLOW_ITEM",3,0,0,0,7,0,0,0,23,"ENEMY_GUARD_IDLE_NORTH",0,0,0,0,0,0,23,0,"ENEMY_GUARD_IDLE_EAST",0,0,0,"ENEMY_GUARD_IDLE_EAST",0,23,0,0,0,7],[37,0,37,1,0,0,"ENEMY_GUARD_IDLE_EAST",0,0,0,0,3,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,"ENEMY_GUARD_IDLE_EAST",0,0,"35_SPRITE_HOLLOW_ITEM",0,1,"ENEMY_GUARD_IDLE_WEST",0,0,1,0,0,0,23,0,0,"2_SPRITE",0,"2_SPRITE",0,"ENEMY_GUARD_IDLE_EAST",23,"36_SPRITE_HOLLOW_ITEM",0,"2_SPRITE",0,"2_SPRITE",0,"34_SPRITE_HOLLOW_ITEM",23,0,0,0,1],[37,0,37,1,0,"6_SPRITE",0,"6_SPRITE",0,"6_SPRITE",0,1,0,"10_SPRITE",0,"10_SPRITE",0,"10_SPRITE",0,3,0,0,0,0,"ENEMY_GUARD_IDLE_EAST",0,0,3,"ENEMY_GUARD_IDLE_EAST","7_SPRITE",0,"42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","7_SPRITE",0,1,0,0,0,3,0,0,0,23,0,0,"42_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM",0,0,23,"36_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM",0,"42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",23,0,0,0,1],[37,0,37,3,0,0,0,0,0,0,0,1,1,3,11,1,11,1,1,3,0,0,0,0,0,0,0,1,1,"36_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","35_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",3,3,0,0,0,1,0,0,0,23,23,23,23,19,23,23,23,23,23,23,23,19,23,23,23,23,0,0,0,3],[37,0,37,1,3,1,1,1,3,1,1,1,0,0,0,0,1,1,1,1,1,1,3,1,1,3,1,1,3,3,1,1,1,3,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,0,37,37,37,37,37,37,37,37,37,37,37,37,37,37,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,0,0,0,0,0,0,0,0,"38_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","36_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM",37,1,"ENEMY_GUARD_IDLE_NORTH",0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[37,"39_SPRITE_HOLLOW_ITEM",0,0,0,0,0,0,0,"36_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",37,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,5,3,1,1,3,1,1,3,1,3,5,1,1,3,1,1,3,1,3,3,5,1,1],[37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,1,3,1,3,27,1,1,1,1,1,1,1,3,27,3,1,1,1,1,1,1,1,3,15,15,17,17,15,15,17,15,15,17,17,15,17,17,15,17,15,15,17,15,17,15,17,17,17],[1,1,3,1,1,1,3,1,0,3,1,11,3,1,0,3,1,3,1,0,0,0,1,5,3,3,5,3,0,0,0,3,3,1,0,3,1,1,1,15,0,0,0,0,0,17,0,0,0,0,"35_SPRITE_HOLLOW_ITEM",15,0,0,0,0,0,15,"23_SPRITE_HOLLOW",0,0,"35_SPRITE_HOLLOW_ITEM",0,15],[1,0,0,0,0,0,0,1,5,3,0,0,0,1,7,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,11,1,0,0,1,15,0,0,"2_SPRITE","26_SPRITE_HOLLOW",0,17,0,0,"2_SPRITE",0,0,17,0,0,"2_SPRITE",0,0,17,0,0,"2_SPRITE",0,0,17],[3,0,"24_SPRITE_HOLLOW","ENEMY_GUARD_IDLE_WEST",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,1,17,0,0,"24_SPRITE_HOLLOW","35_SPRITE_HOLLOW_ITEM",0,17,0,0,"24_SPRITE_HOLLOW",0,0,15,0,0,"24_SPRITE_HOLLOW","23_SPRITE_HOLLOW",0,15,0,0,"24_SPRITE_HOLLOW",0,0,15],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,17,0,0,0,0,0,17,0,0,0,0,"26_SPRITE_HOLLOW",17,0,0,0,0,0,17,0,0,0,0,0,15],[1,0,0,0,0,0,0,1,5,1,0,0,0,1,7,1,0,0,0,1,11,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,15,0,0,0,0,0,15,0,0,0,0,0,17,0,0,0,0,0,15,0,0,0,0,0,17],[3,0,0,0,0,1,3,1,3,3,1,"11_ID1211_START",1,1,3,1,1,1,3,3,11,1,1,1,1,1,3,1,1,"1_ID1229_START",1,1,3,3,1,0,0,0,1,17,15,15,27,15,17,15,17,15,27,15,17,15,17,15,27,15,15,17,15,15,27,15,15,15],[1,1,0,0,1,1,0,0,0,0,0,0,1,"36_SPRITE_HOLLOW_ITEM","38_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",0,0,3,0,0,0,1,0,0,0,"42_SPRITE_HOLLOW_ITEM",0,1,0,0,0,0,0,3,0,0,0,0,15,"ENEMY_GUARD_IDLE_WEST",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9],[0,5,0,0,5,5,"34_SPRITE_HOLLOW_ITEM",0,0,0,0,"11_ID1211_END",11,"38_SPRITE_HOLLOW_ITEM","2_SPRITE","24_SPRITE_HOLLOW",0,0,27,0,"24_SPRITE_HOLLOW",0,27,0,0,"24_SPRITE_HOLLOW","2_SPRITE",0,11,"1_ID1229_END",0,0,0,"34_SPRITE_HOLLOW_ITEM",5,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15],[1,1,0,0,1,1,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",0,0,0,1,1,"38_SPRITE_HOLLOW_ITEM","ENEMY_GUARD_IDLE_EAST",0,0,0,1,0,0,0,1,0,0,0,"ENEMY_GUARD_IDLE_EAST","38_SPRITE_HOLLOW_ITEM",3,1,0,0,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",1,0,0,0,0,27,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,0,"24_SPRITE_HOLLOW",0,0,9],[3,0,0,0,0,1,1,1,3,3,3,3,1,1,1,3,3,1,1,1,27,1,1,1,1,3,1,1,1,1,1,1,3,1,1,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"ENEMY_GUARD_IDLE_WEST",0,0,0,0,0,0,0,15],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,"ENEMY_GUARD_IDLE_NORTH",0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,17,"ENEMY_GUARD_IDLE_EAST",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13],[1,0,"24_SPRITE_HOLLOW",0,0,0,0,0,0,0,0,0,27,0,0,"24_SPRITE_HOLLOW",0,0,0,0,"24_SPRITE_HOLLOW",0,0,0,0,"24_SPRITE_HOLLOW",0,0,27,0,0,0,0,0,0,0,"24_SPRITE_HOLLOW",0,1,17,17,15,27,15,17,17,15,17,27,15,17,15,15,15,27,15,17,15,15,15,27,15,17,15],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,17,0,0,0,0,0,15,0,"23_SPRITE_HOLLOW",0,0,0,15,0,0,0,0,0,15,0,0,0,0,0,15],[3,1,"1_ID42_START",1,3,1,3,3,1,3,1,3,1,1,3,1,3,3,1,0,0,0,1,1,3,1,3,1,1,1,1,1,3,3,3,3,1,3,3,15,0,0,0,0,0,17,0,0,0,0,0,17,0,0,"35_SPRITE_HOLLOW_ITEM",0,0,17,0,0,0,0,0,17],[0,1,0,0,0,1,1,1,1,1,1,1,1,0,0,"41_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,1,"39_SPRITE_HOLLOW_ITEM","39_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",1,0,0,0,0,0,0,0,1,0,0,15,0,0,"24_SPRITE_HOLLOW",0,0,15,"35_SPRITE_HOLLOW_ITEM",0,"24_SPRITE_HOLLOW",0,0,15,0,0,"24_SPRITE_HOLLOW","23_SPRITE_HOLLOW",0,15,0,"ENEMY_GUARD_IDLE_EAST","24_SPRITE_HOLLOW",0,0,15],[0,1,"1_ID42_END",0,0,0,0,0,0,"34_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM",1,0,0,0,"39_SPRITE_HOLLOW_ITEM",11,0,0,0,0,0,11,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",0,"42_SPRITE_HOLLOW_ITEM",0,0,0,0,0,0,0,0,1,"15_ID239_END",0,"15_ID239_START","26_SPRITE_HOLLOW",0,"2_SPRITE",0,0,15,0,0,"2_SPRITE",0,0,17,"35_SPRITE_HOLLOW_ITEM","ENEMY_GUARD_IDLE_EAST","2_SPRITE",0,0,17,0,0,"2_SPRITE","26_SPRITE_HOLLOW",0,15],[0,1,1,0,0,0,0,0,"34_SPRITE_HOLLOW_ITEM",0,"34_SPRITE_HOLLOW_ITEM","42_SPRITE_HOLLOW_ITEM","1_ID112_START",0,"1_ID112_END",1,1,1,0,0,"START_POS",0,0,1,"34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM","34_SPRITE_HOLLOW_ITEM",0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,17,0,0,0,0,0,17,"35_SPRITE_HOLLOW_ITEM","35_SPRITE_HOLLOW_ITEM",0,"ENEMY_GUARD_IDLE_EAST",0,17,0,0,0,"35_SPRITE_HOLLOW_ITEM","35_SPRITE_HOLLOW_ITEM",17],[0,0,1,1,1,3,3,1,3,3,3,3,3,1,1,1,0,1,1,1,33,1,3,1,1,3,1,1,1,3,3,1,1,3,3,1,3,3,1,17,15,17,17,15,15,15,15,17,17,17,17,17,17,17,17,15,15,15,15,15,15,15,15,17]]},11:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.generatePostEffectFrameSet=e.fillPortraitFrameSet=e.getEnemyFrameSet=e.fillDirection=e.fillWeaponFrameSet=e.DIRECTED_FRAME_SETS_BY_ACTION=e.NON_DIRECTED_FRAME_SETS_BY_ACTION=void 0;var n=i(380),o=["FRONT","FRONT_RIGHT","RIGHT","BACK_LEFT","BACK","BACK_RIGHT","LEFT","FRONT_LEFT"];function r(){return o.reduce((function(t,e){return t[e]=[],t}),{})}e.NON_DIRECTED_FRAME_SETS_BY_ACTION=["ATTACK","DIE","TAKING_DAMAGE"],e.DIRECTED_FRAME_SETS_BY_ACTION=["IDLE","WANDER","CHASE"],e.fillWeaponFrameSet=function(t,e){for(var i=[],o=0;o<5;o++)i.push((0,n.getImageWithSource)("src/assets/weapons/".concat(t.toLowerCase(),"/").concat(t.toLowerCase(),"_frame_").concat(o,".png")));return i.map((function(t){return{data:t,duration:e}}))},e.fillDirection=r,e.getEnemyFrameSet=function(t){var e={IDLE:r(),WANDER:r(),CHASE:r(),ATTACK:[],DIE:[],TAKING_DAMAGE:[]};e.TAKING_DAMAGE.push({data:(0,n.getImageWithSource)("src/assets/enemies/".concat(t,"/taking_damage/0.png")),duration:150});for(var i=0,_=o;i<_.length;i++){var a=_[i];e.IDLE[a].push({data:(0,n.getImageWithSource)("src/assets/enemies/".concat(t,"/idle/").concat(a.toLowerCase(),"_0.png")),duration:1/0})}for(var s=0;s<=2;s++)e.ATTACK.push({data:(0,n.getImageWithSource)("src/assets/enemies/".concat(t,"/attack/").concat(s,".png")),duration:150});for(s=0;s<=4;s++)e.DIE.push({data:(0,n.getImageWithSource)("src/assets/enemies/".concat(t,"/die/").concat(s,".png")),duration:4===s?1/0:100});return e},e.fillPortraitFrameSet=function(t){for(var e=[],i=0;i<3;i++)e.push((0,n.getImageWithSource)("src/assets/hud/portrait/".concat(t.toLowerCase(),"/frame_").concat(i,".png")));return[{data:e[0],duration:2e3},{data:e[1],duration:750},{data:e[2],duration:750},{data:e[1],duration:750},{data:e[0],duration:1500},{data:e[1],duration:1500},{data:e[2],duration:200},{data:e[1],duration:500},{data:e[2],duration:500},{data:e[1],duration:500}]},e.generatePostEffectFrameSet=function(t){return[{data:{color:"rgba(".concat(t.join(","),", 0)")},duration:1e4},{data:{color:"rgba(".concat(t.join(","),", 0.25)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.2)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.15)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.1)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.05)")},duration:40}]}},571:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRelativeChunkMultiplier=void 0;var n=i(525);e.getRelativeChunkMultiplier=function(t){return t<n.TILE_SIZE/2?24:t<3*n.TILE_SIZE?12:t<6*n.TILE_SIZE?2:1}},414:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getTextureOffset=void 0;var n=i(525),o=i(4);e.getTextureOffset=function(t){var e=t.obstacle,i=e.position,r=((0,o.isWall)(e)||(0,o.isDoor)(e))&&e.intersectionType===n.INTERSECTION_TYPES.VERTICAL,_=!1;((0,o.isSprite)(e)||(0,o.isItem)(e))&&Math.abs(i.x1-i.x2)>Math.abs(i.y1-i.y2)&&(_=!0);var a=((0,o.isWall)(e)||(0,o.isDoor)(e))&&e.shouldReverseTexture?{x:i.x2,y:i.y2}:{x:i.x1,y:i.y1},s=r||_?a.x-t.intersectionVertex.x:a.y-t.intersectionVertex.y,E=r||_?Math.abs(i.x1-i.x2):Math.abs(i.y1-i.y2),c=Math.abs(s)/E;return Math.floor(c*n.TEXTURE_SIZE)}},929:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getIntersectionVertexWithPlane=e.getDistanceWithoutFishEyeEffect=e.unitVector=e.vectorSize=e.getIsVertexInTheTriangle=e.getRangeOfView=e.getDistanceBetweenVertexes=e.getVertexByPositionAndAngle=e.getAngleBetweenVertexes=e.getAreaSize=e.hasEqualPosition=e.toDegrees=e.toRadians=void 0;var n=i(525);function o(t,e,i,n,o,r){return Math.abs((t*(n-r)+i*(r-e)+o*(e-n))/2)}function r(t,e){return{x:t.x+n.RAY_LENGTH*Math.sin(e),y:t.y+n.RAY_LENGTH*Math.cos(e)}}function _(t){var e=t.x,i=t.y;return Math.sqrt(e*e+i*i)}e.toRadians=function(t){return t*Math.PI/180},e.toDegrees=function(t){return 180/Math.PI*t},e.hasEqualPosition=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2},e.getAreaSize=o,e.getAngleBetweenVertexes=function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.atan2(i,n)},e.getVertexByPositionAndAngle=r,e.getDistanceBetweenVertexes=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},e.getRangeOfView=function(t,e,i){var n=t-e,o=t+e,_=r(i,t),a=r(_,n),s=r(_,o);return{x1:i.x,y1:i.y,x2:a.x,y2:a.y,x3:s.x,y3:s.y}},e.getIsVertexInTheTriangle=function(t,e){var i=t.x,n=t.y,r=e.x1,_=e.y1,a=e.x2,s=e.y2,E=e.x3,c=e.y3,u=o(r,_,a,s,E,c),T=o(i,n,a,s,E,c),I=o(r,_,i,n,E,c),l=o(r,_,a,s,i,n);return Math.round(u)==Math.round(T+I+l)},e.vectorSize=_,e.unitVector=function(t){var e=t.x,i=t.y,n=_({x:e,y:i});return{x:e/n,y:i/n}},e.getDistanceWithoutFishEyeEffect=function(t,e,i){return t*Math.cos(e-i)},e.getIntersectionVertexWithPlane=function(t,e){var i=t.x1,n=t.x2,o=t.y1,r=t.y2,_=e.x1,a=e.y1,s=e.x2,E=e.y2;if(!(i===n&&o===r||_===s&&a===E)){var c=(E-a)*(n-i)-(s-_)*(r-o);if(0!==c){var u=((s-_)*(o-a)-(E-a)*(i-_))/c,T=((n-i)*(o-a)-(r-o)*(i-_))/c;if(!(u<0||u>1||T<0||T>1))return{x:i+u*(n-i),y:o+u*(r-o)}}}}},519:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function _(t){try{s(n.next(t))}catch(t){r(t)}}function a(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(_,a)}s((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var i,n,o,r,_={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;_;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return _.label++,{value:r[1],done:!1};case 5:_.label++,n=r[1],r=[0];continue;case 7:r=_.ops.pop(),_.trys.pop();continue;default:if(!((o=(o=_.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){_=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){_.label=r[1];break}if(6===r[0]&&_.label<o[1]){_.label=o[1],o=r;break}if(o&&_.label<o[2]){_.label=o[2],_.ops.push(r);break}o[2]&&_.ops.pop(),_.trys.pop();continue}r=e.call(t,_)}catch(t){r=[6,t],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.canvas=void 0;var r=i(259),_=i(525),a=i(300),s=i(929);e.canvas=document.getElementById("canvas"),window.onload=function(){return n(this,void 0,void 0,(function(){function t(){L.resize(window.innerWidth,window.innerHeight)}function i(t){t.target&&(O=_.RESOLUTIONS_SCALE_VALUES[Number(t.target.value)],L.resolutionScale=O)}function n(t){if(t.target){var e=Number(t.target.value);p=(0,s.toRadians)(e),l.innerText=t.target.value,L.fov=p}}function E(t){"Escape"===t.key&&(S=!0,u.style.display="flex")}function c(){S&&(S=!1,u.style.display="none")}var u,T,I,l,h,S,O,p,L,f,d,P,R;return o(this,(function(o){return u=document.getElementById("menu-container"),T=document.getElementById("resolution-scale"),I=document.getElementById("fov"),l=document.getElementById("fovValue"),h=document.getElementById("continue-button"),S=!1,O=_.DEFAULT_RESOLUTION_SCALE,p=_.DEFAULT_FOV,I.value=String(_.DEFAULT_FOV_DEGREES),l.innerText=String(_.DEFAULT_FOV_DEGREES),T.value=String(_.RESOLUTIONS_SCALE_VALUES.indexOf(_.DEFAULT_RESOLUTION_SCALE)),L=new r.Scene(e.canvas,a.map,{height:window.innerHeight,width:window.innerWidth}),f=document.getElementById("fps"),d=0,P=0,R=0,function t(e){S||L.iterate(),L.render(),d=P;var i=(P=e)-d;R+=(i-R)/20,TIME_SCALE=Math.min(Math.round(i/_.DEFAULT_FRAME_DURATION*100)/100,1),requestAnimationFrame(t)}(0),setInterval((function(){f.innerHTML=(1e3/R).toFixed(1)+" fps"}),200),h.onclick=c,T.oninput=i,I.oninput=n,window.onkeydown=E,window.addEventListener("resize",t),e.canvas.onclick=function(){e.canvas.requestPointerLock()},[2]}))}))}},259:function(t,e,i){var n=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.Scene=void 0;var o=i(82),r=i(425),_=i(621),a=i(881),s=i(525),E=i(559),c=i(414),u=i(929),T=i(4),I=function(){function t(t,e,i){var n=this;this._canvas=t,this._ctx=t.getContext("2d"),this._map=e,this._currentlyMovingObstacles=[],this._screenData=i;var a=(0,E.parseMap)(e),s=a.obstacles,c=a.startPosition,u=a.doors,T=a.enemies,I=a.map;this._parsedMap=I,this._obstacles=s,this._doors=u,this._enemies=T,this._hud=new o.Hud({ctx:this._ctx,screenData:this._screenData,initialWeapon:"PISTOL"}),this._wolf=new _.Wolf({angle:0,ammo:50,ctx:this._ctx,currentWeapon:"PISTOL",health:50,level:0,lives:3,maxHealth:100,position:c,score:0,screenData:this._screenData,weapons:["KNIFE","PISTOL","MACHINE_GUN"],onBoostPickup:this._hud.onBoostPickup,onShoot:function(){n._hud.onShoot(),n.handleWolfShoot()},onWeaponChange:this._hud.onWeaponChange,rawValue:"START_POS"}),this._minimap=new r.Minimap({ctx:this._ctx,obstacles:this._obstacles,rowsLength:this._map.length}),this.resize(this._screenData.width,this._screenData.height),window.addEventListener("keypress",this.handleKeyPress.bind(this))}return Object.defineProperty(t.prototype,"resolutionScale",{set:function(t){this._wolf.camera.resolutionScale=t,this._wolf.camera.changeRaysAmount(this._canvas.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fov",{set:function(t){this._wolf.camera.fov=t,this._wolf.camera.changeRaysAmount(this._canvas.width)},enumerable:!1,configurable:!0}),t.prototype.resize=function(t,e){this._canvas.width=t,this._canvas.height=e,this._screenData.height=e,this._screenData.width=t,this._wolf.camera.changeRaysAmount(this._canvas.width)},t.prototype.getNonGridObstacles=function(){var t=this,e=this._wolf.position,i=this._wolf.angle,o=this._wolf.camera.fov,r=(0,u.getRangeOfView)(i,o,e);return n(n(n([],this._currentlyMovingObstacles,!0),this._doors,!0),this._enemies,!0).reduce((function(t,i){if((0,T.isEnemy)(i))return t.push(i.getPreparedSprite()),t;if(!(0,T.isWall)(i))return t.push(i),t;var n=i.position;return e.x<=n.x1&&t.push(i.wallSides.LEFT),e.x>=n.x2&&t.push(i.wallSides.RIGHT),e.y<=n.y1&&t.push(i.wallSides.TOP),e.y>=n.y2&&t.push(i.wallSides.BOTTOM),t}),[]).filter((function(e){var i=!!t._wolf.camera.getViewAngleIntersection(e.position),n=e.position,o=n.x1,_=n.y1,a=n.x2,s=n.y2;return i||(0,u.getIsVertexInTheTriangle)({x:o,y:_},r)||(0,u.getIsVertexInTheTriangle)({x:a,y:s},r)}))},t.prototype.moveObstacles=function(){var t=this;this._currentlyMovingObstacles.forEach((function(e){var i=e.iterateMovement();(0,T.isDoor)(e)&&i&&(e.isInStartPosition||(e.closeTimeout=new a.Timeout((function(){t._wolf.currentMatrixPosition.x>=e.endPositionMatrixCoordinates.x-1&&t._wolf.currentMatrixPosition.x<=e.endPositionMatrixCoordinates.x+1&&t._wolf.currentMatrixPosition.y>=e.endPositionMatrixCoordinates.y-1&&t._wolf.currentMatrixPosition.y<=e.endPositionMatrixCoordinates.y+1?e.closeTimeout.set(s.DOOR_TIMEOUT):(e.closeTimeout=null,e.hasCollision=!0,t._currentlyMovingObstacles.push(e))})),e.closeTimeout.set(s.DOOR_TIMEOUT),e.hasCollision=!1)),(0,T.isWall)(e)&&i&&(t._parsedMap[e.endPositionMatrixCoordinates.y][e.endPositionMatrixCoordinates.x]=e,t._parsedMap[e.matrixCoordinates.y][e.matrixCoordinates.x]=null),i&&(t._currentlyMovingObstacles=t._currentlyMovingObstacles.filter((function(t){return t!==e})))}))},t.prototype.handleWolfShoot=function(){var t=this,e=(0,u.getRangeOfView)(this._wolf.angle,s.WOLF_ATTACK_FOV,this._wolf.position),i=this._enemies.filter((function(i){return"DIE"!==i.currentState&&!!(0,u.getIsVertexInTheTriangle)(i.position,e)&&!(i.castToPosition(t._wolf.position,t._parsedMap).distance>s.WEAPONS[t._wolf.currentWeapon].maxDistance)&&i.castToPosition(t._wolf.position,t._parsedMap).isVisible})).sort((function(e,i){var n=e.castToPosition(t._wolf.position,t._parsedMap),o=i.castToPosition(t._wolf.position,t._parsedMap);return n.distance-o.distance}))[0];if(i){var n=s.WEAPONS[this._wolf.currentWeapon].damage;i.takeDamage(this._wolf.position,n,this._parsedMap)}},t.prototype.handleKeyPress=function(t){if(32===t.keyCode){for(var e=null,i=null,n=0;n<this._obstacles.length;n++){var o=this._obstacles[n];if(!(0,T.isSprite)(o)&&!(0,T.isItem)(o)&&o.isMovable&&!this._currentlyMovingObstacles.includes(o)){var r=this._wolf.camera.getViewAngleIntersection(o.position),_=Math.sqrt(Math.pow(this._wolf.position.x-o.position.x1,2)+Math.pow(this._wolf.position.y-o.position.y1,2));r&&_<=2*s.TILE_SIZE&&(e=n,i=o)}}if(null===e||!i||(0,u.hasEqualPosition)(i.position,i.endPosition))return;this._currentlyMovingObstacles.push(i)}},t.prototype.iterate=function(){var t=this;this._wolf.iterate(this._parsedMap),this.moveObstacles(),this._obstacles.forEach((function(t){(0,T.isDoor)(t)&&t.closeTimeout&&t.closeTimeout.iterate()})),this._enemies.forEach((function(e){e.iterate(t._wolf.position,t._wolf.angle,t._parsedMap)})),this._hud.iterate()},t.prototype.render=function(){this._ctx.imageSmoothingEnabled=!1,this._ctx.beginPath(),this._ctx.clearRect(0,0,this._screenData.width,this._screenData.height),this._ctx.closePath(),this._ctx.fillStyle="#383838",this._ctx.fillRect(0,0,1920,Math.ceil(this._screenData.height/2));for(var t=this._wolf.camera.getIntersections(this._parsedMap,this.getNonGridObstacles()),e=n([],t,!0).sort((function(t,e){return e.distance===t.distance?e.distance*(1e5*e.layer)-t.distance*(1e5*t.layer):e.distance-t.distance})),i={startTextureOffsetX:0,startIndex:0,width:0,isInitial:!0,rays:[]},o=0;o<e.length;o++){var r=e[o],_=r.obstacle,a=r.index,E=(0,T.isSprite)(_),u=e[o+1],I=(0,c.getTextureOffset)(r),l=u&&(0,c.getTextureOffset)(u);i.isInitial&&(i.rays.push(r),i.width=1,i.startIndex=r.index,i.startTextureOffsetX=I,i.isInitial=!1);var h=(null==u?void 0:u.layer)===r.layer,S=(null==u?void 0:u.obstacle)===r.obstacle,O=(null==u?void 0:u.index)===a||(null==u?void 0:u.index)===a+1,p=E||(null==u?void 0:u.distance)===r.distance,L=(null==u?void 0:u.obstacle.texture)===_.texture;if(E&&S&&h||!E&&O&&p&&L&&(E||l===I))i.rays.push(u),i.width+=1;else{var f=!(0,T.isWall)(_)&&!(0,T.isDoor)(_)||_.intersectionType===s.INTERSECTION_TYPES.HORIZONTAL,d=s.TILE_SIZE/r.distance*(Math.PI/this._wolf.camera.fov)*this._screenData.height/1.75,P=f&&((0,T.isWall)(_)||(0,T.isDoor)(_))?_.textureDark:_.texture,R=E?s.TEXTURE_SIZE-i.startTextureOffsetX-1:I,y=E?Math.abs(i.startTextureOffsetX-I):1,A=s.TEXTURE_SIZE,M=i.startIndex/this._wolf.camera.resolutionScale,m=this._screenData.height/2-d/2,g=i.width/this._wolf.camera.resolutionScale;i.rays=[],i.width=0,i.startIndex=0,i.isInitial=!0,this._ctx.drawImage(P,R,0,y,A,M,m,g,d)}}this._hud.render({currentWeapon:this._wolf.currentWeapon,ammo:this._wolf.ammo,lives:this._wolf.lives,score:this._wolf.score,level:this._wolf.level,health:this._wolf.health}),this._minimap.render(this._wolf.position,this._enemies)},t}();e.Scene=I},621:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Wolf=void 0;var r=i(539),_=i(525),a=i(431),s=i(4),E=function(t){function e(e){var i=t.call(this,e)||this;return i._ctx=e.ctx,i._ammo=e.ammo,i._score=e.score,i._lives=e.lives,i._level=e.level,i._weapons=e.weapons,i._camera=new a.Camera({raysAmount:e.screenData.width*_.DEFAULT_RESOLUTION_SCALE,position:e.position}),i.onBoostPickup=e.onBoostPickup,i.onWeaponChange=e.onWeaponChange,i.onShoot=e.onShoot,window.addEventListener("mousedown",i.handleMouseEvent.bind(i)),window.addEventListener("mouseup",i.handleMouseEvent.bind(i)),window.addEventListener("keydown",i.handleKeyDown.bind(i)),window.addEventListener("keyup",i.handleKeyUp.bind(i)),i}return o(e,t),Object.defineProperty(e.prototype,"angle",{get:function(){return this.camera.angle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ammo",{get:function(){return this._ammo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lives",{get:function(){return this._lives},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"health",{get:function(){return this._health},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentWeapon",{get:function(){return this._currentWeapon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"camera",{get:function(){return this._camera},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canShoot",{get:function(){return this._attackTimeout.isExpired&&(this._ammo>0||0===_.WEAPONS[this._currentWeapon].ammoPerAttack)},enumerable:!1,configurable:!0}),e.prototype.handleKeyDown=function(t){"1"===t.key?this.changeWeapon("KNIFE"):"2"===t.key?this.changeWeapon("PISTOL"):"3"===t.key&&this.changeWeapon("MACHINE_GUN"),87===t.keyCode?this._verticalSpeed=_.ACTOR_SPEED:83===t.keyCode?this._verticalSpeed=-_.ACTOR_SPEED:68===t.keyCode?this._horizontalSpeed=_.ACTOR_SPEED:65===t.keyCode&&(this._horizontalSpeed=-_.ACTOR_SPEED)},e.prototype.handleMouseEvent=function(t){1===t.buttons&&(this._isShooting=!0),0===t.buttons&&(this._isShooting=!1)},e.prototype.handleKeyUp=function(t){87===t.keyCode&&this._verticalSpeed>0||83===t.keyCode&&this._verticalSpeed<0?this._verticalSpeed=0:(68===t.keyCode&&this._horizontalSpeed>0||65===t.keyCode&&this._horizontalSpeed<0)&&(this._horizontalSpeed=0)},e.prototype.changeWeapon=function(t){this._weapons.includes(t)&&(this._currentWeapon=t,this.onWeaponChange(this._currentWeapon),this._attackTimeout.set(100),this._attackTimeout.onTimeoutExpire=null)},e.prototype.shoot=function(){var t=this;if(this.canShoot){var e=_.WEAPONS[this._currentWeapon];this._attackTimeout.set(e.frameDuration*e.shootFrameIdx),this._attackTimeout.onTimeoutExpire=function(){t._ammo-=_.WEAPONS[t._currentWeapon].ammoPerAttack,t._attackTimeout.set(e.frameDuration*(e.frameSet.length-e.shootFrameIdx)),t._attackTimeout.onTimeoutExpire=null},this.onShoot()}},e.prototype.move=function(t){var e=this;if(0!==this._horizontalSpeed||0!==this._verticalSpeed){var i={x:this._position.x,y:this._position.y},n=Math.sin(this._camera.angle)*this._verticalSpeed*TIME_SCALE,o=Math.cos(this._camera.angle)*this._verticalSpeed*TIME_SCALE,r=n+Math.sin(this._camera.angle+Math.PI/2)*this._horizontalSpeed*TIME_SCALE,a=o+Math.cos(this._camera.angle+Math.PI/2)*this._horizontalSpeed*TIME_SCALE;i.x+=r>=0?Math.min(r,_.ACTOR_SPEED*TIME_SCALE):Math.max(r,-_.ACTOR_SPEED*TIME_SCALE),i.y+=a>=0?Math.min(a,_.ACTOR_SPEED*TIME_SCALE):Math.max(a,-_.ACTOR_SPEED*TIME_SCALE);var E=function(n){if(n&&(n.hasCollision||(0,s.isItem)(n))){var o=!1,r=(0,s.isWall)(n)&&n.isInFinalPosition?n.endPositionMatrixCoordinates:n.matrixCoordinates,a={x1:r.x*_.TILE_SIZE,y1:r.y*_.TILE_SIZE,x2:r.x*_.TILE_SIZE+_.TILE_SIZE,y2:r.y*_.TILE_SIZE+_.TILE_SIZE};(0,s.isDoor)(n)&&("VERTICAL"===n.intersectionType&&(a.x1-=_.TILE_SIZE/2,a.x2+=_.TILE_SIZE/2),"HORIZONTAL"===n.intersectionType&&(a.y1-=_.TILE_SIZE/2,a.y2+=_.TILE_SIZE/2));var E=a.x1-.3*_.TILE_SIZE,c=a.y1-.3*_.TILE_SIZE,u=a.x2+.3*_.TILE_SIZE,T=a.y2+.3*_.TILE_SIZE;if(i.x>=E&&i.x<=u&&i.y>=c&&i.y<=T&&(n.hasCollision&&(e._position.x>=E&&e._position.x<=u&&(i.y=e._position.y),e._position.y>=c&&e._position.y<=T&&(i.x=e._position.x)),o=!0),o&&(0,s.isItem)(n)){var I=n.purpose;switch(I.affects){case"ammo":if(100===e._ammo)return;e._ammo+=I.value,e._ammo>100&&(e._ammo=100);break;case"health":if(e._health===e._maxHealth)return;e._health+=I.value,e._health>e._maxHealth&&(e._health=e._maxHealth);break;case"lives":e._lives+=I.value;break;case"score":e._score+=I.value;break;case"weapons":e._weapons.push(I.value)}e.onBoostPickup(),t[n.matrixCoordinates.y][n.matrixCoordinates.x]=null}}},c=this.currentMatrixPosition;E((t[c.y-1]||[])[c.x-1]),E((t[c.y-1]||[])[c.x]),E((t[c.y-1]||[])[c.x+1]),E((t[c.y]||[])[c.x-1]),E((t[c.y]||[])[c.x+1]),E((t[c.y+1]||[])[c.x-1]),E((t[c.y+1]||[])[c.x]),E((t[c.y+1]||[])[c.x+1]),this._position=i,this._camera.updatePosition(this._position)}},e.prototype.iterate=function(t){this.move(t),this._isShooting&&this.shoot(),this._attackTimeout.iterate()},e}(r.Actor);e.Wolf=E},431:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var n=i(525),o=i(571),r=i(929),_=i(592),a=i(519),s=i(4),E=function(){function t(t){this._angle=(0,r.toRadians)(180),this._resolutionScale=n.DEFAULT_RESOLUTION_SCALE,this._fov=n.DEFAULT_FOV,this._position=t.position,this._rays=[],a.canvas.addEventListener("mousemove",this.rotate.bind(this)),this.changeRaysAmount(t.raysAmount)}return Object.defineProperty(t.prototype,"resolutionScale",{get:function(){return this._resolutionScale},set:function(t){this._resolutionScale=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fov",{get:function(){return this._fov},set:function(t){this._fov=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},enumerable:!1,configurable:!0}),t.prototype.updatePosition=function(t){for(var e=0;e<this._rays.length;e++)this._rays[e].move(t);this._position=t},t.prototype.getViewAngleIntersection=function(t){var e=(0,r.getVertexByPositionAndAngle)(this._position,this._angle);return(0,r.getIntersectionVertexWithPlane)({x1:this._position.x,y1:this._position.y,x2:e.x,y2:e.y},t)},t.prototype.getIntersections=function(t,e){for(var i=this,n=[],r=function(r){var a=[],E=_._rays[r].cast(e,_._angle),c=_._rays[r].castDDA(t,_._angle),u=c.reduce((function(t,e){return(!t&&(0,s.isWall)(e.obstacle)||t&&(0,s.isWall)(e.obstacle)&&e.distance<t.distance)&&(t=e),t}),null);u&&(E=E.filter((function(t){return t.distance<u.distance}))),E.forEach((function(t){var e=t.obstacle,i=t.intersectionVertex,n=t.distance,_=(0,s.isSprite)(e)?4:(0,o.getRelativeChunkMultiplier)(n),E=Math.round(n*_)/_,c=a.reduce((function(t,e){return e.distance===E&&(t+=1),t}),0);a.push({intersectionVertex:i,obstacle:e,distance:Math.round(n*_)/_,index:r,layer:c})})),c.forEach((function(t){var e=t.obstacle,n=t.intersectionVertex,_=t.distance,E=e.position,c=(0,s.isSprite)(e)?4:(0,o.getRelativeChunkMultiplier)(_),u=n,T=Math.round(_*c)/c,I=null;if((0,s.isSprite)(e)||(0,s.isItem)(e)){I=e.rotatePerpendicularlyToView(i._angle);var l=i._rays[r].cast([I],i._angle).sort((function(t,e){return t.distance-e.distance}))[0];if(!l)return;T=Math.round(l.distance*c)/c,u=l.intersectionVertex}else(0,s.isWall)(e)&&(u.y!==E.y1&&u.x===E.x1&&(I=e.wallSides.LEFT),u.y!==E.y1&&u.x===E.x2&&(I=e.wallSides.RIGHT),u.y===E.y1&&u.x!==E.x1&&(I=e.wallSides.TOP),u.y===E.y2&&u.x!==E.x1&&(I=e.wallSides.BOTTOM));if(I){var h=a.reduce((function(t,e){return e.distance===T&&(t+=1),t}),0);a.push({obstacle:I,distance:T,index:r,intersectionVertex:u,layer:h})}})),n.push.apply(n,a)},_=this,a=0;a<this._rays.length;a++)r(a);return n},t.prototype.changeRaysAmount=function(t){this._rays=[];for(var e=Math.floor(t*this._resolutionScale),i=Math.tan(this._fov/2),n=i/(e/2),o=0;o<e;o++){var r=this._angle+Math.atan(n*o-i);r<0&&(r+=2*Math.PI),r>2*Math.PI&&(r-=2*Math.PI),this._rays.push(new _.Ray({angle:r,initialPosition:this._position}))}},t.prototype.rotate=function(t){this._angle+=(0,r.toRadians)(t.movementX/3),this._angle=this._angle%(2*Math.PI),this._angle<0&&(this._angle+=2*Math.PI);for(var e=Math.tan(this._fov/2),i=e/(10*Math.floor(this._rays.length/10)/2),n=0;n<this._rays.length;n++){var o=this._angle+Math.atan(i*n-e);o<0&&(o+=2*Math.PI),o>2*Math.PI&&(o-=2*Math.PI),this._rays[n].changeAngle(o)}},t}();e.Camera=E},592:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Ray=void 0;var n=i(525),o=i(929),r=i(4),_=function(){function t(t){this._angle=t.angle,this._position={x1:0,y1:0,x2:0,y2:0},this.move(t.initialPosition)}return Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},enumerable:!1,configurable:!0}),t.prototype.changeAngle=function(t){this._angle=t,this.move({x:this._position.x1,y:this._position.y1})},t.prototype.move=function(t){this._position={x1:t.x,y1:t.y,x2:t.x+Math.sin(this._angle)*n.RAY_LENGTH,y2:t.y+Math.cos(this._angle)*n.RAY_LENGTH}},t.prototype.castDDA=function(t,e){var i,_,a=[],s=(0,o.unitVector)({x:this._position.x2-this._position.x1,y:this._position.y2-this._position.y1}),E=this._position.x1/n.TILE_SIZE,c=this._position.y1/n.TILE_SIZE,u={x:Math.floor(this._position.x1/n.TILE_SIZE),y:Math.floor(this._position.y1/n.TILE_SIZE)},T=Math.abs(1/s.x),I=Math.abs(1/s.y),l=1,h=1;s.x<0?(l=-1,i=(E-u.x)*T):i=(u.x+1-E)*T,s.y<0?(h=-1,_=(c-u.y)*I):_=(u.y+1-c)*I;for(var S="x",O=0;O<n.RAY_LENGTH/n.TILE_SIZE;)if(i<_?(u.x+=l,O=i,i+=T,S="x"):(u.y+=h,O=_,_+=I,S="y"),u.x>=0&&u.x<64&&u.y>=0&&u.y<64&&t[u.y]&&t[u.y][u.x]){var p=t[u.y][u.x];if((0,r.isMovableEntity)(p)&&p.isMoving)continue;var L={x:E*n.TILE_SIZE+s.x*O*n.TILE_SIZE,y:c*n.TILE_SIZE+s.y*O*n.TILE_SIZE};L[S]=Math.round(L[S]);var f=(0,o.getDistanceWithoutFishEyeEffect)(O*n.TILE_SIZE,e,this._angle);if((f>n.TILE_SIZE/5||!(0,r.isSprite)(p))&&a.push({obstacle:p,distance:f,intersectionVertex:L}),(0,r.isSprite)(p)||(0,r.isDoor)(p))continue;return a}return a},t.prototype.cast=function(t,e){for(var i=[],_=0,a=t;_<a.length;_++){var s=a[_],E=(0,o.getIntersectionVertexWithPlane)(this._position,s.position);if(E){var c=(0,o.getDistanceBetweenVertexes)({x:this._position.x1,y:this._position.y1},E),u=(0,o.getDistanceWithoutFishEyeEffect)(c,e,this._angle);(u>n.TILE_SIZE/5||!(0,r.isSprite)(s))&&i.push({intersectionVertex:E,distance:u,obstacle:s})}}return i},t}();e.Ray=_},539:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Actor=void 0;var n=i(881),o=i(525),r=function(){function t(t){this._currentWeapon=t.currentWeapon,this._health=t.health,this._maxHealth=t.maxHealth,this._position=t.position,this._angle=t.angle,this._rawValue=t.rawValue,this._attackTimeout=new n.Timeout,this._isShooting=!1,this._horizontalSpeed=0,this._verticalSpeed=0}return Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentMatrixPosition",{get:function(){return{x:Math.floor(this._position.x/o.TILE_SIZE),y:Math.floor(this._position.y/o.TILE_SIZE)}},enumerable:!1,configurable:!0}),t}();e.Actor=r},485:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Enemy=void 0;var r=i(969),_=i(592),a=i(539),s=i(407),E=i(525),c=i(929),u=i(4),T=i(295),I=i(380),l=(0,c.toRadians)(45),h=l/2,S=function(t){function e(e){var i=t.call(this,e)||this;i.isEnemy=!0,i._currentState=e.initialAction,i._frameSet=e.frameSet,i._currentSide="FRONT";var n=(0,u.isNonDirectedFrameSetByAction)(i._currentState)?i._frameSet[i._currentState]:i._frameSet[i._currentState][i._currentSide];return i._animationController=new s.AnimationController({frameSet:n,isLoopAnimation:!0}),"DIE"===i._currentState&&i._animationController.setActiveFrameIdx(n.length-1),i._sprite=new r.SpriteObstacle({hasCollision:!1,position:{x1:i.currentMatrixPosition.x*E.TILE_SIZE,y1:i.currentMatrixPosition.y*E.TILE_SIZE,x2:i.currentMatrixPosition.x*E.TILE_SIZE+E.TILE_SIZE,y2:i.currentMatrixPosition.y*E.TILE_SIZE+E.TILE_SIZE},rawValue:i._rawValue,texture:i._animationController.currentFrame.data}),i}return o(e,t),Object.defineProperty(e.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),e.prototype.castToPosition=function(t,e){var i=(0,c.getDistanceBetweenVertexes)(this._position,t),n=(0,c.getAngleBetweenVertexes)(this._position,t);n<=0&&(n=2*Math.PI+n);var o=new _.Ray({initialPosition:this._position,angle:n}).castDDA(e,n).filter((function(t){return(0,u.isWall)(t.obstacle)||(0,u.isDoor)(t.obstacle)&&t.obstacle.isInStartPosition})).sort((function(t,e){return t.distance-e.distance}))[0];return{isVisible:!o||o.distance>i,distance:i,angle:n}},e.prototype.takeDamage=function(t,e,i){var n=this;if(this._health-=e,this._health<=0)this.changeState("DIE"),this._animationController.onAnimationEnd=function(){},this.dropAmmo(i);else{this.changeState("TAKING_DAMAGE");var o=this.castToPosition(t,i);this._angle=o.angle,this._animationController.onAnimationEnd=function(){n.changeState("IDLE")}}},e.prototype.dropAmmo=function(t){t[this.currentMatrixPosition.y][this.currentMatrixPosition.x]=new T.ItemObstacle({position:{x1:this.currentMatrixPosition.x*E.TILE_SIZE,y1:this.currentMatrixPosition.y*E.TILE_SIZE,x2:this.currentMatrixPosition.x*E.TILE_SIZE+E.TILE_SIZE,y2:this.currentMatrixPosition.y*E.TILE_SIZE+E.TILE_SIZE},hasCollision:!1,texture:(0,I.getImageWithSource)("src/assets/sprites/items/".concat(E.AMMO_ID,".png")),rawValue:"34_SPRITE_HOLLOW_ITEM",purpose:E.ITEMS_PURPOSES[E.AMMO_ID]})},e.prototype.changeState=function(t){this._currentState=t,(0,u.isNonDirectedFrameSetByAction)(t)?this._animationController.updateFrameSet(this._frameSet[t]):this._animationController.updateFrameSet(this._frameSet[t][this._currentSide])},e.prototype.checkForWolfInView=function(t,e){var i=this.castToPosition(t,e),n=(0,c.getRangeOfView)(this._angle,E.ENEMY_FOV,this._position);(0,c.getIsVertexInTheTriangle)(t,n)&&(i.distance>E.ENEMY_VIEW_DISTANCE||i.isVisible&&(this._angle=i.angle))},e.prototype.updateSprite=function(t,e){if((0,u.isDirectedFrameSetByAction)(this._currentState)){var i=(0,c.getAngleBetweenVertexes)(this._position,t)-this._angle,n=this._currentSide;if(i<=0&&(i=2*Math.PI+i),i<=h||i>h+7*l?n="FRONT":i<h+l?n="FRONT_LEFT":i<h+2*l?n="LEFT":i<h+3*l?n="BACK_RIGHT":i<h+4*l?n="BACK":i<h+5*l?n="BACK_LEFT":i<h+6*l?n="RIGHT":i<h+7*l&&(n="FRONT_RIGHT"),n!==this._currentSide){this._currentSide=n;var o=this._animationController.currentFrameIdx;this._animationController.updateFrameSet(this._frameSet[this._currentState][this._currentSide]),this._animationController.setActiveFrameIdx(o)}}this._sprite.texture=this._animationController.currentFrame.data,this._sprite.position={x1:this.currentMatrixPosition.x*E.TILE_SIZE,y1:this.currentMatrixPosition.y*E.TILE_SIZE,x2:this.currentMatrixPosition.x*E.TILE_SIZE+E.TILE_SIZE,y2:this.currentMatrixPosition.y*E.TILE_SIZE+E.TILE_SIZE},this._sprite.rotatePerpendicularlyToView(e)},e.prototype.getPreparedSprite=function(){return this._sprite},e.prototype.iterate=function(t,e,i){this.updateSprite(t,e),"DIE"!==this._currentState&&this.checkForWolfInView(t,i),this._attackTimeout.iterate(),this._animationController.iterate()},e}(a.Actor);e.Enemy=S},548:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Guard=void 0;var _=i(485),a=i(11),s=function(t){function e(e){return t.call(this,r(r({},e),{currentWeapon:"PISTOL",health:100,maxHealth:100,frameSet:(0,a.getEnemyFrameSet)("guard")}))||this}return o(e,t),e}(_.Enemy);e.Guard=s},460:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.DoorObstacle=void 0;var r=i(525),_=function(t){function e(e){var i=t.call(this,e)||this;return i._textureDark=e.textureDark,i.isVertical=e.isVertical,i.isDoor=!0,i.closeTimeout=e.closeTimeout,i.shouldReverseTexture=!e.isVertical,i.intersectionType=e.isVertical?r.INTERSECTION_TYPES.VERTICAL:r.INTERSECTION_TYPES.HORIZONTAL,i}return o(e,t),Object.defineProperty(e.prototype,"textureDark",{get:function(){return this._textureDark},enumerable:!1,configurable:!0}),e}(i(310).MovableEntity);e.DoorObstacle=_},295:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.ItemObstacle=void 0;var r=function(t){function e(e){var i=t.call(this,e)||this;return i.isItem=!0,i.purpose=e.purpose,i}return o(e,t),e}(i(969).SpriteObstacle);e.ItemObstacle=r},969:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteObstacle=void 0;var r=i(525),_=function(t){function e(e){var i=t.call(this,e)||this;return i.isSprite=!0,i}return o(e,t),e.prototype.rotatePerpendicularlyToView=function(t){var e=this._position.x1,i=this._position.y1,n=(this._position.x2+e)/2,o=(this._position.y2+i)/2,_=-t;return this.position={x1:n+r.TILE_SIZE/2*Math.cos(_),y1:o+r.TILE_SIZE/2*Math.sin(_),x2:n-r.TILE_SIZE/2*Math.cos(_),y2:o-r.TILE_SIZE/2*Math.sin(_)},this},e}(i(361).Entity);e.SpriteObstacle=_},38:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.WallObstacle=void 0;var _=i(525),a=i(380),s=function(t){function e(e){var i=t.call(this,e)||this;return i.isWall=!0,i._textureDark=e.textureDark,i.intersectionType=_.INTERSECTION_TYPES.HORIZONTAL,i.shouldReverseTexture=!1,i._neighborIsDoorMap=e.neighborIsDoorMap,i._wallSides={TOP:i.getWallBySide(_.OBSTACLE_SIDES.TOP,i._neighborIsDoorMap.TOP),RIGHT:i.getWallBySide(_.OBSTACLE_SIDES.RIGHT,i._neighborIsDoorMap.RIGHT),BOTTOM:i.getWallBySide(_.OBSTACLE_SIDES.BOTTOM,i._neighborIsDoorMap.BOTTOM),LEFT:i.getWallBySide(_.OBSTACLE_SIDES.LEFT,i._neighborIsDoorMap.LEFT)},i}return o(e,t),Object.defineProperty(e.prototype,"wallSides",{get:function(){return this._wallSides},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textureDark",{get:function(){return this._textureDark},set:function(t){this._textureDark=t},enumerable:!1,configurable:!0}),e.prototype.iterateMovement=function(){var e=t.prototype.iterateMovement.call(this);return this._wallSides={TOP:this.getWallBySide(_.OBSTACLE_SIDES.TOP,this._neighborIsDoorMap.TOP),RIGHT:this.getWallBySide(_.OBSTACLE_SIDES.RIGHT,this._neighborIsDoorMap.RIGHT),BOTTOM:this.getWallBySide(_.OBSTACLE_SIDES.BOTTOM,this._neighborIsDoorMap.BOTTOM),LEFT:this.getWallBySide(_.OBSTACLE_SIDES.LEFT,this._neighborIsDoorMap.LEFT)},e},e.prototype.getWallBySide=function(t,e){var i=t===_.OBSTACLE_SIDES.TOP||t===_.OBSTACLE_SIDES.BOTTOM,n={x1:this.position.x1+(t===_.OBSTACLE_SIDES.RIGHT?_.TILE_SIZE:0),y1:this.position.y1+(t===_.OBSTACLE_SIDES.BOTTOM?_.TILE_SIZE:0),x2:this.position.x2-(t===_.OBSTACLE_SIDES.LEFT?_.TILE_SIZE:0),y2:this.position.y2-(t===_.OBSTACLE_SIDES.TOP?_.TILE_SIZE:0)},o=this._texture,s=this._textureDark;return e&&(o=(0,a.getImageWithSource)("src/assets/textures/".concat(_.DOOR_SIDE_WALL_TEXTURE_ID,".png")),s=(0,a.getImageWithSource)("src/assets/textures/".concat(_.DOOR_SIDE_WALL_TEXTURE_DARK_ID,".png"))),r(r({},this),{position:n,intersectionType:i?_.INTERSECTION_TYPES.VERTICAL:_.INTERSECTION_TYPES.HORIZONTAL,shouldReverseTexture:!e&&(t===_.OBSTACLE_SIDES.LEFT||t===_.OBSTACLE_SIDES.BOTTOM),texture:o,textureDark:s})},e}(i(310).MovableEntity);e.WallObstacle=s},361:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Entity=void 0;var n=i(525),o=function(){function t(t){this._position=t.position,this._texture=t.texture,this._matrixCoordinates={x:Math.floor(this._position.x1/n.TILE_SIZE),y:Math.floor(this._position.y1/n.TILE_SIZE)},this.hasCollision=t.hasCollision,this.rawValue=t.rawValue}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this._matrixCoordinates={x:Math.floor(this._position.x1/n.TILE_SIZE),y:Math.floor(this._position.y1/n.TILE_SIZE)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"matrixCoordinates",{get:function(){return this._matrixCoordinates},enumerable:!1,configurable:!0}),t}();e.Entity=o},310:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.MovableEntity=void 0;var r=i(525),_=function(t){function e(e){var i=t.call(this,e)||this;return i._initialPosition=e.initialPosition,i._endPosition=e.endPosition,i._isMoving=e.isMoving,i._isInFinalPosition=e.isInFinalPosition,i._isInStartPosition=e.isInStartPosition,i._endPositionMatrixCoordinates={x:Math.floor(i._endPosition.x1/r.TILE_SIZE),y:Math.floor(i._endPosition.y1/r.TILE_SIZE)},i.isMovable=e.isMovable,i}return o(e,t),Object.defineProperty(e.prototype,"endPositionMatrixCoordinates",{get:function(){return this._endPositionMatrixCoordinates},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initialPosition",{get:function(){return this._initialPosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endPosition",{get:function(){return this._endPosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMoving",{get:function(){return this._isMoving},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInFinalPosition",{get:function(){return this._isInFinalPosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInStartPosition",{get:function(){return this._isInStartPosition},enumerable:!1,configurable:!0}),e.prototype.getPositionChange=function(t,e){return t>e?-r.OBSTACLES_MOVE_SPEED:t<e?r.OBSTACLES_MOVE_SPEED:0},e.prototype.iterateMovement=function(){if(this.isMovable){this._isMoving=!0;var t=this._isInStartPosition?this._endPosition:this._initialPosition;return this._position={x1:this._position.x1+this.getPositionChange(this._position.x1,t.x1)*TIME_SCALE,y1:this._position.y1+this.getPositionChange(this._position.y1,t.y1)*TIME_SCALE,x2:this._position.x2+this.getPositionChange(this._position.x2,t.x2)*TIME_SCALE,y2:this._position.y2+this.getPositionChange(this._position.y2,t.y2)*TIME_SCALE},Math.round(this._position.x1*r.TILE_SIZE)/r.TILE_SIZE===t.x1&&Math.round(this._position.y1*r.TILE_SIZE)/r.TILE_SIZE===t.y1&&Math.round(this._position.x2*r.TILE_SIZE)/r.TILE_SIZE===t.x2&&Math.round(this._position.y2*r.TILE_SIZE)/r.TILE_SIZE===t.y2&&(this._position=t,this._isMoving=!1,this._isInStartPosition=!this._isInStartPosition,this._isInFinalPosition=!this._isInFinalPosition,!0)}},e}(i(361).Entity);e.MovableEntity=_},407:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationController=void 0;var n=i(881),o=function(){function t(t){var e=t.frameSet,i=t.initialFrameIdx,o=void 0===i?0:i,r=t.isLoopAnimation,_=void 0!==r&&r,a=t.renderFunction,s=void 0===a?function(){}:a,E=t.onAnimationEnd,c=void 0===E?function(){}:E,u=t.onAnimationStart,T=void 0===u?function(){}:u,I=t.onFrameChange,l=void 0===I?function(){}:I;this._frameSet=e,this._currentFrameIdx=o,this._derivedRenderFunction=s,this._isLoopAnimation=_,this._onAnimationEnd=c,this._onAnimationStart=T,this._onFrameChange=l,this.playAnimation=this.playAnimation.bind(this),this._timeout=new n.Timeout(this.playAnimation),_&&this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)}return Object.defineProperty(t.prototype,"onAnimationEnd",{set:function(t){this._onAnimationEnd=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onAnimationStart",{set:function(t){this._onAnimationStart=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFrameChange",{set:function(t){this._onFrameChange=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrameIdx",{get:function(){return this._currentFrameIdx},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrame",{get:function(){return this._frameSet[this._currentFrameIdx]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCurrentlyInTimeout",{get:function(){return!this._timeout.isExpired},enumerable:!1,configurable:!0}),t.prototype.playAnimation=function(){this._currentFrameIdx===this._frameSet.length-1?(this._timeout.reset(),this._currentFrameIdx=0,this._onAnimationEnd(),this._isLoopAnimation&&this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)):(0===this._currentFrameIdx&&this._onAnimationStart(),this._currentFrameIdx+=1,this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)),this._onFrameChange(this._currentFrameIdx)},t.prototype.updateFrameSet=function(t){this._frameSet=t,this._currentFrameIdx=0,this._timeout.reset(),this._isLoopAnimation&&this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)},t.prototype.setActiveFrameIdx=function(t){if(t>this._frameSet.length-1)throw Error("Frame ".concat(t," is out of bounds"));this._currentFrameIdx=t,this._timeout.reset(),this._isLoopAnimation&&this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)},t.prototype.iterate=function(){this._timeout.iterate()},t.prototype.render=function(){this._derivedRenderFunction(this._frameSet[this._currentFrameIdx].data)},t}();e.AnimationController=o},881:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Timeout=void 0;var i=function(){function t(t){void 0===t&&(t=null),this._timeoutTime=null,this._onTimeoutExpire=t}return Object.defineProperty(t.prototype,"onTimeoutExpire",{set:function(t){this._onTimeoutExpire=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpired",{get:function(){return!this._timeoutTime},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._timeoutTime=null},t.prototype.set=function(t){this._timeoutTime=(new Date).getTime()+t},t.prototype.iterate=function(){this._timeoutTime&&(new Date).getTime()>this._timeoutTime&&(this._timeoutTime=null,this._onTimeoutExpire&&this._onTimeoutExpire())},t}();e.Timeout=i},82:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Hud=void 0;var n=i(407),o=i(525),r=i(798),_=i(11),a=function(){function t(t){this._ctx=t.ctx,this._screenData=t.screenData,this._currentFrameSet=r.ACTOR_PORTRAIT_FRAME_SETS.HEALTHY,this._scale=this._screenData.width*o.HUD_WIDTH_COEFFICIENT/r.HUD_PANEL.WIDTH,this._width=Math.round(this._screenData.width*o.HUD_WIDTH_COEFFICIENT),this._height=Math.round(r.HUD_PANEL.HEIGHT*this._scale),this._offsetX=this._screenData.width/2-this._width/2,this._offsetY=this._screenData.height-this._height,this.onWeaponChange=this.onWeaponChange.bind(this),this.onBoostPickup=this.onBoostPickup.bind(this),this.onShoot=this.onShoot.bind(this),this.renderPortrait=this.renderPortrait.bind(this),this.renderWeapon=this.renderWeapon.bind(this),this.renderPostEffect=this.renderPostEffect.bind(this),this._portraitAnimation=new n.AnimationController({renderFunction:this.renderPortrait,frameSet:this._currentFrameSet,initialFrameIdx:0,isLoopAnimation:!0}),this._weaponAnimationController=new n.AnimationController({renderFunction:this.renderWeapon,initialFrameIdx:0,isLoopAnimation:!1,frameSet:o.WEAPONS[t.initialWeapon].frameSet}),this._postEffectAnimationController=new n.AnimationController({renderFunction:this.renderPostEffect,initialFrameIdx:0,isLoopAnimation:!1,frameSet:(0,_.generatePostEffectFrameSet)([255,255,0])})}return t.prototype.getHealthFrameSet=function(t){return t>85?r.ACTOR_PORTRAIT_FRAME_SETS.HEALTHY:t>75?r.ACTOR_PORTRAIT_FRAME_SETS.JUST_A_SCRATCH:t>50?r.ACTOR_PORTRAIT_FRAME_SETS.MINOR_DAMAGE:t>35?r.ACTOR_PORTRAIT_FRAME_SETS.MODERATE_DAMAGE:t>20?r.ACTOR_PORTRAIT_FRAME_SETS.SEVERE_DAMAGE:t>5?r.ACTOR_PORTRAIT_FRAME_SETS.SUFFERING:t>0?r.ACTOR_PORTRAIT_FRAME_SETS.NEAR_DEATH:r.ACTOR_PORTRAIT_FRAME_SETS.DEAD},t.prototype.renderPostEffect=function(t){this._ctx.fillStyle=t.color,this._ctx.fillRect(0,0,this._screenData.width,this._screenData.height)},t.prototype.renderWeapon=function(t){var e=this._screenData.width*o.HUD_WIDTH_COEFFICIENT/r.HUD_PANEL.WIDTH*r.HUD_PANEL.HEIGHT,i=this._screenData.height-e,n=this._screenData.width/2-i/2,_=this._screenData.height-i-e;this._ctx.drawImage(t,0,0,o.TEXTURE_SIZE,o.TEXTURE_SIZE,n,_,i,i)},t.prototype.renderPortrait=function(t){var e=this._offsetX+Math.round(r.HUD_PANEL.PORTRAIT_X_OFFSET*this._scale),i=this._offsetY+Math.round(r.HUD_PANEL.PORTRAIT_Y_OFFSET*this._scale);this._ctx.drawImage(t,0,0,r.PORTRAIT_WIDTH,r.PORTRAIT_HEIGHT,e,i,Math.round(r.PORTRAIT_WIDTH*this._scale),Math.round(r.PORTRAIT_HEIGHT*this._scale))},t.prototype.renderText=function(t,e){for(var i=String(t),n=Math.ceil(i.length*r.FONT_SYMBOL_WIDTH*this._scale),o=0;o<i.length;o++){var _=Number(i[o])*r.FONT_SYMBOL_WIDTH,a=o*r.FONT_SYMBOL_WIDTH,s=this._offsetX+e+Math.ceil(a*this._scale)-n/2,E=this._offsetY+Math.ceil(r.HUD_PANEL.INFO_Y_OFFSET*this._scale);this._ctx.drawImage(r.FONT_IMAGE,_,0,r.FONT_SYMBOL_WIDTH,r.FONT_SYMBOL_HEIGHT,s,E,Math.ceil(r.FONT_SYMBOL_WIDTH*this._scale),Math.ceil(r.FONT_SYMBOL_HEIGHT*this._scale))}},t.prototype.onWeaponChange=function(t){this._weaponAnimationController.updateFrameSet(o.WEAPONS[t].frameSet)},t.prototype.onBoostPickup=function(){this._postEffectAnimationController.updateFrameSet((0,_.generatePostEffectFrameSet)([255,255,0])),this._postEffectAnimationController.playAnimation()},t.prototype.onShoot=function(){this._weaponAnimationController.setActiveFrameIdx(0),this._weaponAnimationController.playAnimation()},t.prototype.iterate=function(){this._weaponAnimationController.iterate(),this._postEffectAnimationController.iterate(),this._portraitAnimation.iterate()},t.prototype.render=function(t){var e=t.ammo,i=t.lives,n=t.score,_=t.health,a=t.currentWeapon,s=t.level,E=this.getHealthFrameSet(_);E!==this._currentFrameSet&&(this._currentFrameSet=E,this._portraitAnimation.updateFrameSet(this._currentFrameSet)),this._scale=this._screenData.width*o.HUD_WIDTH_COEFFICIENT/r.HUD_PANEL.WIDTH,this._width=Math.round(this._screenData.width*o.HUD_WIDTH_COEFFICIENT),this._height=Math.round(r.HUD_PANEL.HEIGHT*this._scale),this._offsetX=this._screenData.width/2-this._width/2,this._offsetY=this._screenData.height-this._height,this._ctx.drawImage(r.HUD_PANEL.TEXTURE,0,0,r.HUD_PANEL.WIDTH,r.HUD_PANEL.HEIGHT,this._offsetX,this._offsetY,this._width,this._height),this._ctx.drawImage(o.WEAPONS[a].icon,0,0,r.WEAPON_ICON_WIDTH,r.WEAPON_ICON_HEIGHT,this._offsetX+Math.round(r.HUD_PANEL.WEAPON_X_OFFSET*this._scale),this._offsetY+Math.round(r.HUD_PANEL.WEAPON_Y_OFFSET*this._scale),Math.round(r.WEAPON_ICON_WIDTH*this._scale),Math.round(r.WEAPON_ICON_HEIGHT*this._scale)),this.renderText(s,r.HUD_PANEL.LEVEL_X_OFFSET*this._scale),this.renderText(n,r.HUD_PANEL.SCORE_X_OFFSET*this._scale),this.renderText(i,r.HUD_PANEL.LIVES_X_OFFSET*this._scale),this.renderText(_,r.HUD_PANEL.HEALTH_X_OFFSET*this._scale),this.renderText(e,r.HUD_PANEL.AMMO_X_OFFSET*this._scale),this._weaponAnimationController.render(),this._postEffectAnimationController.render(),this._portraitAnimation.render()},t}();e.Hud=a},425:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Minimap=void 0;var n=i(525),o=i(4),r=function(){function t(t){this._ctx=t.ctx,this._obstacles=t.obstacles,this._rowsLength=t.rowsLength}return t.prototype.render=function(t,e){for(var i=this._rowsLength*n.TILE_SIZE,r=0,_=this._obstacles;r<_.length;r++){var a=_[r];(0,o.isWall)(a)&&a.isMovable?this._ctx.fillStyle="orange":this._ctx.fillStyle="white",(0,o.isWall)(a)&&this._ctx.fillRect(a.initialPosition.x1*n.MAP_SCALE,(i-a.initialPosition.y1-n.TILE_SIZE)*n.MAP_SCALE,n.TILE_SIZE*n.MAP_SCALE,n.TILE_SIZE*n.MAP_SCALE)}for(var s=0,E=e;s<E.length;s++){var c=E[s];this._ctx.fillStyle="red";var u={x:c.position.x+n.TILE_SIZE/n.MAP_SCALE*Math.sin(c.angle),y:c.position.y+n.TILE_SIZE/n.MAP_SCALE*Math.cos(c.angle)};this._ctx.strokeStyle="orange",this._ctx.beginPath(),this._ctx.moveTo(c.position.x*n.MAP_SCALE,(i-c.position.y)*n.MAP_SCALE),this._ctx.lineTo(u.x*n.MAP_SCALE,(i-u.y)*n.MAP_SCALE),this._ctx.closePath(),this._ctx.stroke(),this._ctx.beginPath(),this._ctx.ellipse(c.position.x*n.MAP_SCALE,(i-c.position.y)*n.MAP_SCALE,.8*n.TILE_SIZE*n.MAP_SCALE,.8*n.TILE_SIZE*n.MAP_SCALE,0,0,360),this._ctx.closePath(),this._ctx.fill()}this._ctx.fillStyle="blue",this._ctx.beginPath(),this._ctx.ellipse(t.x*n.MAP_SCALE,(i-t.y)*n.MAP_SCALE,.8*n.TILE_SIZE*n.MAP_SCALE,.8*n.TILE_SIZE*n.MAP_SCALE,0,0,360),this._ctx.closePath(),this._ctx.fill()},t}();e.Minimap=r},4:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isDirectedFrameSetByAction=e.isNonDirectedFrameSetByAction=e.isMovableEntity=e.isEnemy=e.isDoor=e.isWall=e.isItem=e.isSprite=void 0;var n=i(11);e.isSprite=function(t){return!!t&&!!t.isSprite},e.isItem=function(t){return!!t&&!!t.isItem},e.isWall=function(t){return!!t&&!!t.isWall},e.isDoor=function(t){return!!t&&!!t.isDoor},e.isEnemy=function(t){return!!t&&!!t.isEnemy},e.isMovableEntity=function(t){return(0,e.isDoor)(t)||(0,e.isWall)(t)},e.isNonDirectedFrameSetByAction=function(t){return n.NON_DIRECTED_FRAME_SETS_BY_ACTION.includes(t)},e.isDirectedFrameSetByAction=function(t){return n.DIRECTED_FRAME_SETS_BY_ACTION.includes(t)}},380:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getImageWithSource=void 0;var i={};e.getImageWithSource=function(t){if(i[t])return i[t];var e=new Image;return e.src=t,i[t]=e,e}},559:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseMap=void 0;var n=i(460),o=i(295),r=i(969),_=i(38),a=i(548),s=i(525),E=i(929),c=i(380);e.parseMap=function(t){for(var e,i,u,T,I=[],l=[],h=[],S=[],O={x:0,y:0},p={},L=0;L<t.length;L++){I.push([]);for(var f=0;f<t[L].length;f++)if((P=t[L][f])&&"string"==typeof P){var d=P.split("_");"END"===d[2]&&(p[d[1]]={x1:f*s.TILE_SIZE,y1:L*s.TILE_SIZE,x2:f*s.TILE_SIZE+s.TILE_SIZE,y2:L*s.TILE_SIZE+s.TILE_SIZE})}}for(L=0;L<t.length;L++)for(f=0;f<t[L].length;f++){var P;if(P=t[L][f]){if(P){if("START_POS"===P){O={x:f*s.TILE_SIZE+s.TILE_SIZE/2,y:L*s.TILE_SIZE+s.TILE_SIZE/2},I[L].push(null);continue}var R="number"==typeof P?[]:P.split("_"),y="number"!=typeof P?Number(R[0]):P;if(R&&R.includes("END")){I[L].push(null);continue}var A=f%63==0||L%63==0,M=R.includes("ENEMY"),m=R.includes("ITEM"),g=R.includes("SPRITE")||!1,D=!g&&R.includes("START"),x=!g&&s.DOOR_IDS.includes(y),v=!g&&(x||D)&&!A,W=!(M||m||g||x),H=!R.includes("HOLLOW"),b=null;m&&(b=s.ITEMS_PURPOSES[y]);var C=!(!t[L][f-1]||!t[L][f+1]),F={x1:f*s.TILE_SIZE+(!C&&x?.5*s.TILE_SIZE:0),y1:L*s.TILE_SIZE+(C&&x?.5*s.TILE_SIZE:0),x2:f*s.TILE_SIZE+(!C&&x?.5*s.TILE_SIZE:s.TILE_SIZE),y2:L*s.TILE_SIZE+(C&&x?.5*s.TILE_SIZE:s.TILE_SIZE)},N=D&&R?p[R[1]]:{x1:C?F.x1+s.TILE_SIZE:F.x1,y1:C?F.y1:F.y1-s.TILE_SIZE,x2:C?F.x2+s.TILE_SIZE:F.x2,y2:C?F.y2:F.y2-s.TILE_SIZE};if(M){var w=R[1].toLowerCase(),U=R[2],G=R[3];if("guard"===w){var Z=new a.Guard({rawValue:P,initialAction:U,angle:(0,E.toRadians)(s.ENEMY_FACING_DIRECTION_MAP[G]),position:{x:(F.x1+F.x2)/2,y:(F.y1+F.y2)/2}});S.push(Z),I[L].push(null)}}else if(W){var B=new _.WallObstacle({neighborIsDoorMap:{TOP:!!(null===(e=t[L-1])||void 0===e?void 0:e[f])&&s.DOOR_IDS.includes(t[L-1][f]),RIGHT:!!(null===(i=t[L])||void 0===i?void 0:i[f+1])&&s.DOOR_IDS.includes(t[L][f+1]),BOTTOM:!!(null===(u=t[L+1])||void 0===u?void 0:u[f])&&s.DOOR_IDS.includes(t[L+1][f]),LEFT:!!(null===(T=t[L])||void 0===T?void 0:T[f-1])&&s.DOOR_IDS.includes(t[L][f-1])},initialPosition:F,position:F,endPosition:N,isInFinalPosition:!1,isInStartPosition:!0,isMovable:v,isMoving:!1,hasCollision:H,texture:(0,c.getImageWithSource)("src/assets/textures/".concat(y,".png")),textureDark:(0,c.getImageWithSource)("src/assets/textures/".concat(y+1,".png")),rawValue:P});I[L].push(B),l.push(B)}else if(g&&!m){var V=new r.SpriteObstacle({position:F,hasCollision:H,texture:(0,c.getImageWithSource)("src/assets/sprites/".concat(H?"static":"hollow","/").concat(y,".png")),rawValue:P});I[L].push(V),l.push(V)}else if(m){var Y=new o.ItemObstacle({position:F,hasCollision:H,texture:(0,c.getImageWithSource)("src/assets/sprites/items/".concat(y,".png")),rawValue:P,purpose:b});I[L].push(Y),l.push(Y)}else if(x){var j=new n.DoorObstacle({initialPosition:F,position:F,endPosition:N,isInFinalPosition:!1,isInStartPosition:!0,isMovable:v,isMoving:!1,isVertical:C,hasCollision:H,texture:(0,c.getImageWithSource)("src/assets/textures/".concat(y,".png")),textureDark:(0,c.getImageWithSource)("src/assets/textures/".concat(y+1,".png")),rawValue:P,closeTimeout:null});I[L].push(j),l.push(j),h.push(j)}}}else I[L].push(null)}return{map:I,obstacles:l,startPosition:O,doors:h,enemies:S}}}},e={};!function i(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}(519)})();