(()=>{var t={9:function(t,e,i){var n={"./E1M3.json":["296","705"],"./testMap.json":["405","567"]};function r(t){if(!i.o(n,t))return Promise.resolve().then(function(){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e});var e=n[t],r=e[0];return i.e(e[1]).then(function(){return i.t(r,19)})}r.keys=function(){return Object.keys(n)},r.id="9",t.exports=r},995:function(t,e,i){"use strict";i.d(e,{$8:function(){return C},B_:function(){return y},Fp:function(){return k},I_:function(){return f},J5:function(){return D},Ji:function(){return g},MP:function(){return _},Md:function(){return d},To:function(){return v},U2:function(){return T},Ug:function(){return P},W_:function(){return E},YK:function(){return b},am:function(){return B},ch:function(){return G},d$:function(){return A},ek:function(){return x},f6:function(){return M},ip:function(){return R},lN:function(){return S},m5:function(){return m},nd:function(){return F},pk:function(){return p},t6:function(){return w},wF:function(){return I},xY:function(){return z},zL:function(){return O},zd:function(){return j}});var n,r,o,a,s,u=i(647),c=i(969),l=i(41);function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var f=10,_=window.devicePixelRatio,d=f/2,p=48*f,y=[27,28,33,34,35,36],v=34,m=30,g=29,b=64,x=1e3/60,w=[.5,1],O=4e3,P=.6,M=.6,S=f/(4*f),I=1,T=(0,l.Yr)(120),E=(0,l.Yr)(15),k=90,A=(0,l.Yr)(k),D=.5;window.TIME_SCALE=1;var C={KNIFE:{frameSet:(0,u.Re)("KNIFE",50),maxDistance:2*f,minDamage:50,maxDamage:50,frameDuration:50,ammoPerAttack:0,attackFrameIdx:2,noiseDistance:0,icon:(0,c.D)("src/static/assets/hud/knife.png")},PISTOL:{frameSet:(0,u.Re)("PISTOL",65),maxDistance:20*f,minDamage:25,maxDamage:100,frameDuration:65,ammoPerAttack:1,attackFrameIdx:2,noiseDistance:6*f,icon:(0,c.D)("src/static/assets/hud/pistol.png")},MACHINE_GUN:{frameSet:(0,u.Re)("MACHINE_GUN",30),maxDistance:20*f,minDamage:20,maxDamage:55,frameDuration:30,ammoPerAttack:1,attackFrameIdx:2,noiseDistance:10*f,icon:(0,c.D)("src/static/assets/hud/machine_gun.png")}},F={34:{affects:"ammo",value:8},35:{affects:"health",value:10},39:{affects:"health",value:25},36:{affects:"score",value:100},37:{affects:"score",value:1},38:{affects:"score",value:500},42:{affects:"score",value:1e3},40:{affects:"weapons",value:"MACHINE_GUN"},41:{affects:"weapons",value:"MACHINE_GUN"}},R={VERTICAL:"VERTICAL",HORIZONTAL:"HORIZONTAL"},j={TOP:"TOP",BOTTOM:"BOTTOM",LEFT:"LEFT",RIGHT:"RIGHT"},L="TOP_LEFT",H="TOP_RIGHT",W="BOTTOM_LEFT",N="BOTTOM_RIGHT",V=(h(o={},j.TOP,{x:0,y:-1}),h(o,j.BOTTOM,{x:0,y:1}),h(o,j.LEFT,{x:-1,y:0}),h(o,j.RIGHT,{x:1,y:0}),o);var G=(n=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){h(t,e,i[e])})}return t}({},V),r=null!=(r=(h(a={},L,{x:-1,y:-1}),h(a,H,{x:1,y:-1}),h(a,W,{x:-1,y:1}),h(a,N,{x:1,y:1}),a))?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):(function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i.push.apply(i,n)}return i})(Object(r)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))}),n),z=(h(s={},L,[V.BOTTOM,V.RIGHT]),h(s,H,[V.BOTTOM,V.LEFT]),h(s,W,[V.TOP,V.RIGHT]),h(s,N,[V.TOP,V.LEFT]),s),B={WEST:0,NORTH:90,EAST:180,SOUTH:-90}},235:function(t,e,i){"use strict";i.d(e,{Dz:function(){return u},KR:function(){return f},fq:function(){return h},gs:function(){return s},oT:function(){return a},tl:function(){return o},uh:function(){return c},vp:function(){return l},yz:function(){return _}});var n=i(647),r=i(969),o={TEXTURE:(0,r.D)("src/static/assets/hud/panel.png"),WIDTH:400,HEIGHT:40,INFO_Y_OFFSET:16,WEAPON_Y_OFFSET:8,LEVEL_X_OFFSET:65,SCORE_X_OFFSET:111,LIVES_X_OFFSET:156,HEALTH_X_OFFSET:219,AMMO_X_OFFSET:262,WEAPON_X_OFFSET:296,PORTRAIT_X_OFFSET:174,PORTRAIT_Y_OFFSET:5},a=(0,r.D)("src/static/assets/hud/font.png"),s=8,u=16,c=48,l=24,h=30,f=31,_={HEALTHY:(0,n.ym)("HEALTHY"),JUST_A_SCRATCH:(0,n.ym)("JUST_A_SCRATCH"),MINOR_DAMAGE:(0,n.ym)("MINOR_DAMAGE"),MODERATE_DAMAGE:(0,n.ym)("MODERATE_DAMAGE"),SEVERE_DAMAGE:(0,n.ym)("SEVERE_DAMAGE"),SUFFERING:(0,n.ym)("SUFFERING"),NEAR_DEATH:(0,n.ym)("NEAR_DEATH"),DEAD:[{data:(0,r.D)("src/static/assets/hud/portrait/dead/frame_0.png"),duration:1e4}]}},705:function(t,e,i){"use strict";i.d(e,{f:function(){return a}});var n=i(226);function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var a=function(){var t,e,i;function a(t){var e=t.emitter,i=t.frameSet,r=t.initialFrameIdx,s=t.isLoopAnimation,u=void 0!==s&&s,c=t.renderFunction,l=t.onAnimationEnd,h=t.onAnimationStart,f=t.onFrameChange;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),o(this,"_frameSet",void 0),o(this,"_currentFrameIdx",void 0),o(this,"_isLoopAnimation",void 0),o(this,"_derivedRenderFunction",void 0),o(this,"_onAnimationEnd",void 0),o(this,"_onAnimationStart",void 0),o(this,"_onFrameChange",void 0),o(this,"_timeout",void 0),this._frameSet=i,this._currentFrameIdx=void 0===r?0:r,this._derivedRenderFunction=void 0===c?function(){}:c,this._isLoopAnimation=u,this._onAnimationEnd=void 0===l?function(){}:l,this._onAnimationStart=void 0===h?function(){}:h,this._onFrameChange=void 0===f?function(){}:f,this._timeout=new n.V(e,this.playAnimation.bind(this)),u&&this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)}return t=a,e=[{key:"onAnimationEnd",set:function(t){this._onAnimationEnd=t}},{key:"onAnimationStart",set:function(t){this._onAnimationStart=t}},{key:"onFrameChange",set:function(t){this._onFrameChange=t}},{key:"currentFrameIdx",get:function(){return this._currentFrameIdx}},{key:"currentFrame",get:function(){return this._frameSet[this._currentFrameIdx]}},{key:"isCurrentlyInTimeout",get:function(){return!this._timeout.isExpired}},{key:"playAnimation",value:function(){this._currentFrameIdx===this._frameSet.length-1?(this._timeout.reset(),this._currentFrameIdx=0,this._onAnimationEnd(),this._isLoopAnimation&&this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)):(0===this._currentFrameIdx&&this._onAnimationStart(),this._currentFrameIdx+=1,this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)),this._onFrameChange(this._currentFrameIdx)}},{key:"updateFrameSet",value:function(t){this._frameSet=t,this._currentFrameIdx=0,this._timeout.reset(),this._isLoopAnimation&&this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)}},{key:"setActiveFrameIdx",value:function(t){if(t>this._frameSet.length-1)throw Error("Frame ".concat(t," is out of bounds"));this._currentFrameIdx=t,this._timeout.reset(),this._isLoopAnimation&&this.currentFrame.duration!==1/0&&this._timeout.set(this.currentFrame.duration)}},{key:"render",value:function(){this._derivedRenderFunction(this._frameSet[this._currentFrameIdx].data)}}],r(t.prototype,e),a}()},226:function(t,e,i){"use strict";i.d(e,{V:function(){return o}});function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var o=function(){var t,e,i;function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,o),r(this,"_timeoutTime",void 0),r(this,"_onTimeoutExpire",void 0),r(this,"_emitter",void 0),this._timeoutTime=null,this._onTimeoutExpire=e,this._emitter=t,this.registerEvents()}return t=o,e=[{key:"registerEvents",value:function(){this._emitter.on("frameUpdate",this.update.bind(this))}},{key:"update",value:function(){this._timeoutTime&&new Date().getTime()>this._timeoutTime&&(this._timeoutTime=null,this._onTimeoutExpire&&this._onTimeoutExpire())}},{key:"onTimeoutExpire",set:function(t){this._onTimeoutExpire=t}},{key:"isExpired",get:function(){return!this._timeoutTime}},{key:"reset",value:function(){this._timeoutTime=null}},{key:"set",value:function(t){this._timeoutTime=new Date().getTime()+t}}],n(t.prototype,e),o}()},135:function(t,e,i){"use strict";i.d(e,{_:function(){return d}});var n=i(171),r=i(186),o=i(226),a=i(995),s=i(969),u=i(922),c=i(221);function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var d=function(){var t,e,i;function l(t,e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,l),f(this,"_emitter",void 0),f(this,"_map",void 0),f(this,"_navigationMap",void 0),f(this,"_enemies",void 0),f(this,"_obstacles",void 0),f(this,"_doors",void 0),f(this,"_currentlyMovingObstacles",void 0),f(this,"_wolfMatrixPosition",void 0),f(this,"startPosition",void 0),this._emitter=t;var i=n.P.parseMap(t,e),o=i.obstacles,s=i.doors,u=i.enemies,c=i.map,h=i.startPosition;this._map=c,this._navigationMap=new r.Z(this._map),this._obstacles=o,this._doors=s,this._enemies=u,this._currentlyMovingObstacles=[],this._wolfMatrixPosition={x:Math.floor(h.x/a.I_),y:Math.floor(h.y/a.I_)},this.startPosition=h,this.registerEvents(),this._emitter.emit("gameMapReady",this)}return t=l,e=[{key:"map",get:function(){return this._map}},{key:"navigationMap",get:function(){return this._navigationMap}},{key:"enemies",get:function(){return this._enemies}},{key:"obstacles",get:function(){return this._obstacles}},{key:"doors",get:function(){return this._doors}},{key:"nonGridObstacles",get:function(){return _(this._currentlyMovingObstacles).concat(_(this._doors),_(this.enemies))}},{key:"registerEvents",value:function(){this._emitter.on("wolfMatrixPositionChange",this.updateWolfMatrixPosition.bind(this)),this._emitter.on("frameUpdate",this.update.bind(this)),this._emitter.on("enemyDie",this.spawnAmmoOnDeadEnemy.bind(this))}},{key:"updateWolfMatrixPosition",value:function(t){this._wolfMatrixPosition=t}},{key:"spawnAmmoOnDeadEnemy",value:function(t){var e=this._map[t.currentMatrixPosition.y][t.currentMatrixPosition.x];e&&(0,c.Gh)(e)&&"ammo"===e.purpose.affects?e.purpose.value+=a.nd[a.To].value:!e&&(this._map[t.currentMatrixPosition.y][t.currentMatrixPosition.x]=new u.y({position:{x1:t.currentMatrixPosition.x*a.I_,y1:t.currentMatrixPosition.y*a.I_,x2:t.currentMatrixPosition.x*a.I_+a.I_,y2:t.currentMatrixPosition.y*a.I_+a.I_},hasCollision:!1,texture:(0,s.D)("src/static/assets/sprites/items/".concat(a.To,".png")),rawValue:"34_SPRITE_HOLLOW_ITEM",purpose:a.nd[a.To]}))}},{key:"interactWithObstacle",value:function(t){if((!!(0,c.YP)(t)||!!(0,c.cW)(t))&&!!t.isMovable)!this._currentlyMovingObstacles.includes(t)&&this._currentlyMovingObstacles.push(t)}},{key:"update",value:function(){var t=this;this._currentlyMovingObstacles.forEach(function(e){var i=e.move();i&&(0,c.YP)(e)&&!e.isInStartPosition&&(e.closeTimeout=new o.V(t._emitter,function(){if(t._wolfMatrixPosition.x>=e.endPositionMatrixCoordinates.x-1&&t._wolfMatrixPosition.x<=e.endPositionMatrixCoordinates.x+1&&t._wolfMatrixPosition.y>=e.endPositionMatrixCoordinates.y-1&&t._wolfMatrixPosition.y<=e.endPositionMatrixCoordinates.y+1){e.closeTimeout.set(a.zL);return}e.closeTimeout=null,e.hasCollision=!0,t._currentlyMovingObstacles.push(e)}),e.closeTimeout.set(a.zL),e.hasCollision=!1),(0,c.cW)(e)&&i&&(t._map[e.endPositionMatrixCoordinates.y][e.endPositionMatrixCoordinates.x]=e,t._map[e.matrixCoordinates.y][e.matrixCoordinates.x]=null,t._navigationMap.updateMap(t._map)),i&&(t._currentlyMovingObstacles=t._currentlyMovingObstacles.filter(function(t){return t!==e}))})}}],h(t.prototype,e),l}()},883:function(t,e,i){"use strict";i.d(e,{x:function(){return d}});var n=i(402),r=i(126),o=i(368),a=i(995),s=i(599),u=i(41),c=i(135),l=i(221);function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d=function(){var t,e,i;function d(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,d),_(this,"_canvas",void 0),_(this,"_ctx",void 0),_(this,"_gameMap",void 0),_(this,"_hud",void 0),_(this,"_minimap",void 0),_(this,"_wolf",void 0),_(this,"_emitter",void 0),_(this,"_screenData",void 0),this._canvas=t.canvas,this._ctx=t.canvas.getContext("2d"),this._screenData=t.screenData,this._emitter=t.emitter,this._gameMap=new c._(this._emitter,t.map),this._hud=new n.u({ctx:this._ctx,emitter:this._emitter,screenData:this._screenData,initialWeapon:"PISTOL"}),this._wolf=new o.X({ammo:20,emitter:this._emitter,currentWeapon:"PISTOL",health:100,level:0,lives:3,maxHealth:100,position:this._gameMap.startPosition,score:0,screenData:this._screenData,weapons:["KNIFE","PISTOL","MACHINE_GUN"],rawValue:"START_POS",resolutionScale:t.resolutionScale,fov:t.fov,gameMap:this._gameMap}),this._minimap=new r.N({ctx:this._ctx,obstacles:this._gameMap.obstacles,rowsLength:this._gameMap.map.length}),this.resize(this._screenData),this.registerEvents()}return t=d,e=[{key:"registerEvents",value:function(){this._emitter.on("wolfAttack",this.handleWolfAttack.bind(this)),this._emitter.on("wolfInteract",this.handleWolfInteract.bind(this)),this._emitter.on("resize",this.resize.bind(this))}},{key:"resize",value:function(t){var e=t.width,i=t.height;this._canvas.width=e,this._canvas.height=i,this._screenData.height=i,this._screenData.width=e}},{key:"getNonGridObstaclesInView",value:function(){var t=this,e=this._gameMap.nonGridObstacles,i=this._wolf,n=i.position,r=i.angle,o=this._wolf.camera.fov,a=(0,u.UQ)(r,o,n);return e.reduce(function(e,i){if((0,l.GO)(i))return e.push(i.getPreparedSprite(t._wolf.position,t._wolf.angle)),e;if(!(0,l.cW)(i))return e.push(i),e;var r=i.position;return n.x<=r.x1&&e.push(i.wallSides.LEFT),n.x>=r.x2&&e.push(i.wallSides.RIGHT),n.y<=r.y1&&e.push(i.wallSides.TOP),n.y>=r.y2&&e.push(i.wallSides.BOTTOM),e},[]).filter(function(e){var i=!!t._wolf.camera.getViewAngleIntersection(e.position),n=e.position,r=n.x1,o=n.y1,s=n.x2,c=n.y2;return i||(0,u.Ru)({x:r,y:o},a)||(0,u.Ru)({x:s,y:c},a)})}},{key:"handleWolfAttack",value:function(){var t=this,e=(0,u.UQ)(this._wolf.angle,a.W_,this._wolf.position),i=this._gameMap.enemies.filter(function(i){if("DIE"===i.currentAction)return!1;var n=i.getPreparedSprite(t._wolf.position,t._wolf.angle).position,r=!!t._wolf.camera.getViewAngleIntersection(n);return(!!(0,u.Ru)(i.position,e)||!!r)&&!(i.castToPosition(t._wolf.position).distance>a.$8[t._wolf.currentWeapon].maxDistance)&&i.castToPosition(t._wolf.position).isVisible}).sort(function(e,i){var n=e.castToPosition(t._wolf.position),r=i.castToPosition(t._wolf.position);return n.distance-r.distance})[0];if(i){var n=a.$8[this._wolf.currentWeapon],r=i.castToPosition(this._wolf.position).distance,o=(n.maxDistance-r)/n.maxDistance,s=(0,u.uZ)(n.maxDamage*o,n.minDamage,n.maxDamage);i.hit(s)}}},{key:"handleWolfInteract",value:function(){for(var t=null,e=null,i=0;i<this._gameMap.obstacles.length;i++){var n=this._gameMap.obstacles[i];if((!!(0,l.YP)(n)||!!(0,l.cW)(n))&&!!n.isMovable){var r=this._wolf.camera.getViewAngleIntersection(n.position),o=Math.sqrt(Math.pow(this._wolf.position.x-n.position.x1,2)+Math.pow(this._wolf.position.y-n.position.y1,2));r&&o<=2*a.I_&&(t=i,e=n)}}if(null!==t&&!!e)this._gameMap.interactWithObstacle(e)}},{key:"render",value:function(){this._ctx.imageSmoothingEnabled=!1,this._ctx.beginPath(),this._ctx.clearRect(0,0,this._screenData.width,this._screenData.height),this._ctx.closePath(),this._ctx.fillStyle="#383838",this._ctx.fillRect(0,0,this._screenData.width,Math.ceil(this._screenData.height/2));for(var t,e=((function(t){if(Array.isArray(t))return h(t)})(t=this._wolf.camera.getIntersections(this._gameMap.map,this.getNonGridObstaclesInView()))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(function(t,e){return e.distance===t.distance?e.distance*(1e5*e.layer)-t.distance*(1e5*t.layer):e.distance-t.distance}),i={startTextureOffsetX:0,startIndex:0,width:0,isInitial:!0,rays:[]},n=0;n<e.length;n++){var r=e[n],o=r.obstacle,u=r.index,c=(0,l.Du)(o),f=e[n+1],_=(0,s.m)(r),d=f&&(0,s.m)(f);i.isInitial&&(i.rays.push(r),i.width=1,i.startIndex=r.index,i.startTextureOffsetX=_,i.isInitial=!1);var p=(null==f?void 0:f.layer)===r.layer,y=(null==f?void 0:f.obstacle)===r.obstacle,v=(null==f?void 0:f.index)===u||(null==f?void 0:f.index)===u+1,m=c||(null==f?void 0:f.distance)===r.distance,g=(null==f?void 0:f.obstacle.texture)===o.texture,b=c||d===_;if(c&&y&&p||!c&&v&&m&&g&&b)i.rays.push(f),i.width+=1;else{var x=!(0,l.cW)(o)&&!(0,l.YP)(o)||o.intersectionType===a.ip.HORIZONTAL,w=a.I_/r.distance*(Math.PI/this._wolf.camera.fov)*this._screenData.height/1.75,O=x&&((0,l.cW)(o)||(0,l.YP)(o))?o.textureDark:o.texture,P=c?a.YK-i.startTextureOffsetX-1:_,M=c?Math.abs(i.startTextureOffsetX-_):1,S=a.YK,I=i.startIndex/this._wolf.camera.resolutionScale,T=this._screenData.height/2-w/2,E=i.width/this._wolf.camera.resolutionScale;i.rays=[],i.width=0,i.startIndex=0,i.isInitial=!0,this._ctx.drawImage(O,P,0,M,S,I,T,E,w)}}this._hud.render({currentWeapon:this._wolf.currentWeapon,ammo:this._wolf.ammo,lives:this._wolf.lives,score:this._wolf.score,level:this._wolf.level,health:this._wolf.health}),this._minimap.render(this._wolf.position,this._gameMap.enemies)}}],f(t.prototype,e),d}()},637:function(t,e,i){"use strict";i.d(e,{x:function(){return u}});var n=i(132),r=i(995),o=i(647);function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(u,t);var e,i,n=(e=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n,r,o=a(e);return r=i?Reflect.construct(o,arguments,a(this).constructor):o.apply(this,arguments),t=this,(n=r)&&("object"===function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(n)||"function"==typeof n)?n:function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)});function u(t){var e,i;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,u),n.call(this,(e=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){var n,r,o;n=t,r=e,o=i[e],r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o})}return t}({},t),i=(i={currentWeapon:"PISTOL",health:100,maxHealth:100,speed:.4,viewDistance:20*r.I_,attackDistance:12*r.I_,attackDelayTime:1e3,attackBaseDamage:30,attackFrameIdx:2,stateFrameSet:(0,o.cT)("guard"),actionFrameSet:(0,o._l)("guard")},i),Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):(function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i.push.apply(i,n)}return i})(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}),e))}return u}(n.C)},368:function(t,e,i){"use strict";i.d(e,{X:function(){return f}});var n=i(427),r=i(668),o=i(995),a=i(221);function s(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(p,t);var e,i,n,f,_,d=(e=p,i=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n,r,o=l(e);return r=i?Reflect.construct(o,arguments,l(this).constructor):o.apply(this,arguments),t=this,(n=r)&&("object"===function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(n)||"function"==typeof n)?n:s(t)});function p(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,p),c(s(e=d.call(this,t)),"_camera",void 0),c(s(e),"_ammo",void 0),c(s(e),"_lives",void 0),c(s(e),"_level",void 0),c(s(e),"_score",void 0),c(s(e),"_weapons",void 0),e._ammo=t.ammo,e._score=t.score,e._lives=t.lives,e._level=t.level,e._weapons=t.weapons,e._emitter=t.emitter,e._camera=new r.V({screenData:t.screenData,resolutionScale:t.resolutionScale,fov:t.fov,position:t.position,emitter:t.emitter}),e._emitter.emit("wolfPositionChange",e._position),e._emitter.emit("wolfMatrixPositionChange",e.currentMatrixPosition),e.handleWolfHit=e.handleWolfHit.bind(s(e)),e.handleMouseEvent=e.handleMouseEvent.bind(s(e)),e.handleKeyDown=e.handleKeyDown.bind(s(e)),e.handleKeyUp=e.handleKeyUp.bind(s(e)),e.update=e.update.bind(s(e)),e.registerEvents(),e}return n=p,f=[{key:"registerEvents",value:function(){window.addEventListener("mousedown",this.handleMouseEvent),window.addEventListener("mouseup",this.handleMouseEvent),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),this._emitter.on("frameUpdate",this.update),this._emitter.on("wolfHit",this.handleWolfHit)}},{key:"unregisterEvents",value:function(){window.removeEventListener("mousedown",this.handleMouseEvent),window.removeEventListener("mouseup",this.handleMouseEvent),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),this._emitter.off("frameUpdate",this.update),this._emitter.off("wolfHit",this.handleWolfHit)}},{key:"angle",get:function(){return this.camera.angle}},{key:"ammo",get:function(){return this._ammo}},{key:"lives",get:function(){return this._lives}},{key:"score",get:function(){return this._score}},{key:"health",get:function(){return this._health}},{key:"level",get:function(){return this._level}},{key:"currentWeapon",get:function(){return this._currentWeapon}},{key:"camera",get:function(){return this._camera}},{key:"canAttack",get:function(){return this._attackTimeout.isExpired&&(this._ammo>0||0===o.$8[this._currentWeapon].ammoPerAttack)}},{key:"handleWolfHit",value:function(t){this._health-=t,this._health<=0&&(this._health=0,this._emitter.emit("wolfDie",void 0),this.unregisterEvents())}},{key:"handleKeyDown",value:function(t){"1"===t.key?this.changeWeapon("KNIFE"):"2"===t.key?this.changeWeapon("PISTOL"):"3"===t.key&&this.changeWeapon("MACHINE_GUN"),32===t.keyCode&&(t.preventDefault(),this._emitter.emit("wolfInteract",void 0)),87===t.keyCode?this._verticalSpeed=o.wF:83===t.keyCode?this._verticalSpeed=-o.wF:68===t.keyCode?this._horizontalSpeed=o.wF:65===t.keyCode&&(this._horizontalSpeed=-o.wF)}},{key:"handleMouseEvent",value:function(t){1===t.buttons&&(this._isAttacking=!0),0===t.buttons&&(this._isAttacking=!1)}},{key:"handleKeyUp",value:function(t){87===t.keyCode&&this._verticalSpeed>0?this._verticalSpeed=0:83===t.keyCode&&this._verticalSpeed<0?this._verticalSpeed=0:68===t.keyCode&&this._horizontalSpeed>0?this._horizontalSpeed=0:65===t.keyCode&&this._horizontalSpeed<0&&(this._horizontalSpeed=0)}},{key:"changeWeapon",value:function(t){this._weapons.includes(t)&&(this._currentWeapon=t,this._emitter.emit("wolfWeaponChange",this._currentWeapon),this._attackTimeout.set(100),this._attackTimeout.onTimeoutExpire=null)}},{key:"attack",value:function(){var t=this;if(this.canAttack){var e=o.$8[this._currentWeapon];this._attackTimeout.set(e.frameDuration*e.attackFrameIdx),this._attackTimeout.onTimeoutExpire=function(){t._ammo-=o.$8[t._currentWeapon].ammoPerAttack,t._attackTimeout.set(e.frameDuration*(e.frameSet.length-e.attackFrameIdx)),t._attackTimeout.onTimeoutExpire=null},this._emitter.emit("wolfAttack",o.$8[this._currentWeapon])}}},{key:"handleCollisionIfOccurs",value:function(t,e){if(!!e&&(!!e.hasCollision||!!(0,a.Gh)(e))){var i=!1,n=(0,a.cW)(e)&&e.isInFinalPosition?e.endPositionMatrixCoordinates:e.matrixCoordinates,r={x1:n.x*o.I_,y1:n.y*o.I_,x2:n.x*o.I_+o.I_,y2:n.y*o.I_+o.I_};(0,a.YP)(e)&&("VERTICAL"===e.intersectionType&&(r.x1-=o.I_/2,r.x2+=o.I_/2),"HORIZONTAL"===e.intersectionType&&(r.y1-=o.I_/2,r.y2+=o.I_/2));var s={x1:r.x1-.3*o.I_,y1:r.y1-.3*o.I_,x2:r.x2+.3*o.I_,y2:r.y2+.3*o.I_};if(t.x>=s.x1&&t.x<=s.x2&&t.y>=s.y1&&t.y<=s.y2&&(e.hasCollision&&(this._position.x>=s.x1&&this._position.x<=s.x2&&(t.y=this._position.y),this._position.y>=s.y1&&this._position.y<=s.y2&&(t.x=this._position.x)),i=!0),i&&(0,a.Gh)(e)){var u=e.purpose;switch(u.affects){case"ammo":if(100===this._ammo)return;this._ammo+=u.value,this._ammo>100&&(this._ammo=100);break;case"health":if(this._health===this._maxHealth)return;this._health+=u.value,this._health>this._maxHealth&&(this._health=this._maxHealth);break;case"lives":this._lives+=u.value;break;case"score":this._score+=u.value;break;case"weapons":this._weapons.push(u.value)}this._emitter.emit("wolfBoostPickup",void 0),this._gameMap.map[e.matrixCoordinates.y][e.matrixCoordinates.x]=null}}}},{key:"move",value:function(){if((0!==this._horizontalSpeed||0!==this._verticalSpeed)&&!!this._gameMap){var t={x:this._position.x,y:this._position.y},e=Math.sin(this._camera.angle)*this._verticalSpeed*TIME_SCALE,i=Math.cos(this._camera.angle)*this._verticalSpeed*TIME_SCALE,n=Math.sin(this._camera.angle+Math.PI/2)*this._horizontalSpeed*TIME_SCALE,r=Math.cos(this._camera.angle+Math.PI/2)*this._horizontalSpeed*TIME_SCALE,a=e+n,s=i+r;t.x+=a>=0?Math.min(a,o.wF*TIME_SCALE):Math.max(a,-o.wF*TIME_SCALE),t.y+=s>=0?Math.min(s,o.wF*TIME_SCALE):Math.max(s,-o.wF*TIME_SCALE);var u=this.currentMatrixPosition;this.handleCollisionIfOccurs(t,(this._gameMap.map[u.y-1]||[])[u.x-1]),this.handleCollisionIfOccurs(t,(this._gameMap.map[u.y-1]||[])[u.x]),this.handleCollisionIfOccurs(t,(this._gameMap.map[u.y-1]||[])[u.x+1]),this.handleCollisionIfOccurs(t,(this._gameMap.map[u.y]||[])[u.x-1]),this.handleCollisionIfOccurs(t,(this._gameMap.map[u.y]||[])[u.x+1]),this.handleCollisionIfOccurs(t,(this._gameMap.map[u.y+1]||[])[u.x-1]),this.handleCollisionIfOccurs(t,(this._gameMap.map[u.y+1]||[])[u.x]),this.handleCollisionIfOccurs(t,(this._gameMap.map[u.y+1]||[])[u.x+1]),this._position=t,this._emitter.emit("wolfPositionChange",this._position),this._emitter.emit("wolfMatrixPositionChange",this.currentMatrixPosition)}}},{key:"update",value:function(){this.move(),this._isAttacking&&this.attack()}}],u(n.prototype,f),p}(n.v)},427:function(t,e,i){"use strict";i.d(e,{v:function(){return s}});var n=i(226),r=i(995);function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s=function(){var t,e,i;function s(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a(this,"_emitter",void 0),a(this,"_health",void 0),a(this,"_maxHealth",void 0),a(this,"_horizontalSpeed",void 0),a(this,"_verticalSpeed",void 0),a(this,"_currentWeapon",void 0),a(this,"_isAttacking",void 0),a(this,"_position",void 0),a(this,"_attackTimeout",void 0),a(this,"_rawValue",void 0),a(this,"_gameMap",void 0),this._currentWeapon=t.currentWeapon,this._health=t.health,this._maxHealth=t.maxHealth,this._position=t.position,this._rawValue=t.rawValue,this._gameMap=t.gameMap,this._emitter=t.emitter,this._attackTimeout=new n.V(t.emitter),this._isAttacking=!1,this._horizontalSpeed=0,this._verticalSpeed=0,this.registerActorEvents()}return t=s,e=[{key:"registerActorEvents",value:function(){var t=this;this._emitter.on("gameMapReady",function(e){t._gameMap=e})}},{key:"position",get:function(){return this._position}},{key:"currentMatrixPosition",get:function(){return{x:Math.floor(this._position.x/r.I_),y:Math.floor(this._position.y/r.I_)}}}],o(t.prototype,e),s}()},132:function(t,e,i){"use strict";i.d(e,{C:function(){return b}});var n=i(427),r=i(95),o=i(519),a=i(869),s=i(705),u=i(226),c=i(995),l=i(41),h=i(221);function f(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){d(t,e,i[e])})}return t}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m=(0,l.Yr)(45),g=m/2,b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(O,t);var e,i,n,b,x,w=(e=O,i=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n,r,o=p(e);return r=i?Reflect.construct(o,arguments,p(this).constructor):o.apply(this,arguments),t=this,(n=r)&&("object"===function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(n)||"function"==typeof n)?n:f(t)});function O(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,O),d(f(e=w.call(this,t)),"isEnemy",void 0),d(f(e),"_initialMatrixPosition",void 0),d(f(e),"_initialAngle",void 0),d(f(e),"_viewDistance",void 0),d(f(e),"_attackDistance",void 0),d(f(e),"_attackDelayTime",void 0),d(f(e),"_attackFrameIdx",void 0),d(f(e),"_attackBaseDamage",void 0),d(f(e),"_speed",void 0),d(f(e),"_stateFrameSet",void 0),d(f(e),"_actionFrameSet",void 0),d(f(e),"_sprite",void 0),d(f(e),"_animationController",void 0),d(f(e),"_attackTimeout",void 0),d(f(e),"_currentSide",void 0),d(f(e),"_pathfinder",void 0),d(f(e),"_currentFrameSetName",void 0),d(f(e),"_currentState",void 0),d(f(e),"_currentAction",void 0),d(f(e),"_angle",void 0),d(f(e),"_targetMatrixPosition",void 0),d(f(e),"_wolfMatrixPosition",void 0),d(f(e),"_wolfPosition",void 0),e.isEnemy=!0,e._stateFrameSet=t.stateFrameSet,e._actionFrameSet=t.actionFrameSet,e._currentFrameSetName="IDLE",e._currentState=t.initialState,e._currentAction=null,e._currentSide="FRONT",e._attackTimeout=new u.V(e._emitter);var e,i=0!==e._horizontalSpeed||0!==e._verticalSpeed?"RUN":"IDLE",n=e._currentAction?e._actionFrameSet[e._currentAction]:e._stateFrameSet[i][e._currentSide];return e._animationController=new s.f({frameSet:n,isLoopAnimation:!0,emitter:e._emitter}),e._sprite=new r.l({hasCollision:!1,position:{x1:e.currentMatrixPosition.x*c.I_,y1:e.currentMatrixPosition.y*c.I_,x2:e.currentMatrixPosition.x*c.I_+c.I_,y2:e.currentMatrixPosition.y*c.I_+c.I_},rawValue:e._rawValue,texture:e._animationController.currentFrame.data}),e._angle=t.angle,e._initialAngle=t.angle,e._initialMatrixPosition=e.currentMatrixPosition,e._targetMatrixPosition=null,e._wolfPosition={x:0,y:0},e._wolfMatrixPosition={x:0,y:0},e._viewDistance=t.viewDistance,e._attackDistance=t.attackDistance,e._attackDelayTime=t.attackDelayTime,e._attackFrameIdx=t.attackFrameIdx,e._attackBaseDamage=t.attackBaseDamage,e._speed=t.speed,"DIE"===t.initialAction&&e._animationController.setActiveFrameIdx(n.length-1),e.handleGameMapReady=e.handleGameMapReady.bind(f(e)),e.handleWolfPositionChange=e.handleWolfPositionChange.bind(f(e)),e.checkNoise=e.checkNoise.bind(f(e)),e.update=e.update.bind(f(e)),e._pathfinder=null,e.registerEvents(),e}return n=O,b=[{key:"angle",get:function(){return this._angle}},{key:"currentState",get:function(){return this._currentState}},{key:"currentAction",get:function(){return this._currentAction}},{key:"updateActiveFrameSet",value:function(){var t=0!==this._horizontalSpeed||0!==this._verticalSpeed?"RUN":"IDLE",e=this._currentAction?this._actionFrameSet[this._currentAction]:this._stateFrameSet[t][this._currentSide];this._animationController.updateFrameSet(e)}},{key:"onCurrentFrameSetNameChange",value:function(){this.updateActiveFrameSet()}},{key:"onCurrentStateChange",value:function(){this.updateActiveFrameSet()}},{key:"onCurrentActionChange",value:function(){var t=this;this.updateActiveFrameSet(),this._animationController.onAnimationEnd=function(){},"TAKE_DAMAGE"===this._currentAction&&(this._animationController.onAnimationEnd=function(){t.setCurrentAction(null)}),"SHOOT"===this._currentAction&&(this._animationController.onAnimationEnd=function(){t._attackTimeout.set(t._attackDelayTime),t.setCurrentAction(null)},this._animationController.onFrameChange=function(e){if(e===t._attackFrameIdx&&"SHOOT"===t._currentAction&&t.checkForWolfInView()){var i=(0,l.Qy)(t.currentMatrixPosition,t._wolfMatrixPosition)*c.I_,n=Math.max((t._attackDistance-i)/t._attackDistance,.2);t._emitter.emit("wolfHit",Math.round(n*t._attackBaseDamage))}})}},{key:"registerEvents",value:function(){this._emitter.on("gameMapReady",this.handleGameMapReady),this._emitter.on("wolfPositionChange",this.handleWolfPositionChange),this._emitter.on("wolfAttack",this.checkNoise),this._emitter.on("frameUpdate",this.update)}},{key:"unregisterEvents",value:function(){this._emitter.off("gameMapReady",this.handleGameMapReady),this._emitter.off("wolfPositionChange",this.handleWolfPositionChange),this._emitter.off("wolfAttack",this.checkNoise),this._emitter.off("frameUpdate",this.update)}},{key:"handleGameMapReady",value:function(t){this._gameMap=t,this._pathfinder=new o.W(this._gameMap.navigationMap)}},{key:"die",value:function(){this.unregisterEvents(),this.setCurrentAction("DIE"),this._emitter.emit("enemyDie",this)}},{key:"hit",value:function(t){this._health-=t,this.setCurrentState("CHASE"),this._health<=0?this.die():this.setCurrentAction("TAKE_DAMAGE")}},{key:"checkNoise",value:function(t){var e;if("IDLE"!==this._currentState)return;if(!((0,l.Qy)(this.currentMatrixPosition,this._wolfMatrixPosition)*c.I_>t.noiseDistance))(null===(e=this._pathfinder)||void 0===e?void 0:e.findPath(this.currentMatrixPosition,this._wolfMatrixPosition,!1))&&(this._targetMatrixPosition=this._wolfMatrixPosition,this.setCurrentState("SEARCH"))}},{key:"castToPosition",value:function(t){var e=(0,l.Qy)(this._position,t),i=(0,l.h6)(this._position,t);i<=0&&(i=2*Math.PI+i);var n=new a.z({initialPosition:this._position,angle:i}).castDDA(this._gameMap.map,i).filter(function(t){return(0,h.cW)(t.obstacle)||(0,h.YP)(t.obstacle)&&t.obstacle.isInStartPosition}).sort(function(t,e){return t.distance-e.distance})[0];return{isVisible:!n||n.distance>e,distance:e,angle:i}}},{key:"setCurrentAction",value:function(t){if(t!==this._currentAction)this._currentAction=t,this.onCurrentActionChange()}},{key:"setCurrentFrameSetName",value:function(t){if(t!==this._currentFrameSetName)this._currentFrameSetName=t,this.onCurrentFrameSetNameChange()}},{key:"setCurrentState",value:function(t){if(t!==this._currentState)this._currentState=t,this.onCurrentStateChange()}},{key:"handleWolfPositionChange",value:function(t){this._wolfMatrixPosition={x:Math.floor(t.x/c.I_),y:Math.floor(t.y/c.I_)},this._wolfPosition=y({},t),this.checkForWolfInView()&&this.setCurrentState("CHASE")}},{key:"checkForWolfInView",value:function(){if(!this._gameMap)return!1;var t=this.castToPosition(this._wolfPosition),e=(0,l.UQ)(this._angle,c.U2,this._position);return!!(0,l.Ru)(this._wolfPosition,e)&&!(t.distance>this._viewDistance)&&t.isVisible}},{key:"move",value:function(t){if(!this._pathfinder)return null;var e,i=(0,l.Qy)(this.currentMatrixPosition,this._wolfMatrixPosition)*c.I_,n=this._pathfinder.findPath(this.currentMatrixPosition,t,!0),r=null==n?void 0:n.originalObstacle,o=!!(null==r?void 0:r.hasCollision);if(n&&!o){this._verticalSpeed=(this.position.y/c.I_-n.y-.5)*this._speed*TIME_SCALE,this._horizontalSpeed=(this.position.x/c.I_-n.x-.5)*this._speed*TIME_SCALE;var a=(0,l.Ex)({x:this._horizontalSpeed,y:this._verticalSpeed});this._angle=Math.atan2(a.x,a.y)+Math.PI}o&&r&&(0,h.YP)(r)&&(null===(e=this._gameMap)||void 0===e||e.interactWithObstacle(r));var s=i<=c.I_&&"CHASE"===this._currentState;return(!n||o||s)&&(this._verticalSpeed=0,this._horizontalSpeed=0),0!==this._horizontalSpeed||0!==this._verticalSpeed?this.setCurrentFrameSetName("RUN"):this.setCurrentFrameSetName("IDLE"),this._position.x-=this._horizontalSpeed,this._position.y-=this._verticalSpeed,n}},{key:"getPreparedSprite",value:function(t,e){if(!this._currentAction){var i=(0,l.h6)(this._position,t)-this._angle,n=this._currentSide;if(i<=0&&(i=2*Math.PI+i),i<=g||i>g+7*m?n="FRONT":i<g+m?n="FRONT_LEFT":i<g+2*m?n="LEFT":i<g+3*m?n="BACK_RIGHT":i<g+4*m?n="BACK":i<g+5*m?n="BACK_LEFT":i<g+6*m?n="RIGHT":i<g+7*m&&(n="FRONT_RIGHT"),n!==this._currentSide){this._currentSide=n;var r=this._animationController.currentFrameIdx,o=0!==this._horizontalSpeed||0!==this._verticalSpeed?"RUN":"IDLE",a=this._stateFrameSet[o][this._currentSide];r>=a.length&&(r=0),this._animationController.updateFrameSet(a),this._animationController.setActiveFrameIdx(r)}}return this._sprite.texture=this._animationController.currentFrame.data,this._sprite.position={x1:this._position.x-c.I_/2,y1:this._position.y-c.I_/2,x2:this._position.x+c.I_/2,y2:this._position.y+c.I_/2},this._sprite.rotatePerpendicularlyToView(e),this._sprite}},{key:"update",value:function(){if(!this._currentAction)switch(this._currentState){case"CHASE":var t=(0,l.Qy)(this.currentMatrixPosition,this._wolfMatrixPosition)*c.I_;t<this._attackDistance&&this._attackTimeout.isExpired&&this.checkForWolfInView()&&this.setCurrentAction("SHOOT"),t>this._viewDistance&&(this._targetMatrixPosition=y({},this._wolfMatrixPosition),this.setCurrentState("SEARCH")),this.move(this._wolfMatrixPosition);break;case"SEARCH":var e=this.move(this._targetMatrixPosition);!e&&this._targetMatrixPosition&&(0,l.G2)(this._targetMatrixPosition,this._initialMatrixPosition)?(this.setCurrentState("IDLE"),this._angle=this._initialAngle):!e&&(this._targetMatrixPosition=this._initialMatrixPosition),this.checkForWolfInView()&&this.setCurrentState("CHASE")}}}],_(n.prototype,b),O}(n.v)},978:function(t,e,i){"use strict";i.d(e,{J:function(){return l}});var n=i(995),r=i(666);function o(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(_,t);var e,i,r,l,h,f=(e=_,i=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n,r,a=u(e);return r=i?Reflect.construct(a,arguments,u(this).constructor):a.apply(this,arguments),t=this,(n=r)&&("object"===function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(n)||"function"==typeof n)?n:o(t)});function _(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,_),s(o(e=f.call(this,t)),"_textureDark",void 0),s(o(e),"isVertical",void 0),s(o(e),"isDoor",void 0),s(o(e),"shouldReverseTexture",void 0),s(o(e),"intersectionType",void 0),s(o(e),"closeTimeout",void 0),e._textureDark=t.textureDark,e.isVertical=t.isVertical,e.isDoor=!0,e.closeTimeout=t.closeTimeout,e.shouldReverseTexture=!t.isVertical,e.intersectionType=t.isVertical?n.ip.VERTICAL:n.ip.HORIZONTAL,e}return r=_,l=[{key:"textureDark",get:function(){return this._textureDark}}],a(r.prototype,l),_}(r.Z)},922:function(t,e,i){"use strict";i.d(e,{y:function(){return u}});var n=i(95);function r(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(u,t);var e,i,n=(e=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n,o,s=a(e);return o=i?Reflect.construct(s,arguments,a(this).constructor):s.apply(this,arguments),t=this,(n=o)&&("object"===function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(n)||"function"==typeof n)?n:r(t)});function u(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,u),o(r(e=n.call(this,t)),"isItem",void 0),o(r(e),"purpose",void 0),e.isItem=!0,e.purpose=t.purpose,e}return u}(n.l)},95:function(t,e,i){"use strict";i.d(e,{l:function(){return c}});var n=i(995),r=i(602);function o(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(f,t);var e,i,r,c,l,h=(e=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n,r,a=s(e);return r=i?Reflect.construct(a,arguments,s(this).constructor):a.apply(this,arguments),t=this,(n=r)&&("object"===function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(n)||"function"==typeof n)?n:o(t)});function f(t){var e,i,n,r;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,f),i=o(e=h.call(this,t)),r=void 0,(n="isSprite")in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,e.isSprite=!0,e}return r=f,c=[{key:"rotatePerpendicularlyToView",value:function(t){var e={x:(this._position.x2+this._position.x1)/2,y:(this._position.y2+this._position.y1)/2},i=-t,r=Math.cos(i),o=Math.sin(i);return this.position={x1:e.x+n.Md*r,y1:e.y+n.Md*o,x2:e.x-n.Md*r,y2:e.y-n.Md*o},this}}],a(r.prototype,c),f}(r.e)},881:function(t,e,i){"use strict";i.d(e,{D:function(){return f}});var n=i(995),r=i(969),o=i(666);function a(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t,e,i){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i||t):r.value}})(t,e,i||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(p,t);var e,i,o,f,_,d=(e=p,i=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n,r,o=l(e);return r=i?Reflect.construct(o,arguments,l(this).constructor):o.apply(this,arguments),t=this,(n=r)&&("object"===function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(n)||"function"==typeof n)?n:a(t)});function p(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,p),u(a(e=d.call(this,t)),"_textureDark",void 0),u(a(e),"_neighborIsDoorMap",void 0),u(a(e),"_wallSides",void 0),u(a(e),"isWall",void 0),u(a(e),"intersectionType",void 0),u(a(e),"shouldReverseTexture",void 0),e.intersectionType=n.ip.HORIZONTAL,e.shouldReverseTexture=!1,e.isWall=!0,e._textureDark=t.textureDark,e._neighborIsDoorMap=t.neighborIsDoorMap,e._wallSides={TOP:e.getWallSide(n.zd.TOP,e._neighborIsDoorMap.TOP),RIGHT:e.getWallSide(n.zd.RIGHT,e._neighborIsDoorMap.RIGHT),BOTTOM:e.getWallSide(n.zd.BOTTOM,e._neighborIsDoorMap.BOTTOM),LEFT:e.getWallSide(n.zd.LEFT,e._neighborIsDoorMap.LEFT)},e}return o=p,f=[{key:"wallSides",get:function(){return this._wallSides}},{key:"textureDark",get:function(){return this._textureDark},set:function(t){this._textureDark=t}},{key:"move",value:function(){var t=c(l(p.prototype),"move",this).call(this);return this._wallSides={TOP:this.getWallSide(n.zd.TOP,this._neighborIsDoorMap.TOP),RIGHT:this.getWallSide(n.zd.RIGHT,this._neighborIsDoorMap.RIGHT),BOTTOM:this.getWallSide(n.zd.BOTTOM,this._neighborIsDoorMap.BOTTOM),LEFT:this.getWallSide(n.zd.LEFT,this._neighborIsDoorMap.LEFT)},t}},{key:"getWallSide",value:function(t,e){var i,o,a=t===n.zd.TOP||t===n.zd.BOTTOM,s={x1:this.position.x1+(t===n.zd.RIGHT?n.I_:0),y1:this.position.y1+(t===n.zd.BOTTOM?n.I_:0),x2:this.position.x2-(t===n.zd.LEFT?n.I_:0),y2:this.position.y2-(t===n.zd.TOP?n.I_:0)},c=this._texture,l=this._textureDark;return e&&(c=(0,r.D)("src/static/assets/textures/".concat(n.m5,".png")),l=(0,r.D)("src/static/assets/textures/".concat(n.Ji,".png"))),i=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){u(t,e,i[e])})}return t}({},this),o=(o={position:s,intersectionType:a?n.ip.VERTICAL:n.ip.HORIZONTAL,shouldReverseTexture:!e&&(t===n.zd.LEFT||t===n.zd.BOTTOM),texture:c,textureDark:l},o),Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):(function(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i.push.apply(i,n)}return i})(Object(o)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(o,t))}),i}}],s(o.prototype,f),p}(o.Z)},666:function(t,e,i){"use strict";i.d(e,{Z:function(){return l}});var n=i(995),r=i(602);function o(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(_,t);var e,i,r,l,h,f=(e=_,i=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n,r,a=u(e);return r=i?Reflect.construct(a,arguments,u(this).constructor):a.apply(this,arguments),t=this,(n=r)&&("object"===function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}(n)||"function"==typeof n)?n:o(t)});function _(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,_),s(o(e=f.call(this,t)),"_endPositionMatrixCoordinates",void 0),s(o(e),"_initialPosition",void 0),s(o(e),"_endPosition",void 0),s(o(e),"_isMoving",void 0),s(o(e),"_isInFinalPosition",void 0),s(o(e),"_isInStartPosition",void 0),s(o(e),"isMovable",void 0),e._initialPosition=t.initialPosition,e._endPosition=t.endPosition,e._isMoving=t.isMoving,e._isInFinalPosition=t.isInFinalPosition,e._isInStartPosition=t.isInStartPosition,e._endPositionMatrixCoordinates={x:Math.floor(e._endPosition.x1/n.I_),y:Math.floor(e._endPosition.y1/n.I_)},e.isMovable=t.isMovable,e}return r=_,l=[{key:"endPositionMatrixCoordinates",get:function(){return this._endPositionMatrixCoordinates}},{key:"initialPosition",get:function(){return this._initialPosition}},{key:"endPosition",get:function(){return this._endPosition}},{key:"isMoving",get:function(){return this._isMoving}},{key:"isInFinalPosition",get:function(){return this._isInFinalPosition}},{key:"isInStartPosition",get:function(){return this._isInStartPosition}},{key:"move",value:function(){if(!this.isMovable)return!0;this._isMoving=!0;var t=this._isInStartPosition?this._endPosition:this._initialPosition;return this._position={x1:this._position.x1+_.getPositionChange(this._position.x1,t.x1)*TIME_SCALE,y1:this._position.y1+_.getPositionChange(this._position.y1,t.y1)*TIME_SCALE,x2:this._position.x2+_.getPositionChange(this._position.x2,t.x2)*TIME_SCALE,y2:this._position.y2+_.getPositionChange(this._position.y2,t.y2)*TIME_SCALE},Math.round(this._position.x1*n.I_)/n.I_===t.x1&&Math.round(this._position.y1*n.I_)/n.I_===t.y1&&Math.round(this._position.x2*n.I_)/n.I_===t.x2&&Math.round(this._position.y2*n.I_)/n.I_===t.y2&&(this._position=t,this._isMoving=!1,this._isInStartPosition=!this._isInStartPosition,this._isInFinalPosition=!this._isInFinalPosition,!0)}}],h=[{key:"getPositionChange",value:function(t,e){return t>e?-n.lN:t<e?n.lN:0}}],l&&a(r.prototype,l),h&&a(r,h),_}(r.e)},602:function(t,e,i){"use strict";i.d(e,{e:function(){return a}});var n=i(995);function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var a=function(){var t,e,i;function a(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),o(this,"_position",void 0),o(this,"_matrixCoordinates",void 0),o(this,"_texture",void 0),o(this,"rawValue",void 0),o(this,"hasCollision",void 0),this._position=t.position,this._texture=t.texture,this._matrixCoordinates={x:Math.floor(Math.min(this._position.x1,this._position.x2)/n.I_),y:Math.floor(Math.min(this._position.y1,this._position.y2)/n.I_)},this.hasCollision=t.hasCollision,this.rawValue=t.rawValue}return t=a,e=[{key:"position",get:function(){return this._position},set:function(t){this._position=t,this._matrixCoordinates={x:Math.floor(Math.min(this._position.x1,this._position.x2)/n.I_),y:Math.floor(Math.min(this._position.y1,this._position.y2)/n.I_)}}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t}},{key:"matrixCoordinates",get:function(){return this._matrixCoordinates}}],r(t.prototype,e),a}()},189:function(t,e,i){"use strict";i.d(e,{J:function(){return u}});var n=i(883),r=i(800),o=i(995),a=i(41);function s(t,e,i,n,r,o,a){try{var s=t[o](a),u=s.value}catch(t){i(t);return}s.done?e(u):Promise.resolve(u).then(n,r)}var u=document.getElementById("canvas");function c(){var t;return t=function(){var t,e,s,c,l,h,f,_,d,p,y,v,m,g,b,x,w;function O(){d.emit("resize",{width:window.innerWidth,height:window.innerHeight})}function P(t){t.target&&(f=o.t6[Number(t.target.value)],d.emit("resolutionScaleChange",f))}function M(t){if(t.target){var e=Number(t.target.value);_=(0,a.Yr)(e),c.innerText=t.target.value,d.emit("fovChange",_)}}function S(e){"Escape"===e.key&&(h=!0,t.style.display="flex")}function I(){h&&(h=!1,t.style.display="none")}return function(t,e){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,function(a){switch(a.label){case 0:return t=document.getElementById("menu-container"),e=document.getElementById("resolution-scale"),s=document.getElementById("fov"),c=document.getElementById("fovValue"),l=document.getElementById("continue-button"),h=!1,f=o.J5,_=o.d$,d=new r.v,s.value=String(o.Fp),c.innerText=String(o.Fp),e.value=String(o.t6.indexOf(o.J5)),p={height:window.innerHeight,width:window.innerWidth},[4,i(9)("./".concat("E1M3",".json"))];case 1:y=a.sent(),(m=function(){(d=new r.v).on("wolfDie",function(){return m()}),v=new n.x({canvas:u,map:y,screenData:p,emitter:d,fov:_,resolutionScale:f})})(),g=document.getElementById("fps");return b=0,x=0,w=0,!function t(e){!h&&d.emit("frameUpdate",void 0),v.render(),b=x;var i=(x=e)-b;w+=(i-w)/20,TIME_SCALE=Math.min(Math.round(i/o.ek*100)/100,1),requestAnimationFrame(t)}(0),setInterval(function(){g.innerHTML="".concat((1e3/w).toFixed(1)," fps")},200),l.onclick=I,e.oninput=P,s.oninput=M,window.onkeydown=S,window.addEventListener("resize",O),u.onclick=function(){u.requestPointerLock()},[2]}})},(c=function(){var e=this,i=arguments;return new Promise(function(n,r){var o=t.apply(e,i);function a(t){s(o,n,r,a,u,"next",t)}function u(t){s(o,n,r,a,u,"throw",t)}a(void 0)})}).apply(this,arguments)}window.onload=function(){return c.apply(this,arguments)}},668:function(t,e,i){"use strict";i.d(e,{V:function(){return f}});var n=i(455),r=i(41),o=i(869),a=i(189),s=i(221),u=i(995);function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var f=function(){var t,e,i;function f(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,f),h(this,"_emitter",void 0),h(this,"_rays",void 0),h(this,"_position",void 0),h(this,"_angle",void 0),h(this,"_resolutionScale",void 0),h(this,"_fov",void 0),h(this,"_screenData",void 0),this._emitter=t.emitter,this._angle=(0,r.Yr)(180),this._resolutionScale=t.resolutionScale*u.MP,this._fov=t.fov,this._screenData=t.screenData,this._position=t.position,this._rays=[],this.rotate=this.rotate.bind(this),this.handleResize=this.handleResize.bind(this),this.handleResolutionScaleChange=this.handleResolutionScaleChange.bind(this),this.handleFovChange=this.handleFovChange.bind(this),this.handleWolfDie=this.handleWolfDie.bind(this),this.updatePosition=this.updatePosition.bind(this),this.changeRaysAmount(),this.registerEvents()}return t=f,e=[{key:"resolutionScale",get:function(){return this._resolutionScale}},{key:"fov",get:function(){return this._fov}},{key:"angle",get:function(){return this._angle}},{key:"registerEvents",value:function(){a.J.addEventListener("mousemove",this.rotate),this._emitter.on("resize",this.handleResize),this._emitter.on("resolutionScaleChange",this.handleResolutionScaleChange),this._emitter.on("fovChange",this.handleFovChange),this._emitter.on("wolfPositionChange",this.updatePosition),this._emitter.on("wolfDie",this.handleWolfDie)}},{key:"unregisterEvents",value:function(){a.J.removeEventListener("mousemove",this.rotate),this._emitter.off("resize",this.handleResize),this._emitter.off("resolutionScaleChange",this.handleResolutionScaleChange),this._emitter.off("fovChange",this.handleFovChange),this._emitter.off("wolfPositionChange",this.updatePosition),this._emitter.off("wolfDie",this.handleWolfDie)}},{key:"handleWolfDie",value:function(){this.unregisterEvents()}},{key:"handleResize",value:function(t){this._screenData=t,this.changeRaysAmount()}},{key:"handleResolutionScaleChange",value:function(t){this._resolutionScale=t,this.changeRaysAmount()}},{key:"handleFovChange",value:function(t){this._fov=t}},{key:"updatePosition",value:function(t){for(var e=0;e<this._rays.length;e++)this._rays[e].move(t);this._position=t}},{key:"getViewAngleIntersection",value:function(t){var e=(0,r.nr)(this._position,this._angle);return(0,r.H$)({x1:this._position.x,y1:this._position.y,x2:e.x,y2:e.y},t)}},{key:"getIntersections",value:function(t,e){for(var i,r=function(r){var u,l=[],h=i._rays[r].cast(e,i._angle),f=i._rays[r].castDDA(t,i._angle),_=f.reduce(function(t,e){return!t&&(0,s.cW)(e.obstacle)?t=e:t&&(0,s.cW)(e.obstacle)&&e.distance<t.distance&&(t=e),t},null);_&&(h=h.filter(function(t){return t.distance<_.distance})),h.forEach(function(t){var e=t.obstacle,i=t.intersectionVertex,o=t.distance,a=(0,s.Du)(e)?4:(0,n.f)(o),u=Math.round(o*a)/a,c=l.reduce(function(t,e){return e.distance===u&&(t+=1),t},0);l.push({intersectionVertex:i,obstacle:e,distance:Math.round(o*a)/a,index:r,layer:c})}),f.forEach(function(t){var e=t.obstacle,i=t.intersectionVertex,a=t.distance,u=e.position,c=(0,s.Du)(e)?4:(0,n.f)(a),h=i,f=Math.round(a*c)/c,_=null;if((0,s.Du)(e)||(0,s.Gh)(e)){_=e.rotatePerpendicularlyToView(o._angle);var d=o._rays[r].cast([_],o._angle).sort(function(t,e){return t.distance-e.distance})[0];if(!d)return;f=Math.round(d.distance*c)/c,h=d.intersectionVertex}else(0,s.cW)(e)&&(h.y!==u.y1&&h.x===u.x1&&(_=e.wallSides.LEFT),h.y!==u.y1&&h.x===u.x2&&(_=e.wallSides.RIGHT),h.y===u.y1&&h.x!==u.x1&&(_=e.wallSides.TOP),h.y===u.y2&&h.x!==u.x1&&(_=e.wallSides.BOTTOM));if(_){var p=l.reduce(function(t,e){return e.distance===f&&(t+=1),t},0);l.push({obstacle:_,distance:f,index:r,intersectionVertex:h,layer:p})}}),a.push.apply(a,function(t){if(Array.isArray(t))return c(t)}(u=l)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(u)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return c(t,e)}}(u)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())},o=this,a=[],u=0;u<this._rays.length;u++)i=this,r(u);return a}},{key:"changeRaysAmount",value:function(){this._rays=[];for(var t=this._screenData.width*this._resolutionScale,e=Math.tan(this._fov/2),i=e/(t/2),n=0;n<t;n++){var r=this._angle+Math.atan(i*n-e);r<0&&(r+=2*Math.PI),r>2*Math.PI&&(r-=2*Math.PI),this._rays.push(new o.z({angle:r,initialPosition:this._position}))}}},{key:"rotate",value:function(t){this._angle+=(0,r.Yr)(t.movementX/3),this._angle=this._angle%(2*Math.PI),this._angle<0&&(this._angle+=2*Math.PI);for(var e=Math.tan(this._fov/2),i=e/(10*Math.floor(this._rays.length/10)/2),n=0;n<this._rays.length;n++){var o=this._angle+Math.atan(i*n-e);o<0&&(o+=2*Math.PI),o>2*Math.PI&&(o-=2*Math.PI),this._rays[n].changeAngle(o)}}}],l(t.prototype,e),f}()},800:function(t,e,i){"use strict";i.d(e,{v:function(){return r}});function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=function(){var t,e,i;function r(){var t,e,i;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),t=this,i={},(e="events")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}return t=r,e=[{key:"on",value:function(t,e){!this.events[t]&&(this.events[t]=[]),this.events[t].push(e)}},{key:"once",value:function(t,e){var i=this,n=function(r){i.off(t,n),e(r)};this.on(t,n)}},{key:"off",value:function(t,e){if(!!this.events[t]){var i=this.events[t].indexOf(e);i>=0&&this.events[t].splice(i,1)}}},{key:"emit",value:function(t,e){if(!!this.events[t])this.events[t].forEach(function(t){return t(e)})}}],n(t.prototype,e),r}()},171:function(t,e,i){"use strict";i.d(e,{P:function(){return f}});var n=i(637),r=i(978),o=i(922),a=i(95),s=i(881),u=i(995),c=i(969),l=i(41);function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var f=function(){var t,e,i;function f(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,f)}return t=f,e=null,i=[{key:"getSecretObstaclesEndPositions",value:function(t){for(var e={},i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++){var r=t[i][n];if(r&&"string"==typeof r){var o=r.split("_");"END"===o[2]&&(e[o[1]]={x1:n*u.I_,y1:i*u.I_,x2:n*u.I_+u.I_,y2:i*u.I_+u.I_})}}return e}},{key:"createEmptyMap",value:function(t){for(var e=[],i=0;i<t.length;i++)e.push([]);return e}},{key:"parseMap",value:function(t,e){for(var i=this.createEmptyMap(e),h=[],f=[],_=[],d={x:0,y:0},p=this.getSecretObstaclesEndPositions(e),y=0;y<e.length;y++)for(var v=0;v<e[y].length;v++){var m=e[y][v];if(!m){i[y].push(null);continue}if(m){if("START_POS"===m){d={x:v*u.I_+u.I_/2,y:y*u.I_+u.I_/2},i[y].push(null);continue}var g="number"==typeof m?[]:m.split("_"),b="number"!=typeof m?Number(g[0]):m;if(g&&g.includes("END")){i[y].push(null);continue}var x=v%63==0||y%63==0,w=g.includes("ENEMY"),O=g.includes("ITEM"),P=g.includes("SPRITE")||!1,M=!P&&g.includes("START"),S=!P&&u.B_.includes(b),I=!P&&(S||M)&&!x,T=!w&&!O&&!P&&!S,E=!g.includes("HOLLOW"),k=null;O&&(k=u.nd[b]);var A=!!(e[y][v-1]&&e[y][v+1]),D={x1:v*u.I_+(!A&&S?.5*u.I_:0),y1:y*u.I_+(A&&S?.5*u.I_:0),x2:v*u.I_+(!A&&S?.5*u.I_:u.I_),y2:y*u.I_+(A&&S?.5*u.I_:u.I_)},C=M&&g?p[g[1]]:{x1:A?D.x1+u.I_:D.x1,y1:A?D.y1:D.y1-u.I_,x2:A?D.x2+u.I_:D.x2,y2:A?D.y2:D.y2-u.I_};if(w){var F=g[1].toLowerCase(),R=g[2],j=g[3];if("guard"===F){var L=new n.x({gameMap:null,emitter:t,rawValue:m,initialAction:null,initialState:R,angle:(0,l.Yr)(u.am[j]),position:{x:(D.x1+D.x2)/2,y:(D.y1+D.y2)/2}});_.push(L),i[y].push(null)}}else if(T){var H,W,N,V,G=new s.D({neighborIsDoorMap:{TOP:!!(null===(H=e[y-1])||void 0===H?void 0:H[v])&&u.B_.includes(e[y-1][v]),RIGHT:!!(null===(W=e[y])||void 0===W?void 0:W[v+1])&&u.B_.includes(e[y][v+1]),BOTTOM:!!(null===(N=e[y+1])||void 0===N?void 0:N[v])&&u.B_.includes(e[y+1][v]),LEFT:!!(null===(V=e[y])||void 0===V?void 0:V[v-1])&&u.B_.includes(e[y][v-1])},initialPosition:D,position:D,endPosition:C,isInFinalPosition:!1,isInStartPosition:!0,isMovable:I,isMoving:!1,hasCollision:E,texture:(0,c.D)("src/static/assets/textures/".concat(b,".png")),textureDark:(0,c.D)("src/static/assets/textures/".concat(b+1,".png")),rawValue:m});i[y].push(G),h.push(G)}else if(P&&!O){var z=new a.l({position:D,hasCollision:E,texture:(0,c.D)("src/static/assets/sprites/".concat(E?"static":"hollow","/").concat(b,".png")),rawValue:m});i[y].push(z),h.push(z)}else if(O){var B=new o.y({position:D,hasCollision:E,texture:(0,c.D)("src/static/assets/sprites/items/".concat(b,".png")),rawValue:m,purpose:k});i[y].push(B),h.push(B)}else if(S){var U=new r.J({initialPosition:D,position:D,endPosition:C,isInFinalPosition:!1,isInStartPosition:!0,isMovable:I,isMoving:!1,isVertical:A,hasCollision:E,texture:(0,c.D)("src/static/assets/textures/".concat(b,".png")),textureDark:(0,c.D)("src/static/assets/textures/".concat(b+1,".png")),rawValue:m,closeTimeout:null});i[y].push(U),h.push(U),f.push(U)}}}return{map:i,obstacles:h,startPosition:d,doors:f,enemies:_}}}],i&&h(t,i),f}()},186:function(t,e,i){"use strict";i.d(e,{Z:function(){return s}});var n=i(70),r=i(221);function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s=function(){var t,e,i;function s(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a(this,"_parsedMap",void 0),a(this,"_navigationMap",void 0),this._parsedMap=t,this._navigationMap=this.prepareMap()}return t=s,e=[{key:"prepareMap",value:function(){return this._parsedMap.map(function(t,e){return t.map(function(t,i){return new n.r({x:i,y:e,isPassable:!t||!t.hasCollision||(0,r.YP)(t)||(0,r.cW)(t)&&t.isMovable,isDoor:(0,r.YP)(t),originalObstacle:t})})})}},{key:"updateMap",value:function(t){return this._parsedMap=t,this._navigationMap=this.prepareMap(),this.mapCopy}},{key:"mapCopy",get:function(){return this._navigationMap.map(function(t){return t.map(function(t){return t.makeCopy()})})}}],o(t.prototype,e),s}()},70:function(t,e,i){"use strict";i.d(e,{r:function(){return o}});function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var o=function(){var t,e,i;function o(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,o),r(this,"x",void 0),r(this,"y",void 0),r(this,"isPassable",void 0),r(this,"isDoor",void 0),r(this,"originalObstacle",void 0),r(this,"isVisited",void 0),r(this,"previous",void 0),this.x=t.x,this.y=t.y,this.isPassable=t.isPassable,this.isDoor=t.isDoor,this.originalObstacle=t.originalObstacle,this.isVisited=t.isVisited||!1,this.previous=t.previous||null}return t=o,e=[{key:"makeCopy",value:function(){return new o({x:this.x,y:this.y,isPassable:this.isPassable,isDoor:this.isDoor,originalObstacle:this.originalObstacle,isVisited:this.isVisited,previous:this.previous})}}],n(t.prototype,e),o}()},519:function(t,e,i){"use strict";i.d(e,{W:function(){return s}});var n=i(995);function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s=function(){var t,e,i;function s(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a(this,"_navigationMap",void 0),a(this,"_mapWidth",void 0),a(this,"_mapHeight",void 0),a(this,"_cachedResult",void 0),a(this,"_cachedStart",void 0),a(this,"_cachedEnd",void 0),this._navigationMap=t,this._cachedResult=null,this._cachedStart=null,this._cachedEnd=null;var e=this._navigationMap.mapCopy;this._mapHeight=e.length,this._mapWidth=this._mapHeight>0?e[0].length:0}return t=s,e=[{key:"checkCache",value:function(t,e){return this._cachedResult&&this._cachedStart&&this._cachedEnd?((this._cachedStart.x!==t.x||this._cachedStart.y!==t.y||this._cachedEnd.x!==e.x||this._cachedEnd.y!==e.y)&&(this._cachedEnd=null,this._cachedStart=null,this._cachedResult=null),this._cachedResult):null}},{key:"getNodeOrNull",value:function(t,e,i){return e<0||e>=this._mapWidth||i<0||i>=this._mapHeight?null:t[i][e]}},{key:"findPath",value:function(t,e){var i=this,o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=this.checkCache(t,e);if(a)return s.getNextFromStart(a,t);for(var u=this._navigationMap.mapCopy,c=[u[t.y][t.x]];c.length;){var l,h,f=(l=this,function(){var a=c.shift();if(a.x===e.x&&a.y===e.y)return l._cachedStart=t,l._cachedEnd=e,l._cachedResult=a,{v:s.getNextFromStart(a,t)};var h=!0,f=!1,_=void 0;try{for(var d,p,y=Object.entries(n.ch)[Symbol.iterator]();!(h=(p=y.next()).done);h=!0)d=l,function(){var t,e,s,l=(t=p.value,e=2,function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i,n,r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(i=r.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{!a&&null!=r.return&&r.return()}finally{if(s)throw n}}return o}}(t,2)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(t,e)}}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=l[0],f=l[1],_=d.getNodeOrNull(u,a.x+f.x,a.y+f.y);_&&_.isDoor&&(null===(s=_.originalObstacle)||void 0===s?void 0:s.hasCollision)&&!o?"continue":_&&!_.isPassable?(_.isVisited=!0,"continue"):_&&n.xY[h]&&!n.xY[h].every(function(t){var e=i.getNodeOrNull(u,_.x+t.x,_.y+t.y);return!e||e.isPassable})?"continue":void(_&&!_.isVisited&&(c.push(_),_.isVisited=!0,_.previous=a))}()}catch(t){f=!0,_=t}finally{try{!h&&null!=y.return&&y.return()}finally{if(f)throw _}}}());if("object"==((h=f)&&"undefined"!=typeof Symbol&&h.constructor===Symbol?"symbol":typeof h))return f.v}return null}}],i=[{key:"getNextFromStart",value:function(t,e){for(var i=t;i.previous;){var n=i.previous;if(n.x===e.x&&n.y===e.y)return i;i=n}return null}}],e&&o(t.prototype,e),i&&o(t,i),s}()},869:function(t,e,i){"use strict";i.d(e,{z:function(){return u}});var n=i(995),r=i(41),o=i(221);function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var u=function(){var t,e,i;function u(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,u),s(this,"_angle",void 0),s(this,"_position",void 0),this._angle=t.angle,this._position={x1:0,y1:0,x2:0,y2:0},this.move(t.initialPosition)}return t=u,e=[{key:"angle",get:function(){return this._angle}},{key:"changeAngle",value:function(t){this._angle=t,this.move({x:this._position.x1,y:this._position.y1})}},{key:"move",value:function(t){this._position={x1:t.x,y1:t.y,x2:t.x+Math.sin(this._angle)*n.pk,y2:t.y+Math.cos(this._angle)*n.pk}}},{key:"castDDA",value:function(t,e){var i=[],a=(0,r.Ex)({x:this._position.x2-this._position.x1,y:this._position.y2-this._position.y1}),s={x:this._position.x1/n.I_,y:this._position.y1/n.I_},u={x:Math.floor(this._position.x1/n.I_),y:Math.floor(this._position.y1/n.I_)},c=Math.abs(1/a.x),l=Math.abs(1/a.y),h=0,f=0,_=1,d=1;a.x<0?(_=-1,h=(s.x-u.x)*c):h=(u.x+1-s.x)*c,a.y<0?(d=-1,f=(s.y-u.y)*l):f=(u.y+1-s.y)*l;for(var p="x",y=0;y<n.pk/n.I_;)if(h<f?(u.x+=_,y=h,h+=c,p="x"):(u.y+=d,y=f,f+=l,p="y"),u.x>=0&&u.x<64&&u.y>=0&&u.y<64&&t[u.y]&&t[u.y][u.x]){var v=t[u.y][u.x];if((0,o.El)(v)&&v.isMoving)continue;var m={x:s.x*n.I_+a.x*y*n.I_,y:s.y*n.I_+a.y*y*n.I_};m[p]=Math.round(m[p]);var g=(0,r.pS)(y*n.I_,e,this._angle);if((g>n.I_/5||!(0,o.Du)(v))&&i.push({obstacle:v,distance:g,intersectionVertex:m}),(0,o.Du)(v)||(0,o.YP)(v))continue;break}return i}},{key:"cast",value:function(t,e){var i=[],a=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var h=c.value,f=(0,r.H$)(this._position,h.position);if(f){var _=(0,r.Qy)({x:this._position.x1,y:this._position.y1},f),d=(0,r.pS)(_,e,this._angle);(d>n.I_/5||!(0,o.Du)(h))&&i.push({intersectionVertex:f,distance:d,obstacle:h})}}}catch(t){s=!0,u=t}finally{try{!a&&null!=l.return&&l.return()}finally{if(s)throw u}}return i}}],a(t.prototype,e),u}()},221:function(t,e,i){"use strict";i.d(e,{Du:function(){return n},El:function(){return u},GO:function(){return s},Gh:function(){return r},YP:function(){return a},cW:function(){return o}});var n=function(t){return!!t&&!!t.isSprite},r=function(t){return!!t&&!!t.isItem},o=function(t){return!!t&&!!t.isWall},a=function(t){return!!t&&!!t.isDoor},s=function(t){return!!t&&!!t.isEnemy},u=function(t){return a(t)||o(t)}},647:function(t,e,i){"use strict";i.d(e,{Re:function(){return o},_l:function(){return u},cF:function(){return l},cT:function(){return s},ym:function(){return c}});var n=i(969),r=["FRONT","FRONT_RIGHT","RIGHT","BACK_LEFT","BACK","BACK_RIGHT","LEFT","FRONT_LEFT"];function o(t,e){for(var i=[],r=0;r<5;r++)i.push((0,n.D)("src/static/assets/weapons/".concat(t.toLowerCase(),"/").concat(t.toLowerCase(),"_frame_").concat(r,".png")));return i.map(function(t){return{data:t,duration:e}})}function a(){return r.reduce(function(t,e){return t[e]=[],t},{})}function s(t){var e={IDLE:a(),RUN:a()},i=!0,o=!1,s=void 0;try{for(var u,c=r[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var l=u.value;e.IDLE[l].push({data:(0,n.D)("src/static/assets/enemies/".concat(t,"/idle/").concat(l.toLowerCase(),"_0.png")),duration:1/0})}}catch(t){o=!0,s=t}finally{try{!i&&null!=c.return&&c.return()}finally{if(o)throw s}}var h=!0,f=!1,_=void 0;try{for(var d,p=r[Symbol.iterator]();!(h=(d=p.next()).done);h=!0){for(var y=d.value,v=0;v<4;v++)e.RUN[y].push({data:(0,n.D)("src/static/assets/enemies/".concat(t,"/run/").concat(y.toLowerCase(),"_").concat(v,".png")),duration:200})}}catch(t){f=!0,_=t}finally{try{!h&&null!=p.return&&p.return()}finally{if(f)throw _}}return e}function u(t){var e={SHOOT:[],TAKE_DAMAGE:[],DIE:[]};e.TAKE_DAMAGE.push({data:(0,n.D)("src/static/assets/enemies/".concat(t,"/take_damage/0.png")),duration:150});for(var i=0;i<=2;i++)e.SHOOT.push({data:(0,n.D)("src/static/assets/enemies/".concat(t,"/shoot/").concat(i,".png")),duration:200});for(var r=0;r<=4;r++)e.DIE.push({data:(0,n.D)("src/static/assets/enemies/".concat(t,"/die/").concat(r,".png")),duration:4===r?1/0:100});return e}function c(t){for(var e=[],i=0;i<3;i++)e.push((0,n.D)("src/static/assets/hud/portrait/".concat(t.toLowerCase(),"/frame_").concat(i,".png")));return[{data:e[0],duration:2e3},{data:e[1],duration:750},{data:e[2],duration:750},{data:e[1],duration:750},{data:e[0],duration:1500},{data:e[1],duration:1500},{data:e[2],duration:200},{data:e[1],duration:500},{data:e[2],duration:500},{data:e[1],duration:500}]}function l(t){return[{data:{color:"rgba(".concat(t.join(","),", 0)")},duration:1e4},{data:{color:"rgba(".concat(t.join(","),", 0.25)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.2)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.15)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.1)")},duration:40},{data:{color:"rgba(".concat(t.join(","),", 0.05)")},duration:40}]}},969:function(t,e,i){"use strict";i.d(e,{D:function(){return r}});var n={};function r(t){if(n[t])return n[t];var e=new Image;return e.src=t,n[t]=e,e}},455:function(t,e,i){"use strict";i.d(e,{f:function(){return r}});var n=i(995);function r(t){var e=1;return e=t<n.I_/2?24:t<3*n.I_?12:t<6*n.I_?2:1}},599:function(t,e,i){"use strict";i.d(e,{m:function(){return o}});var n=i(995),r=i(221);function o(t){var e=t.obstacle,i=e.position,o=((0,r.cW)(e)||(0,r.YP)(e))&&e.intersectionType===n.ip.VERTICAL,a=!1;((0,r.Du)(e)||(0,r.Gh)(e))&&Math.abs(i.x1-i.x2)>Math.abs(i.y1-i.y2)&&(a=!0);var s=((0,r.cW)(e)||(0,r.YP)(e))&&e.shouldReverseTexture?{x:i.x2,y:i.y2}:{x:i.x1,y:i.y1};return Math.floor(Math.abs(o||a?s.x-t.intersectionVertex.x:s.y-t.intersectionVertex.y)/(o||a?Math.abs(i.x1-i.x2):Math.abs(i.y1-i.y2))*n.YK)}},41:function(t,e,i){"use strict";i.d(e,{Ex:function(){return _},G2:function(){return a},H$:function(){return p},Qy:function(){return l},Ru:function(){return f},UQ:function(){return h},Yr:function(){return r},h6:function(){return u},nr:function(){return c},pS:function(){return d},uZ:function(){return o}});var n=i(995);function r(t){return t*Math.PI/180}function o(t,e,i){return Math.max(e,Math.min(t,i))}function a(t,e){return t.x===e.x&&t.y===e.y}function s(t,e,i,n,r,o){return Math.abs((t*(n-o)+i*(o-e)+r*(e-n))/2)}function u(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}function c(t,e){return{x:t.x+n.pk*Math.sin(e),y:t.y+n.pk*Math.cos(e)}}function l(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function h(t,e,i){var n=t-e,r=t+e,o=c(i,t),a=c(o,n),s=c(o,r);return{x1:i.x,y1:i.y,x2:a.x,y2:a.y,x3:s.x,y3:s.y}}function f(t,e){var i=t.x,n=t.y,r=e.x1,o=e.y1,a=e.x2,u=e.y2,c=e.x3,l=e.y3;return Math.round(s(r,o,a,u,c,l))===Math.round(s(i,n,a,u,c,l)+s(r,o,i,n,c,l)+s(r,o,a,u,i,n))}function _(t){var e,i,n,r=t.x,o=t.y;var a=(i=(e={x:r,y:o}).x,Math.sqrt(i*i+(n=e.y)*n));return{x:r/a,y:o/a}}function d(t,e,i){return t*Math.cos(e-i)}function p(t,e){var i=t.x1,n=t.x2,r=t.y1,o=t.y2,a=e.x1,s=e.y1,u=e.x2,c=e.y2;if(i===n&&r===o||a===u&&s===c)return null;var l=(c-s)*(n-i)-(u-a)*(o-r);if(0===l)return null;var h=((u-a)*(r-s)-(c-s)*(i-a))/l,f=((n-i)*(r-s)-(o-r)*(i-a))/l;return h<0||h>1||f<0||f>1?null:{x:i+h*(n-i),y:r+h*(o-r)}}},402:function(t,e,i){"use strict";i.d(e,{u:function(){return c}});var n=i(705),r=i(995),o=i(235),a=i(647);function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c=function(){var t,e,i;function c(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,c),u(this,"_ctx",void 0),u(this,"_screenData",void 0),u(this,"_weaponAnimation",void 0),u(this,"_postEffectAnimation",void 0),u(this,"_portraitAnimation",void 0),u(this,"_emitter",void 0),u(this,"_currentFrameSet",void 0),u(this,"_scale",void 0),u(this,"_width",void 0),u(this,"_height",void 0),u(this,"_offsetX",void 0),u(this,"_offsetY",void 0),this._ctx=t.ctx,this._screenData=t.screenData,this._currentFrameSet=o.yz.HEALTHY,this._emitter=t.emitter,this._scale=this._screenData.width*r.Ug/o.tl.WIDTH,this._width=Math.round(this._screenData.width*r.Ug),this._height=Math.round(o.tl.HEIGHT*this._scale),this._offsetX=this._screenData.width/2-this._width/2,this._offsetY=this._screenData.height-this._height,this._portraitAnimation=new n.f({renderFunction:this.renderPortrait.bind(this),frameSet:this._currentFrameSet,initialFrameIdx:0,isLoopAnimation:!0,emitter:this._emitter}),this._weaponAnimation=new n.f({renderFunction:this.renderWeapon.bind(this),initialFrameIdx:0,isLoopAnimation:!1,frameSet:r.$8[t.initialWeapon].frameSet,emitter:this._emitter}),this._postEffectAnimation=new n.f({renderFunction:this.renderPostEffect.bind(this),initialFrameIdx:0,isLoopAnimation:!1,frameSet:(0,a.cF)([255,255,0]),emitter:this._emitter}),this.registerEvents()}return t=c,e=[{key:"registerEvents",value:function(){this._emitter.on("wolfWeaponChange",this.onWeaponChange.bind(this)),this._emitter.on("wolfBoostPickup",this.onBoostPickup.bind(this)),this._emitter.on("wolfAttack",this.onAttack.bind(this)),this._emitter.on("wolfHit",this.onWolfHit.bind(this))}},{key:"renderPostEffect",value:function(t){this._ctx.fillStyle=t.color,this._ctx.fillRect(0,0,this._screenData.width,this._screenData.height)}},{key:"renderWeapon",value:function(t){var e=this._screenData.width*r.Ug/o.tl.WIDTH*o.tl.HEIGHT,i=this._screenData.height-e,n=this._screenData.width/2-i/2,a=this._screenData.height-i-e;this._ctx.drawImage(t,0,0,r.YK,r.YK,n,a,i,i)}},{key:"renderPortrait",value:function(t){var e=this._offsetX+Math.round(o.tl.PORTRAIT_X_OFFSET*this._scale),i=this._offsetY+Math.round(o.tl.PORTRAIT_Y_OFFSET*this._scale);this._ctx.drawImage(t,0,0,o.fq,o.KR,e,i,Math.round(o.fq*this._scale),Math.round(o.KR*this._scale))}},{key:"renderText",value:function(t,e){for(var i=String(t),n=Math.ceil(i.length*o.gs*this._scale),r=0;r<i.length;r++){var a=Number(i[r])*o.gs,s=r*o.gs,u=this._offsetX+e+Math.ceil(s*this._scale)-n/2,c=this._offsetY+Math.ceil(o.tl.INFO_Y_OFFSET*this._scale);this._ctx.drawImage(o.oT,a,0,o.gs,o.Dz,u,c,Math.ceil(o.gs*this._scale),Math.ceil(o.Dz*this._scale))}}},{key:"onWeaponChange",value:function(t){this._weaponAnimation.updateFrameSet(r.$8[t].frameSet)}},{key:"onBoostPickup",value:function(){this._postEffectAnimation.updateFrameSet((0,a.cF)([255,255,0])),this._postEffectAnimation.playAnimation()}},{key:"onWolfHit",value:function(){this._postEffectAnimation.updateFrameSet((0,a.cF)([255,0,0])),this._postEffectAnimation.playAnimation()}},{key:"onAttack",value:function(){this._weaponAnimation.setActiveFrameIdx(0),this._weaponAnimation.playAnimation()}},{key:"render",value:function(t){var e=t.ammo,i=t.lives,n=t.score,a=t.health,s=t.currentWeapon,u=t.level,l=c.getHealthFrameSet(a);l!==this._currentFrameSet&&(this._currentFrameSet=l,this._portraitAnimation.updateFrameSet(this._currentFrameSet)),this._scale=this._screenData.width*r.Ug/o.tl.WIDTH,this._width=Math.round(this._screenData.width*r.Ug),this._height=Math.round(o.tl.HEIGHT*this._scale),this._offsetX=this._screenData.width/2-this._width/2,this._offsetY=this._screenData.height-this._height,this._postEffectAnimation.render(),this._ctx.drawImage(o.tl.TEXTURE,0,0,o.tl.WIDTH,o.tl.HEIGHT,this._offsetX,this._offsetY,this._width,this._height),this._ctx.drawImage(r.$8[s].icon,0,0,o.uh,o.vp,this._offsetX+Math.round(o.tl.WEAPON_X_OFFSET*this._scale),this._offsetY+Math.round(o.tl.WEAPON_Y_OFFSET*this._scale),Math.round(o.uh*this._scale),Math.round(o.vp*this._scale)),this.renderText(u,o.tl.LEVEL_X_OFFSET*this._scale),this.renderText(n,o.tl.SCORE_X_OFFSET*this._scale),this.renderText(i,o.tl.LIVES_X_OFFSET*this._scale),this.renderText(a,o.tl.HEALTH_X_OFFSET*this._scale),this.renderText(e,o.tl.AMMO_X_OFFSET*this._scale),this._weaponAnimation.render(),this._portraitAnimation.render()}}],i=[{key:"getHealthFrameSet",value:function(t){return t>85?o.yz.HEALTHY:t>75?o.yz.JUST_A_SCRATCH:t>50?o.yz.MINOR_DAMAGE:t>35?o.yz.MODERATE_DAMAGE:t>20?o.yz.SEVERE_DAMAGE:t>5?o.yz.SUFFERING:t>0?o.yz.NEAR_DEATH:o.yz.DEAD}}],e&&s(t.prototype,e),i&&s(t,i),c}()},126:function(t,e,i){"use strict";i.d(e,{N:function(){return s}});var n=i(995),r=i(221);function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s=function(){var t,e,i;function s(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a(this,"_ctx",void 0),a(this,"_obstacles",void 0),a(this,"_rowsLength",void 0),this._ctx=t.ctx,this._obstacles=t.obstacles,this._rowsLength=t.rowsLength}return t=s,e=[{key:"render",value:function(t,e){var i=this._rowsLength*n.I_,o=!0,a=!1,s=void 0;try{for(var u,c=this._obstacles[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;(0,r.cW)(l)&&l.isMovable?this._ctx.fillStyle="orange":this._ctx.fillStyle="white",(0,r.cW)(l)&&this._ctx.fillRect(l.initialPosition.x1*n.f6,(i-l.initialPosition.y1-n.I_)*n.f6,n.I_*n.f6,n.I_*n.f6)}}catch(t){a=!0,s=t}finally{try{!o&&null!=c.return&&c.return()}finally{if(a)throw s}}var h=!0,f=!1,_=void 0;try{for(var d,p=e[Symbol.iterator]();!(h=(d=p.next()).done);h=!0){var y=d.value;this._ctx.fillStyle="red";var v={x:y.position.x+n.I_/n.f6*Math.sin(y.angle),y:y.position.y+n.I_/n.f6*Math.cos(y.angle)};this._ctx.strokeStyle="orange",this._ctx.beginPath(),this._ctx.moveTo(y.position.x*n.f6,(i-y.position.y)*n.f6),this._ctx.lineTo(v.x*n.f6,(i-v.y)*n.f6),this._ctx.closePath(),this._ctx.stroke(),this._ctx.beginPath(),this._ctx.ellipse(y.position.x*n.f6,(i-y.position.y)*n.f6,.8*n.I_*n.f6,.8*n.I_*n.f6,0,0,360),this._ctx.closePath(),this._ctx.fill()}}catch(t){f=!0,_=t}finally{try{!h&&null!=p.return&&p.return()}finally{if(f)throw _}}this._ctx.fillStyle="blue",this._ctx.beginPath(),this._ctx.ellipse(t.x*n.f6,(i-t.y)*n.f6,.8*n.I_*n.f6,.8*n.I_*n.f6,0,0,360),this._ctx.closePath(),this._ctx.fill()}}],o(t.prototype,e),s}()}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}i.m=t,(()=>{var t,e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__};i.t=function(n,r){if(1&r&&(n=this(n)),8&r||"object"==typeof n&&n&&(4&r&&n.__esModule||16&r&&"function"==typeof n.then))return n;var o=Object.create(null);i.r(o);var a={};t=t||[null,e({}),e([]),e(e)];for(var s=2&r&&n;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach(function(t){a[t]=function(){return n[t]}});return a.default=function(){return n},i.d(o,a),o}})(),i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=function(t){return Promise.all(Object.keys(i.f).reduce(function(e,n){return i.f[n](t,e),e},[]))},i.k=function(t){return""+t+".css"},i.u=function(t){return""+t+".bundle.js"},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},(()=>{var t={},e="wolfenstein-3d:";i.l=function(n,r,o,a){if(t[n]){t[n].push(r);return}if(void 0!==o){for(var s,u,c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var h=c[l];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==e+o){s=h;break}}}!s&&(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",e+o),s.src=n),t[n]=[r];var f=function(e,i){s.onerror=s.onload=null,clearTimeout(_);var r=t[n];if(delete t[n],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach(function(t){return t(i)}),e)return e(i)},_=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),u&&document.head.appendChild(s)}})(),i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{i.g.importScripts&&(t=i.g.location+"");var t,e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length){for(var r=n.length-1;r>-1&&!t;)t=n[r--].src}}if(!t)throw Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t={909:0};i.f.j=function(e,n){var r=i.o(t,e)?t[e]:void 0;if(0!==r){if(r)n.push(r[2]);else{var o=new Promise(function(i,n){r=t[e]=[i,n]});n.push(r[2]=o);var a=i.p+i.u(e),s=Error();i.l(a,function(n){if(i.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}},"chunk-"+e,e)}}};var e=function(e,n){var r=n[0],o=n[1],a=n[2],s,u,c=0;if(r.some(function(e){return 0!==t[e]})){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);a&&a(i)}for(e&&e(n);c<r.length;c++)u=r[c],i.o(t,u)&&t[u]&&t[u][0](),t[u]=0},n=self.webpackChunkwolfenstein_3d=self.webpackChunkwolfenstein_3d||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),i("189")})();
//# sourceMappingURL=bundle.js.map